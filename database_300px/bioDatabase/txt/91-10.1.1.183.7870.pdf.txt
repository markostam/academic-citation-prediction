Mathematical Research Letters 3, 275–291 (1996)
INSTANTONS AND AFFINE ALGEBRAS I: THE
HILBERT SCHEME AND VERTEX OPERATORS
I. Grojnowski
A b st ract . This is the ﬁrst in a series of papers which describe the action
of an aﬃne Lie algebra with central charge n on the moduli space of U(n)-
instantons on a four manifold X. This generalises work of Nakajima, who
considered the case when X is an ALE space. In particular, this should
describe the combinatorial complexity of the moduli space as being precisely
that of representation theory, and thus will lead to a description of the Betti
numbers of moduli space as dimensions of weight spaces.
This Lie algebra acts on the space of conformal blocks (i.e., the cohomol-
ogy of a determinant line bundle on the moduli space [LMNS]) generalising
the “insertion” and “deletion” operations of conformal ﬁeld theory, and
indeed on any cohomology theory.
In the particular case of U(1)-instantons, which is essentially the subject
of this present paper, the construction produces the basic representation
after Frenkel-Kac. Then the well known quadratic nature of ch2,
ch2 =
1
2
c1 · c1 − c2
becomes precisely the formula for the eigenvalue of the degree operator, i.e.
the well known quadratic behaviour of aﬃne Lie algebras.
Introduction
This is the ﬁrst in a series of papers devoted to describing the action
of an aﬃne Lie algebra on the moduli space of instantons on an algebraic
surface X. This paper, which is only an announcement, is concerned with
the “boundary” of moduli space; the subsequent papers will describe the
action on the interior.
We describe the idea brieﬂy. Let X be an algebraic surface, M the
moduli space of U(c)-instantons on X (see below for precise deﬁnitions).
M is not connected; it decomposes into M = ∐Mc1,ch2 , where Mc1,ch2
denotes those instantons with ﬁxed ﬁrst Chern class equal to c1 ∈ H2(X,Z)
and second Chern character equal to ch2 ∈ Q = H4(X,Q).
Received July 6, 1995.
275
276 I. GROJNOWSKI
Let Σ ⊆ X be an algebraic curve. Associated to Σ we have various
correspondences M ←− PΣ −→ M. Such a correspondence induces maps
H(M) → H(M) for any cohomology theory H. To describe these indi-
vidual maps is very complicated. However, these maps satisfy very simple
commutation relations, namely those deﬁning a Lie algebra. Hence, shift-
ing our point of view slightly, we see that H(M) is a representation of this
Lie algebra. This explains the complexity of the individual maps—they
are the same as the (known) complexity of describing the action of a Lie
algebra on the individual weight spaces of a representation.
What then needs to be described is the correspondences, the Lie algebra
they generate, and which representations occur. The Lie algebras are aﬃne
Lie algebras, deﬁned by the lattice H2(X,Z), or various sublattices such as
the lattices of algebraic cycles (Neron-Severi group). These lattices become
the “ﬁnite part” of the weight lattice, with the degree operator taking value
in H4(X,Z). (The presence of aﬃne Lie algebras, whose characters are
known to be modular forms, is reassuringly consistent with the remarkable
work [VW], which predicts this behaviour because of S-duality).
The description of the representation will have to wait for a future pa-
per. I hope that it is irreducible, and determined by the Ka¨hler cone and
Kronheimer-Mrowka basic classes (choice of “positive roots” and “highest
weight”). However, the most important invariant of a representation is its
central charge, and in this paper we show that this charge is precisely the
rank of the instanton (i.e. U(n)-instantons give rise to level n representa-
tions).
The most basic example of a correspondence is the “elementary modiﬁ-
cations”; i.e. given a divisor i : Σ ↪→ X we modify a vector bundle along
Σ, that is consider the correspondence
PnΣ = {0 → A1 → A2 → i∗E → 0 | Ar ∈M, E ∈ PicnΣ}
where PicnΣ is the moduli space of holomorphic line bundles on Σ with
degree n.
In the case where X is a curve, divisors are points, and the analogous
correspondences are precisely the geometric Hecke operators of Drinfeld.
Points however cannot interact, whereas curves on surfaces most deﬁnitely
do—their interaction being precisely described by the lattice H2(X,Z). It
was the basic observation of Nakajima, in the case of an ALE space X, that
the interactions of the correspondences are described by the Serre relations.
Variants of these correspondences PnΣ are the subject of the sequel to
this paper.
This paper is concerned with a simpler correspondence, which removes a
point from an instanton to produce a new one. As a vector bundle modiﬁed
INSTANTONS AND AFFINE ALGEBRAS 277
along a point becomes only a torsion free sheaf, and not a vector bundle, one
should think of this correspondence as acting along the “boundary” of the
moduli space. We ﬁnd that the algebra generated by this correspondence
is essentially an aﬃne Heisenberg Lie algebra (§3, 5).
Obviously, these correspondences are well known in the literature. For
example, the elementary modiﬁcations along a divisor appear in [MO],
where they stratify M by what strongly looks like paths to the highest
weight vector of a representation (i.e. by the “crystal” basis), and notably
in [KM] where they are used to impose enough relations on the Donaldson
polynomials to determine them in terms of certain basic classes.
Even our simple correspondence of inserting a point is a common tech-
nical tool; see for example [GL]. Thus our main contribution is to insist
that one should study the algebra of these correspondences, and that this
is easy.
Finally, these correspondences act on any cohomology theory. In the
most intersting case, the cohomology of M with coeﬃcents in a determi-
nantal line bundle, one produces the action of an aﬃne algebra on the
space of conformal blocks1. This space, for which there is now a dimension
formula [LMNS] generalising that of Verlinde for curves, has staggering
implications for representation theory.
Acknowledgements: It should be clear that this paper is inspired by
Nakajima’s fantastic work [Na]. It is a pleasure to acknowledge helpful
conversations with A. Beilinson, R. Dijkgraaf, L. Fastenberg, I. Frenkel, D.
Gieseker, P. Kronheimer, Jun Li, A. Losev, G. Moore, N. Nekrasov and S.
Shatashvili; and support both intellectual and moral from I. Frenkel and
G. Moore, without which this work would not have occurred. Portions
of these results were announced at talks at UCLA in November 1994 and
UNC-Chapel Hill in April 1995. Nakajima independantly in the paper
alg-geom/9507012 has proved a result similar to theorem 2 below.
1. Algebraic preliminaries
Let V be a complex vector space, t−1V [t−1] = V ⊗C t−1C[t−1] the
associated space of loops at V which vanish at ∞. We make this a graded
vector space by setting deg(v ⊗ tn) = −n. We write vn for v ⊗ tn.
Let S = S(t−1V [t−1]) = ⊕Sn be the graded polynomial algebra in in-
ﬁnitely many variables. We make this a Hopf algebra by deﬁning ∆vn =
vn⊗1+1⊗vn, for v ∈ V . Then S is a free commutative and cocommutative
Hopf algebra. Conversely, given such a Hopf algebra S, we can reconstruct
V ⊗ t−n uniquely as the space of primitive elements of degree n.
1This paragraph is the consequence of conversations with Greg Moore; see [LMNS].
278 I. GROJNOWSKI
Now suppose we are given a graded symmetric bilinear form (, ) on S
such that multiplication and comultiplication are adjoint, i.e. such that
(Sn, Sm) = 0 if n = m, and (xy, z) = (x ⊗ y, ∆z) (where S ⊗ S inherits a
bilinear form by (x ⊗ y, a ⊗ b) = (x, a)(y, b)). Such a form is completely
speciﬁed by its values on the primitive elements, i.e. by the values (αin, α
j
n),
where αi runs through a basis of V .
Given a non-degenerate such form, we can deﬁne the action of tV [t] =
V ⊗ tC[t] on S, by deﬁning vn to be the adjoint of v−n for n > 0, i.e.
(vnx, y) = (x, v−ny), n > 0.
As ∆ is an algebra homomorphism, it follows that vn acts as a derivation
on S,
(vn(xy), z)=(xy, v−nz)=(x⊗y, ∆(v−nz))=(x⊗y, (v−n⊗1 + 1⊗v−n)∆z)
= (vnx⊗y + x⊗vny, ∆z) = (vn(x)y + xvn(y), z)
and hence that the Heisenberg Lie algebra (⊕n =0V ⊗ tn) ⊕ C acts on S,
where [vn, wm] = δn,−m.(vn, wn) if n > 0.
Given v ∈ V , we deﬁne new elements hvn ∈ Sn by
Hv(t) =
∑
n≥0
hvnt
n = exp

∑
n≥1
vnt
n/n

 .
Then if the elements αi form a basis of V , it is well known that the elements
hα
i
n are algebraically independent and generate S. As t
−1V [t−1] consists of
primitive elements, the Hv(t) are ‘group-like’, i.e.
∆hvn =
∑
0≤a≤n
hva ⊗ hvn−a
and the inner product is given by
∑
n,m≥0
(hvn, h
w
m)t
nsm = exp

∑
n≥1
(vn, wn)/n · (ts)n/n

 .
This inﬁnite family of Heisenberg Lie algebras just constructed is still
rather ﬂabby; however inside this space of algebras (parametrised by maps
from Z+ to non-degenerate quadratic forms on V ) there are certain re-
markable families with much larger symmetries; namely the vertex algebras
[B,FLM] and q-vertex algebras [FJ].
INSTANTONS AND AFFINE ALGEBRAS 279
We suppose given a lattice L with non-degenerate symmetric even bilin-
ear form, i.e. (α, α) ∈ 2Z for α ∈ L, and put V = L ⊗Z C. Deﬁne (, ) on
t−1V [t−1] by
(vn, wm) = (−1)n+1n(v, w)δn,m.
With this inner product,∑
n,m≥0
(hvn, h
w
m)t
nsm = (1 + ts)(v,w).
We call S the Fock space modeled on the lattice L.
We also suppose given a two-cocycle  : L × L → Z/2Z, and deﬁne
the group algebra of L twisted by , C{L}, as in [FK,FLM]. Deﬁne F =
S ⊗C C{L}, a Z+ ×L graded vector space which carries an action of both
the Heisenberg Lie algebra (⊕n =0V ⊗ tn) ⊕ C and C{L}. Let V act on
C{L} by v · eλ = (v, λ)eλ, where λ ∈ L, eλ denotes the corresponding
element of the group algebra, and v ∈ V .
Then in these circumstances we have the well known result that a far
larger algebra acts on F , namely
Theorem [FLM,B]. F is a vertex algebra, and if L is positive deﬁnite, a
vertex operator algebra2
For example, in the particular case where L is positive deﬁnite and
spanned by the roots ∆ = {α ∈ L | (α, α) = 2}, then the space of vectors
of conformal weight 1 is isomorphic to the simple Lie algebra g with roots
∆, and F is the basic representation of ĝ [FK].
If L is of arbitrary signature things become much more complicated.
At present, there is apparantly no general deﬁnition for a quantum vertex
algebra. But if L is positive deﬁnite and spanned by the roots, then we can
follow [FJ] and deﬁne, for c ∈ N
(αin, α
j
m) = nδnm[nc(α
i, αj)]/[n]
where [n] = q
n−q−n
q−q−1 , and α
1, . . . , αl are a basis of simple roots. (There is
an additional choice here, that of a positive cone in V ). When c = 1 this
gives F the structure of the basic representation for Uqĝ [FJ].
This q arises in our situation when there is some “weight” structure on
the cohomology theory, for example a C∗-action on X. This does occur for
ALE spaces (see [N, Gr1]) but we will stick to q = 1 for the present paper.
2If L is Z/2-graded we may also make all these deﬁnitions, as long as we work in
the Z/2-graded category. So S is the free super-commutative algebra on t−1V [t−1], i.e.
a tensor product of an exterior algebra and a polynomial algebra, F is a super-vertex
algebra, etc.
280 I. GROJNOWSKI
2. Motivic algebras
We write this section with the minimal generality needed for this paper.
Suppose X and Y are two smooth proper varieties, and Z ⊆ X × Y is a
subvariety, i.e. a correspondence between X and Y . We write this X ←−
Z −→ Y , and πX , πY for the two projections from X × Y to X or Y .
Then if H is any “reasonable” cohomology theory we obtain honest maps
R : H(X) → H(Y ), R¯ : H(Y ) → H(X)
which are adjoint with respect to the natural inner product on H(X) and
H(Y ); (Ra, b) = (a, R¯b). Here we deﬁne R(a) = (πY )∗(π∗Xa · [Z]), R¯(b) =
(πX)∗([Z] · π∗Y b), and (a, a′) =
∫
∗ a · a′, for a, a′ ∈ H(X), b ∈ H(Y ) and
where for any space X,
∫
: X → pt denotes the projection to a point, and
[Z] denotes the class of Z in H(X × Y ).
We mention some reasonable cohomology theories:
i) Usual homology or cohomology H∗; topological K-theory,..., cobor-
dism, all with (say) complex coeﬃcients.
ii) Write F(X) for the ring of constructible functions from X to C. If
π : X → Y is a map, f ∈ F(Y ), g ∈ F(X), deﬁne (π∗f)(x) = f(π(x))
and (π∗g)(y) =
∑
a∈C aχ(π
−1(y) ∩ g−1(a)), where χ denotes the Euler
characteristic of cohomology with compact supports, and deﬁne [Z], for
Z ⊆ X a subvariety, as the characteristic function of Z: [Z](x) = 1 if
x ∈ Z, and [Z](x) = 0 otherwise.
iii) If dimZ = (dimX + dimY )/2, then
H
1
2 dim X(X)
R

R¯
H
1
2 dim Y (Y )
where H∗ is the usual cohomology. If X is compact Ka¨hler (respectively
complex algebraic or symplectic) we can consider the subspace of
H
1
2 dim X(X) spanned by the (p, p)-classes (respectively, algebraic or La-
grangian cycles). Denote any of these subspaces HΛ(X). As long as Z is
algebraic or Lagrangian as appropriate, the topological R, R¯ preserve these
subspaces and the theories HΛ(X) are “reasonable” cohomology theories.
As part of our deﬁnition of reasonable we require that the Kunneth map
H(X)⊗H(Y ) → H(X × Y ), a⊗ b → π∗Xa · π∗Y b is an isomorphism. Here,
if H is Z/2-graded then we take ⊗ in the Z/2-graded sense also (as in
example (i)).
One can continue this list of theories as one pleases [JKS]. The above
theories all take values in vector spaces, as our goal is to produce repre-
sentations of algebras, but if the correspondences act non-trivially on the
INSTANTONS AND AFFINE ALGEBRAS 281
entire motives of X and Y one should also consider functors which do not
factor through cycles homologically equivalent to zero.
An example not on this list, but which I hope to return to, is homology
of X with coeﬃcients in a given sheaf. In our case below, the sheaf should
be taken to be a determinant line bundle on the moduli space of torsion
free sheaves, so that its cohomology is the space of conformal blocks. Then
the geometric Hecke operators (quantum group symmetries) we produce
act on the representation theory of the double loop groups in some as yet
unknown way.
3. Hilbert schemes
We recall some well known facts about the Hilbert scheme. Let X be
a smooth algebraic surface, SnX = Xn/Sn the n’th symmetric power of
X. For n > 1, SnX is singular. Write S˜nX for the Hilbert scheme of X,
i.e. for the variety parameterising closed zero dimensional subschemes of X
of length n, and let π : S˜nX → SnX be the canonical morphism sending
a subscheme to its support. Then S˜nX actually exists as a separated
variety; it is smooth of dimension 2n [Gro,Fo], π is proper and produces a
desingularisation of SnX.
If X is symplectic then so is S˜nX, if X is hyper-Ka¨hler than S˜nX
is the hyper-Ka¨hler resolution of the stack (orbifold) [SnX]. We phrase
everything below in terms of the variety S˜nX, but it is often much better
to work directly with the smooth stack [SnX].
If x → nx denotes the diagonal map X → Xn → SnX, then π−1(nx)
is irreducible, and of dimension n − 1 [Br]. This fact was used in [GS] to
compute the Hodge numbers of S˜nX in terms of those of X; a description
of the Euler numbers which is in the spirit of this paper can be found in
[VW].
Let Pn denote the set of partitions of n. If α = (1α12α2 · · · ) ∈ Pn,
so
∑
i iαi = n, write +(α) =
∑
i αi. We have an obvious stratiﬁcation of
SnX by Pn; the strata SnαX has complex dimension 2+(α). Write S˜nαX
for π−1(SnαX). Then A ∈ S˜nαX if A is isomorphic to a direct sum ⊕Ai,r,
where 1 ≤ r ≤ αi, each Ai,r ∈ S˜iX has support a single point with
multiplicity i, π(Ai,r) = iγi,r, and the points γi,r are distinct. We have
dim S˜nαX = n + +(α).
The open strata Sn(1n), S˜
n
(1n)X we also denote (S
nX)0, (S˜nX)0; π re-
stricted to (S˜nX)0 is an isomorphism.
282 I. GROJNOWSKI
Deﬁne
Λ0 = Λ0ab = {(A1,A2,A3) ∈ S˜aX × S˜a+bX × S˜bX |
A2 ∈ (S˜a+bX)0, and there is an exact sequence 0→A1 →A2 →A3 →0}
and deﬁne Λ to be the closure of Λ0 in S˜aX× S˜a+bX× S˜bX. Observe that
i) If (A1,A2,A3) ∈ Λ0, then A1,A2 and A3 are all in the open stratum
of their Hilbert schemes.
ii) We have (A1,A2,A3) ∈ Λab if and only if (A3,A2,A1) ∈ Λba.
iii) Writing + : SaX × SbX → Sa+bX for the obvious morphism, we
have π(A2) = π(A1) + π(A3), if (A1,A2,A3) ∈ Λ. In fact Λ is just the
correspondence of varieties produced by the “obvious” correspondence of
stacks
Λstack = {(A1,A2,A3) | A2 = A1 +A3}.
This is the basic motivic object, from which everything else follows.
iv) The dimension of Λ is 2(a+b), i.e. half the dimension of the ambient
space. In fact,
Lemma 1. If X is symplectic, then Λ is Lagrangian (where we change the
sign of the symplectic form on S˜a+bX in S˜aX× S˜a+bX× S˜bX as is usual).
Now, let H be a reasonable cohomology theory as in §2. Write
S = ⊕n≥0H(S˜nX).
Deﬁne, for x ∈ S˜aX, y ∈ S˜bX, the product of x and y,
xy = (πa+b)∗((πa, πb)∗(x⊗ y) · [Λ]),
and for z ∈ S˜a+bX, deﬁne
∆abz = (πa, πb)∗([Λ] · π∗a+bz) ∈ H(S˜aX)⊗H(S˜bX)
and ∆ =
∑
a+b=n ∆ab. Also deﬁne a non-degenerate inner product (, ) :
H(S˜nX)×H(S˜mX) → H(pt) by (x, y) = δnm
∫
∗ x · y.
Theorem 2. Equipped with this multiplication and comultiplication, S is
a commutative and cocommutative Hopf algebra. In other words, multpli-
cation and comultipication are associative, adjoint with respect to the inner
INSTANTONS AND AFFINE ALGEBRAS 283
product, and (graded) commutative (here, if H is Z/2-graded, so is each
Sn). ∆ is an algebra homomorphism.
The only statement that requires proof is that ∆ is an algebra homomor-
phism; the rest comes free with the formalism. This is easiest proved by
using the stacks [SnX] and the obvious correspondendence between them;
then if the cohomology theory is the “orbifold cohomology” (which here
is essentially K-theory of Xn, equivariant with respect to the symmetric
group) this induces our correspondence in the homology of S˜nX. In fact,
in this form the theorem makes sense for any variety X (of any dimension),
and the orbifold cohomology3; the remarkable thing about surfaces is the
additional intepretation in terms of honest seperated smooth varieties.
We would now like to describe generators for S, and identify S with a
Fock space as in §1.
Let Σ ⊆ X be a curve, SnΣ its n’th symmetric power. If Σ is algebraic,
we can canonically identify SnΣ with the Hilbert scheme of zero dimen-
sional subschemes of Σ of length n, so we can also regard SnΣ as contained
in S˜nX. It is a smooth subvariety, and Lagrangian if X is symplectic.
Remarkably, the following generalisation appears to be new:
Write Σ˜ for the subspace of points x ∈ S˜nX such that π(x) ∈ SnΣ,
and Σ˜0λ for Σ˜ ∩ S˜nλX, where λ ∈ Pn, and S˜nλX is the piece of stratiﬁcation
deﬁned above. Explicitly, A ∈ S˜nX is in Σ˜0λ if λ = (1α12α2 · · · ), and A is
isomorphic to a direct sum ⊕Ai,r, where 1 ≤ r ≤ αi, each Ai,r ∈ S˜iX has
support a single point with multiplicity i, π(Ai,r) = iγi,r, and the points
γi,r are distinct. Write Σ˜λ for the closure of Σ˜0λ in S˜nX.
Proposition 3.
i) Σ˜ has pure dimension n, Σ˜0λ has pure dimension n, and the Σ˜λ, λ ∈
Pn, are precisely the irreducible components of Σ˜.
ii) If X is symplectic, then Σ˜ is a Lagrangian submanifold.
See §6 below for more remarks on Σ˜.
Write hΣn for the class of S
nΣ ↪→ S˜nX inside S. (Note that as a conse-
quence of the proposition, we can deﬁne this class even if Σ is not algebraic,
though we do not need to.) We adopt the convention that hΣ0 = 1, for all
Σ.
3i.e. let F = ⊕nKSn (Xn,C), for X any variety. Then the theorem is that F is a
Fock space modeled on H∗(X,C), with multiplication and comultiplication deﬁned by
the obvious correspondence. Like everything else stated here, the proof of this fact will
appear in the longer version of this paper.
284 I. GROJNOWSKI
Proposition 4.
i) The elements hΣn are group-like, i.e.
∆hΣn =
∑
a+b=n
hΣa ⊗ hΣb .
ii) Let Σ, Σ′ be two curves in X. Then∑
n,m≥0
(hΣn , h
Σ′
m )t
nsm = (1 + ts)(Σ,Σ
′)
where (Σ,Σ′) denotes the inner product in H(X), as usual.
Now, for n ≥ 0 deﬁne ΓX = ΓXn = S˜n(n)X, a closed irreducible subvariety
of S˜nX. So ΓX = {A ∈ S˜nX | π(A) = nx, for some x ∈ X} = X ×SnX
S˜nX. Write π : ΓX → X, and deﬁne for any submanifold Z ⊆ X, ΓZ =
ΓZn ⊆ ΓXn by ΓZ = π−1(Z), i.e. so that the diagram
ΓZ −−−−→ ΓX −−−−→ S˜nX
π
 π π
Z −−−−→ X n−−−−→ SnX
is Cartesian. In particular, if Σ ⊆ X is an algebraic curve, ΓΣ = Σ˜(n) in
the notation above. Also write rZn for the class of Γ
Z
n in H(S˜nX). We then
have
Lemma 5. There exists a function f : Z → Z, and polynomials in in-
ﬁnitely many variables pna(x1, x2, . . . ), q
n
b (x1, x2, . . . ) such that for any sub-
manifolds Z, Z ′ of X,
i) (rZn , r
Z′
n ) = (Z, Z
′)f(n), and
ii) ∆rZn =
∑
a+b=n
pna(r
Z
1 , r
Z
2 , . . . )⊗ qnb (rZ1 , rZ2 , . . . )
Now observe that for a ﬁxed algebraic curve Σ, the algbera generated by
the rΣn , n ∈ Z+, is the same as the algebra generated by the hΣn , n ∈ Z+.
As a consequence of lemma 5, we can write hΣn as a polynomial in the r
Σ
i
with “universal” coeﬃcients; i.e. coeﬃcients independent of Σ. This allows
us to deﬁne hZn , for any Z ⊆ X by the same formulae. It then follows from
lemma 5 and proposition 4 that the hZn are also group like, and satisfy the
same inner product formulae as in proposition 4.
Take H(X) = H∗(X) (usual cohomology), so S = ⊕H∗(S˜nX), and let
Zi, i = 1, . . . , l run through submanifolds of X such that the classes [Zi]
form a basis in H∗(X,C).
INSTANTONS AND AFFINE ALGEBRAS 285
Proposition 6. The elements rZin freely generate S as an algebra.
Now let X be projective, so that the lattice H∗(X,Z)/torsion is a non-
degenerate lattice with respect to the form (, ). We have thus proved
Theorem 7. S forms a Fock space modeled on the lattice H∗(X,Z)/torsion.
If X is aﬃne, one easily shows that if we take H(X) = H 1
2 dim X
(X,C)
to be middle dimensional Borel-Moore homology, that the lattice L =
H 1
2 dim X
(X,Z) is non-degenerate and S (for this cohomology theory) is
a Fock space modeled on L. This is precisely the case that occurs for X an
ALE space.
For smooth projective X, let us agree to write SΛ = ⊕HΛ(S˜nX), where
HΛ as in §2 denotes either toplogical, (n, n), holomorphic or Lagrangian
middle dimensional cycles, and let us still write S = ⊕H∗(S˜nX). Clearly
SΛ is a Hopf subalgebra of S, and we can describe it explicitly using the
above theorem.
For example, consider the Hodge decomposition of H∗(S˜nX); write
Sabn = H
a,b(S˜nX). Then multiplication in S preserves all this grading:
Sabn · Scdm ⊆ Sa+c,b+dn+m . The generators rZn ∈ Sn have degree (n− 1, n− 1) +
deg Z, i.e. if [Z] ∈ Hp,q(X,C) then rZn ∈ Sn+p−1,n+q−1n . This gives another
proof of [Got,3.1], independent of [GS].
Observe that SΛ is usually not a Fock space modeled on a lattice. For
example, if the odd cohomology of X vanishes, the generating function
dimSn,nn z
n is the coeﬃcent of u0 in
∏
n≥1
(
(1− znu)(1− znu−1))−h2,0(1− zn)−h1,1
which is not the generating function of a Fock space.
4. Vertex algebras and U(1)-instantons
Let X be a smooth projective surface. A torsion free sheaf E is a coherent
sheaf of OX -modules which is torsion free as a OX -module. If E∗ denotes
the dual of E , we have a canonical exact sequence 0 → E → E∗∗ → Q→ 0,
where Q is coherent of ﬁnite length, and E∗∗ is locally free. We say E has
rank c if E∗∗ does.
Let H be a ﬁxed very ample divisor on X, and M (resp. M¯) the space
of H-stable rank c torsion free sheaves (resp. H-semistable torsion free
sheaves, modulo the usual equivalence relation [Gi]). Then M¯ is a pro-
jective variety, and M ⊆ M¯ an open subvariety [Gi]. Clearly M¯ =∐
c1,k
M¯c1,k, where M¯c1,k consists of torsion free sheaves E with Chern
286 I. GROJNOWSKI
classes c1(E) = c1, ch2(E) = k. Also, c1(E) lands in the lattice of algebraic
cycles c1(E) ∈ HΛ(X,Z).
In the sequel we will be concerned with elementary modiﬁcations, and
hence the interior of moduli space. For now, as we are only concerned
with the boundary of moduli space, let us suppose c = 1. Further, for
simplicity, suppose π1(X) = 0. Then H1(X,Z) = H3(X,Z) = 0, and
H2(X,Z) is torsion free. Suppose also that X is spin, so H2(X,Z) is even.
Now, in this case line bundles have no moduli, and so the space of torsion
free sheaves is isomorphic to
⊕λ∈HΛ(X,Z)(⊕nS˜nX)⊗ eλ.
Observe that the moduli of torsion free sheaves E such that E∗∗ is isomor-
phic to L is canonically isomorphic to those with E∗∗ isomorphic to L′; the
map is just E → E ⊗ (L′ ⊗ L−1). This deﬁnes the action of the lattice
HΛ(X,Z) on the moduli space of rank 1 torsion free sheaves. (If X is not
simply connected, we must replace this action by elementary modiﬁcations;
this will be explained in the sequel).
Let us write L = H∗(X,Z), and M′ = (⊕nS˜nX)× L,
F = ⊕H∗(S˜nX,C)⊗C{L} = S ⊗C{L}.
Then M′ is “almost” the moduli space of topological U(1)-instantons; i.e.
the hyper-Ka¨hler resolution of the ideal ASD-connections on toplogical
U(1)-bundles. (It would be interesting to give a purely algebraic construc-
tion of this space). It diﬀers from this by the term H0(X,Z) + H4(X,Z),
which I do not know how to intepret geometrically. Yet.
In any case, the results of §3 tell us
Theorem. F is a vertex algebra.
and that if X is an ALE space, so L = H2(X,Z) is negative deﬁnite, that
the analogously deﬁned F (which is now precisely the homology of rank
1 torsion free sheaves) is just the basic representation of ĝ, where ĝ is the
aﬃne Lie algebra associated to L.
Also, we remark that the theorem is true for an arbitrary compact Ka¨hler
4-manifold, where we use the orbifold cohomology.
5. Torsion free sheaves of rank c produce central charge c
Let V be a vector bundle of rank c on X, and let TV,n consist of the
stack of torsion free sheaves E such that E∗∗ is isomorphic to V. Then if
INSTANTONS AND AFFINE ALGEBRAS 287
V is stable (resp. semistable), so is any E ∈ TV,n (though not conversely),
and in that case TV,n is a smooth separated variety.
Deﬁne QV = ⊕nH(TV,n), where H is any reasonable cohomology theory.
One may handle QV as one handles S in §3, by deﬁning an action of S on
QV , S ⊗QV mV−−→ QV induced by the correspondence
Λ0 = {(A1,A2,A3) ∈ TV,a × TV,a+b × S˜bX |
A2 ∈ T 0V,a+b, and there is an exact sequence 0 → A1 → A2 → A3 → 0}
and Λ is the closure of Λ0. Here, T 0V,n consists of those torsion free sheaves
E which ﬁt into an exact sequence E → V → Q, where Q ∈ (S˜nX)0.
Then one may proceed exactly as in §3, and show
Theorem. QV is a module for the Heisenberg Lie algebra
(⊕n =0H∗(X,C)⊗ tn)⊕C with central charge c.
It is pleasant to calculate
[hΣ1 , h
Σ‘
−1] = c(Σ,Σ
′)
directly. This follows directly from the easy fact that if E is any torsion
free sheaf of generic rank c, and C0 denotes the skyscraper sheaf at a point
0 ∈ X, then
Lemma. dimExt1(C0, E) + c = dimHom(E ,C0).
In the particular case that c = 1, this may be intepreted as (and in fact
follows from) the fact that there is one way more to add a square to a
partition than to remove a square. (As one may complete X at 0, to get
C[[x, y]]. This admits a C∗-action, such that xiyj have distinct weights for
i + j ≤ n . Then the ﬁxpoints of this C∗ action on the Hilbert scheme of
length n subschemes are just in 1-1 correspondence with partitions of n,
and this punctual Hilbert scheme partitions into vector bundles over these
isolated ﬁxpoints. This makes the lemma obvious in this case, and gives
yet another reason why the Hodge theory of H∗(S˜nX) is so simple).
6. Remarks on curves
Suppose Σ ⊆ X is an algebraic curve. Replace X with the normal bundle
to Σ in X, so that X admits a contracting C∗ action with ﬁxpoints Σ, that
is if x ∈ X, limt→0 t · x exists and is in Σ. This C∗ action induces one on
S˜nX, and we deﬁne
U = {A ∈ S˜nX | lim
t→0
t · x ∈ SnΣ}
where SnΣ ↪→ S˜nX as in §3.
288 I. GROJNOWSKI
Proposition.
i) U is open in S˜nX, and U is a rank n vector bundle on SnΣ.
ii) Suppose X = T ∗Σ. Then U canonically identiﬁes with T ∗(SnΣ).
Under this identiﬁcation, the Lagrangian subvariety Σ˜ ∩ U identiﬁes with
Laumon’s global nilpotent cone, a Lagrangian subvariety in T ∗(SnΣ) [La].
Because of this proposition, a perverse sheaf on SnΣ with nilpotent
characteristic variety (for example, conjecturally any automorphic sheaf)
gives rise to a cycle in HΛ(S˜nX) via the characteristic cycle map.
Its also worth remarking that if Σ is the aﬃne line, SnΣ canonically
identiﬁes with the variety of regular conjugacy classes in gln (via the char-
acteristic polynomial). Thus SnΣ, for Σ a curve of genus g, which classi-
cally4 one regards as a genus g generalisation of regular conjugacy classes,
is here generalised ‘microlocally’ to produce two dimensional analogues of
conjugacy classes. (As the curve Σ varies, this really does feel two dimen-
sional).
Note that we do not want to consider the stack of coherent sheaves of
length n here (the analogue of the stack of all conjugacy classes in gln), as
in our case the central charge would vary: QuotV,r has central charge the
rank of V , where V is a vector bundle on X.
7. Remarks on Nakajima’s quiver varieties and [Gr1]
Let g be a Kac-Moody Lie algebra, with symmetric Cartan matrix. In
[L1], Lusztig deﬁned a variety, the moduli space of representations of the
quiver associated to g, and a Lagrangian subvariety Λ such that the middle
dimensional cycles on Λ (HΛ(Λ) in the notation of §2) realises the universal
Verma module for g.
In [Na] Nakajima constructed a modiﬁed quiver variety Mξ(w), depend-
ing on a highest weight w and a ξ ∈ h, where h is the “real” Cartan subal-
gebra of g, with the following properties:
i) If ξ is generic, then HΛ(Mξ(w)) realises the irreducible integrable
highest weight module with highest weight w, and the Chevalley generators
of g act on Mξ(w) by corrspondences.
ii) If g is of aﬃne type, and tr ξ = 0, then Mξ(w) is the moduli of
U(n)-instantons on the ALE space Xξ, with monodromy at ∞ determined
by w. (We refer to [KN,N] for all these terms).
In other words, in case (i) Nakajima “cuts down” a Verma module to
get an irreducible highest weight module. Unfortunately, (i) and (ii) cannot
4‘classically’ here means after the work of Drinfeld.
INSTANTONS AND AFFINE ALGEBRAS 289
occur simultaneously5. For example, Mξ(0) is a point if ξ is generic, but
if ξ is generic trace free it is the Hilbert scheme on Xξ.
So, if we care about the moduli of instantons on an ALE space, we must
do some extra work from [Na]. Obviously, this is the content of this paper,
which complements [Na] even in the case of an ALE space. (Using [Lu2,Na]
one can obtain the results above in the quiver language directly. This will
appear in [Gr1]).
The point of this series of papers is to use elementary representation
theory to obtain information about the moduli space of instantons. In
the quiver variety case (for ξ generic), one may reverse this, and use the
geometry of quiver varieties to obtain new information about quantum
aﬃne algebras.
Speciﬁcally, let g be a Kac-Moody algebra, and Uqĝ the associated quan-
tum aﬃne algebra at central charge 0 [Dr,Gr2]. If g is ﬁnite dimensional,
we can consider the category of ﬁnite dimensional representations of Uqĝ;
for the deﬁnition for general g see [Gr1] (these representations have the
property that they restrict to a direct sum of integrable highest weight
representations of Uqg ↪→ Uqĝ). Then, as was discovered by Drinfeld, these
representations are not deformations of the analogous representations of ĝ
(the “evaluation representations” and their tensor products); smaller terms
must be added.
The reason for this is that the varieties Mξ(w) are not zero dimensional;
i.e. H∗(Mξ(w)) is HΛ(Mξ(w)) plus smaller terms.
Geometrically, we take as our reasonable cohomology theory
KGLW×C
∗
(Mξ(w)), which takes full account of the geometric symmetries
of Mξ(w). Then in [Gr1] it is proved that KGLW×C∗(Mξ(w)), admits an
action of Uqĝ (see also [Gr2]). This explains the occurance of the middle
homology in [Na].
Also, to continue the advertisement of [Gr1], we construct all of Uqĝ.
Namely, we take equivariant cohomology of the Lagrangian subvariety of
Mξ(w) ×Mξ(w) consisiting of pairs with the same moment map image.
This constructs a piece of Uqĝ (and the same variety was independantly
discovered by Nakajima in [Na2], where he used it to construct a piece of
the enveloping algebra of g). These pieces ﬁt togethor via the coproduct—
write w = w′ + w′′. This deﬁnes a C∗ action on Mξ(w), with ﬁxpoints
of the form Mξ(w′) × Mξ(w′′). Then one may deﬁne a coproduct via
localisation to the ﬁxpoints, and this coproduct ﬁts these pieces togethor
to produce Uqĝ.
This coproduct, at the q = 1 non-aﬃne level, realises the map Lw′ ⊗
Lw′′ → Lw′+w′′ , where Lw is the irreducible highest weight module for g
5This was explained to me by Greg Moore.
290 I. GROJNOWSKI
with highest weight w.
Finally, we describe the irreducible modules (even at roots of unity) in
terms of certain perverse sheaves with nilpotent characteristc variety on
Nakajima’s moduli space M0(w).
In the case g = gln, this construction of the algebra is due to Ginzburg
and Vasserot [GV]; the moduli space is due to Beilinson-Lusztig-MacPhe-
rson [BLM]; and the coproduct appeared in [Gr3]. That such a geometric
picture of the representation theory of Uqĝ should exist was conjectured by
Drinfeld, on the basis of Kazhdan and Lusztig’s description of the repre-
sentation theory of aﬃne Hecke algebras, which is similar to this. This was
explained to me by G. Lusztig, in 1991.
References
[BLM] A. A. Beilinson, G. Lusztig, and R. MacPherson, A geometric setting for the
quantum deformation of GLn, Duke Math. J. 62 (1990), 655-677.
[B] R. Borcherds, Vertex algebras, Kac-Moody algebras and the monster, Proc.
Natl. Acad. Sci. 83 (1986), 3068–3071.
[Br] J. Briancon, Description de HilbnC{x, y}, Invent. Math 41 (1977), 45–89.
[Dr] V. Drinfeld, A new realisation of Yangians and quantized aﬃne algebras, Soviet
Math. Dokl. 36 (1988), 212–216.
[LMNS] A. Losev, G. Moore, N. Nekrasov, and S. Shatashvili, Four-dimensional avatars
of two dimensional CFT, talk at USC, March 1995, and paper in preparation.
[FJ] I. Frenkel and N. Jing, Vertex representations of quantum aﬃne algebras, Proc.
Natl. Acad. Sci. 85 (1988), 9373–9377.
[FK] I. Frenkel and V. Kac, Basic representation of aﬃne Lie algebras and dula
resonance models, Invent. Math 62 (1980), 23–66.
[FLM] I. Frenkel, J. Lepowsky, and A. Meurman, Vertex operator algebras and the
monster, vol. 134, Pure and applied math, Academic Press, 1988.
[Fo] J. Fogarty, Algebraic families on an algebraic surface, Am. J. Math 90 (1968),
511–521.
[Gi] D. Gieseker, On the moduli of vector bundles on an algebraic surface, Ann. of
Math 106 (1977), 45–60.
[GL] D. Gieseker and J. Li, Irreducibility of moduli of rank 2 vector bundles on
algebraic surfaces, J. Diﬀ. Geom. 40 (1994), 23–104.
[GV] V. Ginzburg and E. Vasserot, Langlands reciprocity for aﬃne quantum groups
of type An, Int. Math. Research Notes 3 (1993), 67–85.
[Got] L. Gottsche, The Betti numbers of the Hilbert scheme of points on a smooth
projective surface, Math Ann. 286 (1990), 193–207.
[GS] L. Gottsche and W. Soergel, Perverse sheaves and the cohomology of the Hilbert
scheme of a smooth algebraic surface, Math Ann. 296 (1993), 235–245.
[Gr1] I. Grojnowski, Representations of quantum aﬃne algebras, Yale University
course notes (1994), book in preparation.
[Gr2] , Aﬃnizing quantum algebras: from D-modules to K-theory, preprint
1994, posted to q-alg.
[Gr3] , The coproduct for quantum GLn, preprint 1992.
[Gro] A. Grothendieck, Techniques de construction et theorems d’existance en geome-
trie algebrique IV: Les schemas de Hilbert, Sem. Bourb., Expose 221 (1960).
INSTANTONS AND AFFINE ALGEBRAS 291
[JKS] U. Jannsen, S. Kleiman, and J. P. Serre (eds), Motives, Proc. Symp Pure Math
55 (1994).
[KM] P. Kronheimer and T. Mrowka, Embedded surfaces and the structure of Don-
aldson polynomial invariants, preprint 1994.
[KN] P. Kronheimer and H. Nakajima, Yang-Mills instantons on ALE gravitational
Instantons, Math Ann. 288 (1990), 263-307.
[La] G. Laumon, Un analogue global du cone nilpotent, Duke Math Jour. 57 (1988),
647–671.
[L1] G. Lusztig, Quivers, perverse sheaves and quantized enveloping algebras, J.
Amer. Math. Soc. 4 (1991), 365-421.
[L2] , Aﬃne quivers and canonical bases, Publ. Math IHES 76 (1992), 111-
163.
[MO] J. Morgan and K. O’Grady, Diﬀerential topology of complex surfaces, Springer
LNM 1545 (1993).
[Na] H. Nakajima, Instantons on ALE spaces, quivers, and Kac-Moody algebras,
Duke Math Jour. 76 (1995), 365–416.
[VW] C. Vafa and E. Witten, A strong coupling test of S-duality, hep-th/9408074
(1994).
E van s H a ll , U .C . B erk e ley , B erk e ley , C A 94 7 2 0 – 3 8 4 0
E-mail address: ian@math.berkeley.edu
