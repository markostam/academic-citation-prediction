Syst. Biol. 49(4):652–670, 2000
Likelihood-Based Tests of Topologies in Phylogenetics
NICK GOLDMAN,1 JON P. ANDERSON,2 AND ALLEN G. RODRIGO3
1University Museum of Zoology, Department of Zoology, University of Cambridge, Cambridge CB2 3EJ, UK;
E-mail: N.Goldman@zoo.cam.ac.uk
2Department of Molecular Biotechnology, University of Washington, Seattle, Washington USA
3School of Biological Sciences, University of Auckland, Auckland, New Zealand
Abstract.—Likelihood-based statistical tests of competing evolutionary hypotheses (tree topolo-
gies) have been available for approximately a decade. By far the most commonly used is the
Kishino–Hasegawa test. However, the assumptions that have to be made to ensure the validity
of the Kishino–Hasegawa test place important restrictions on its applicability. In particular, it is
only valid when the topologies being compared are specied a priori. Unfortunately, this means
that the Kishino–Hasegawa test may be severely biased in many cases in which it is now com-
monly used: for example, in any case in which one of the competing topologies has been selected
for testing because it is the maximum likelihood topology for the data set at hand. We review
the theory of the Kishino–Hasegawa test and contend that for the majority of popular applica-
tions this test should not be used. Previously published results from invalid applications of the
Kishino–Hasegawa test should be treated extremely cautiously, and future applications should use
appropriate alternative tests instead. We review such alternative tests, both nonparametric and
parametric, and give two examples which illustrate the importance of our contentions. [Kishino–
Hasegawa test; maximum likelihood; phylogeny; Shimodaira–Hasegawa test; statistical tests; tree
topology.]
HasegawaandKishino (1989) and Kishino
andHasegawa(1989)developedmethods for
estimating the standarderror and condence
intervals for the difference in log-likelihoods
between two topologically distinct phylo-
genetic trees representing hypotheses that
might explain particular aligned sequence
data sets. The method initially was intro-
duced to compute condence intervals on
posterior probabilities for topologies in a
Bayesian analysis (Hasegawa and Kishino,
1989; Kishino and Hasegawa, 1989). Atten-
tionquickly turned to using the same ideas to
perform nonparametric likelihood ratio tests
(LRTs) of the statisticalsignicance of topolo-
gies (Kishino and Hasegawa, 1989), as cur-
rently implemented in the popular PHYLIP
(Felsenstein, 1995), MOLPHY (Adachi and
Hasegawa, 1996), PUZZLE (Strimmer and
von Haeseler, 1996; Strimmer et al., 1997),
and PAUP* (Swofford, 1998) software pack-
ages. Tests based on the ideas of Kishino and
Hasegawa (hereafter referred to as KH-tests)
could overcome some of the peculiar prop-
erties of phylogenetic estimation (see, e.g.,
Yang et al., 1995), for example, that differ-
ent topologies do not share the same sets of
parameters and do not generally represent
nested hypotheses (one hypothesis being a
special case of another).
Kishino and Hasegawa originally devised
and applied their methods for trees thatwere
specied a priori, that is, trees that corre-
sponded tophylogenetic hypotheses derived
independently of the data at hand. However,
since then, the KH-test has in the majority
of cases been used to compare themaximum
likelihood (ML) tree derived from the data
to one or more a priori–specied trees or to
one or more a posteriori–specied trees (e.g.,
the trees with second-, third-, and so forth
highest likelihoods). Such applicationsarefa-
cilitated, even encouraged, by various soft-
ware packages. We contend that these latter
applications of the KH-test are incorrect. We
are not the rst to note this: Swofford et al.
(1996) observed that the KH-test should be
applied only when the trees in question are
specied a priori. Shimodaira andHasegawa
(1999) recently made the same point and de-
scribed a correct nonparametric test for the
case in which the ML tree is one of the tested
topologies.
In this paper, we review the published lit-
erature on likelihood-based tests of topolo-
gies in phylogenetics. We wish to draw at-
tention to the inapplicability of the KH-test
formany common situations, despite the fact
that it has become the most widely used and
generally acceptedway of testing alternative
652
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 653
hypotheses of evolutionary relationship. We
rst look in detail at theKH-test, in particular
reviewing the conditions for its correct ap-
plication and considering various methods
that can be used to generate the null hy-
pothesis distribution of the KH-test statis-
tic.We then consider alternative applications
of the KH-test, which represent the major-
ity of published applications, and discuss
why these are incorrect. We contend that
the bias inherent in the KH-test when ap-
plied incorrectly warrants that the results
of such applications be treated extremely
cautiously. Next, we describe both the non-
parametric test introduced by Shimodaira
and Hasegawa (1999) and a parametric LRT
of topologies, described briey by Swofford
et al. (1996) and based on the parametric
bootstrap or Monte Carlo simulation ap-
proach to hypothesis testing using likeli-
hood ratio statistics advocated by Goldman
and others (e.g., Goldman, 1993; Hillis
et al., 1996;Huelsenbeck and Crandall, 1997;
Huelsenbeck and Rannala, 1997).
All of the methods described in this pa-
per are equally relevant to ML analyses of
DNA and amino acid (aa) data. We provide
two analyses comparing the results of dif-
ferent tests, one using DNA sequences from
HIV-1 isolates and one using aa sequences
from mammalian mitochondrial (mt) pro-
teins. These examples illustrate the impor-
tance of understanding precisely what hy-
potheses are being tested, the importance of
performing statistically valid tests, and the
differing power of parametric and nonpara-
metric tests. We conclude with a discussion
of the importance of our and others’ recent
work on the theory of tests of topologies.
The likelihood-based test developed from
the work of Hasegawa and Kishino (1989)
and Kishino and Hasegawa (1989) is quite
closely related to a parsimony-based test
described by Templeton (1983). Kishino
and Hasegawa (1989 : 177) also discussed
parsimony-based analogs of their likelihood
methods. Such parsimony-based tests are
subject to precisely the same misuses de-
scribed in this paper for likelihood-based
tests. In their unmodied forms, they too
should not be usedwith phylogenies that are
not selected a priori. Derivation of their cor-
rected forms could follow the same general
approaches described below (Buckley et al.,
unpubl.).
METHODS
Terminology and Notation
For thepurposes of this paper,we are inter-
ested in the topologies of phylogenetic trees,
not in the lengths of the branches on those
trees.We use T j to denote the topology of the
jth prespecied tree, and TML for the topol-
ogyof theML tree for a givendata set. Implic-
itly, because we focus on likelihood-based
models, we assume that some model of evo-
lution that allows us to dene the probabil-
ityof character-statechanges canbe specied
before tree reconstruction. The vector of pa-
rameters for branch lengths (plus any other
free parameters, e.g., in the model of nu-
cleotide substitutionbeing used) iswritten h x
for topology Tx . H0 and HA are, respectively,
null and alternative hypotheses for statisti-
cal testing. Lx is the log-likelihood of Tx or
Hx for a given data set, generally maximized
over all possible values of h x, and Lx(k) is the
sitewise log-likelihood for site k out of a total
of S sites, so Lx =
S
k=1 Lx(k). For paramet-
ric or nonparametric bootstrapped data, L (i )x
is the log-likelihood of Tx for the ith replicate
data set, and L (i)x (k) is the corresponding site-
wise log-likelihood. We use d to denote the
difference in log-likelihoods between topolo-
gies (d (i ) for the value from the ith replicate
data set), E[X] to denote the expectation of
a statistic X, andN(l r 2) to indicate a nor-
mal (gaussian) distributionwith mean l and
variance r 2.
Fundamentals of the KH-Test
Suppose we have two hypotheses (tree
topologies) T1 and T2, selected a priori, and
wewant to testwhether they are equallywell
supported by a data set. Intuitively, for any
one data set wewould expect that stochastic-
ity and sampling would ensure L1 6= L2, even
when the null hypothesis is true. However, if
wewere somehowable to obtain several data
sets, we would expect that “on average” L1
= L2 when the null hypothesis is true. Writ-
ing d ´ L1 ¡ L2, this intuition corresponds
to E[ d ] = 0. In terms of a statistical test, our
hypotheses are:
H0: E[ d ] = 0
HA: E[ d ] 6= 0.
654 SYSTEMATIC BIOLOGY VOL. 49
In this section we describe a nonparamet-
ric approach to performing this compari-
son. This method was essentially given by
HasegawaandKishino (1989), although they
did not use the procedure for signicance
testing.
To perform a test ofH0 versusHA, we need
to know the distribution of d under the null
hypothesis. Working nonparametrically, we
cannot derive the exact distribution of d be-
cause H0 does not specify a distribution for
the data from which it is calculated. We are
able, however, to implement the nonpara-
metric bootstrap (Efron, 1982; Felsenstein
1985; Efron and Tibshirani, 1986), the use of
which requires the assumption that the data
are a representative and independent sample
from the true distribution of data.
Table 1 summarizes all of the statistical
tests discussed in this paper and explains the
mnemonic naming systemwe have adopted.
Table 2 relates this naming system to var-
ious published tests and software imple-
mentations (all described below). The proce-
dure for the fundamental KH-test is now as
follows:
Test priNPfcd:
² Calculate the test statistic d ´ L1 ¡ L2.
² Resample data (repeated nonparametric
bootstrap data sets i).
² Reestimate any free parameters h 1, h 2
(branch lengths, and so forth) to getmax-
imized log-likelihoods L (i )1 and L
(i )
2 un-
der T1 and T2, respectively.
² Hence calculate bootstrap values of d (i )
´ L (i )1 ¡ L (i )2 .
² For the values of d (i ) to conform to H0,
we require E[ d (i )] = 0; to ensure this, re-
place the d (i ) by ˜d (i ) ´ d (i ) ¡ ød (i ), where ød (i )
is the mean over bootstrap replicates i of
d (i ). This procedure is known as “center-
ing” (see below), and the resulting set of
values ˜d (i ) gives an estimate of the distri-
bution of d under H0.
² Test whether the attained value of d
(from the original data) is a plausible
sample from the distribution of the ˜d (i )
by seeing if it falls within the condence
interval for E[ d ], given, for example, by
the 2.5% and 97.5% points of the ranked
list of the ˜d (i ). A two-sided test is appro-
priate (because we have no a priori ex-
pectation as to whether T1 or T2 should
be preferred); in this example, a 5% sig-
nicance level is being used.
Hope (1968) and Marriott (1979) consider
the amount of resampling that is needed for
reliable statisticalproperties. It seems reason-
able to hope that 100 data sets will give a suf-
ciently accurate estimate of the distribution
of d for testing at the 5% level, for both non-
parametric (resampled data) and parametric
(simulated data; see below) tests.More strin-
gent tests will require more replicate data
sets.
Hall and Wilson (1991) and Westfall and
Young (1993 : 35) explainmore fully theneed
for the centering procedure (˜d (i ) ´ d (i ) ¡ ød (i );
Table 1, level 4,option c) to ensure conformity
to the null hypothesis in this and other non-
parametric tests. Comparing the observed
value d with the distribution of the d (i ) (as
is appropriate in parametric tests; see below
and Table 1, level 4, option u) would give an
invalid test. A test comparing the expected
value of d (i.e., 0) with the (uncentered) dis-
tribution of the d (i ) is less inappropriate but
is equivalent to comparing ød (i) with the dis-
tribution of the ˜d (i ). This in turn is equivalent
to using ød (i ) as an estimate of the test statis-
tic d , which is inefcient and without any
redeeming advantage (see also Efron et al.,
1996). We note that under the more power-
ful normal approximations discussed below
(Table 1, level 5, options a and s) a test com-
paring 0 with the distribution of the d (i ) be-
comes equivalent to the test that compares d
with the distribution of the ˜d (i ).
The rst stages of this test (up to the cal-
culation of the d (i )) form the procedure at
the heart the work of Hasegawa and Kishino
(1989). In that paper, however, signicance
testing of phylogenies is not contemplated
(there is no mention of the hypothesis E[ d ] =
0) and instead the estimated distribution of
d is used to compute condence intervals on
posterior probabilities of different (a priori)
topologies in a Bayesian analysis. The idea
of using the distribution of the d (i ) to per-
form a signicance test of phylogenies based
on E[ d ] = 0 was introduced by Kishino and
Hasegawa (1989), with some methods being
partially described in Hasegawa et al. (1988).
To our knowledge, the above form (priNPfcd)
of the KH-test has never been implemented.
At the time of this test’s introduction, one
TA
B
L
E
1.
C
om
p
on
en
ts
of
st
at
is
ti
ca
lt
es
ts
d
es
cr
ib
ed
in
th
is
p
ap
er
.E
ac
h
te
st
is
co
m
p
os
ed
of
on
e
op
ti
on
ch
os
en
at
ea
ch
of
th
e

ve
le
ve
ls
.N
ot
al
lc
om
bi
n
at
io
ns
ar
e
va
lid
,a
s
in
d
ic
at
ed
.M
ne
m
on
ic
co
d
es
ar
e
d
er
iv
ed
by
co
n
ca
te
na
ti
n
g
th
e
it
al
ic
iz
ed
le
tt
er
s
la
be
li
ng
ea
ch
op
ti
on
;t
h
e
d
er
iv
at
io
n
of
th
es
e
m
ne
m
on
ic
s
is
in
d
ic
at
ed
by
u
nd
er
lin
in
g.
Se
e
te
xt
fo
r
fu
rt
he
r
d
et
ai
ls
.
L
ev
el
3:
L
ev
el
4:
L
ev
el
5:
L
ev
el
1:
L
ev
el
2:
op
ti
m
iz
at
io
n
m
et
h
od
fo
r
te
st
st
at
is
ti
c
an
d
d
is
tr
ib
u
ti
on
ho
w
te
st
is
p
er
fo
rm
ed
or
co
n
d
en
ce
ch
oi
ce
of
tr
ee
s
to
te
st
st
at
is
ti
ca
la
p
p
ro
ac
h
bo
ot
st
ra
pp
ed
d
at
a
ag
ai
ns
tw
h
ic
h
it
is
co
m
p
ar
ed
in
te
rv
al
s
ar
e
ge
n
er
at
ed
pr
i:
tr
ee
s
ch
os
en
a
p
ri
or
i
N
P
:n
on
p
ar
am
et
ri
c
f:
fu
ll
:a
ll
p
ar
am
et
er
s
es
ti
m
at
ed
c:
ce
nt
er
ed
:a
tt
ai
ne
d
d
vs
.d
is
tr
ib
u
ti
on
d:
co
m
p
ar
is
on
of
te
st
st
at
is
ti
c
d
ir
ec
tl
y
w
it
h
fr
om
d
at
a
(a
n
d
op
ti
m
iz
at
io
n
of
ce
n
te
re
d
n
on
p
ar
am
et
ri
c
it
s
es
ti
m
at
ed
d
is
tr
ib
u
ti
on
ov
er
m
u
lt
ip
le
to
p
ol
og
ie
s
w
it
h
es
ti
m
at
es
˜ d(
i )
´
d
(i
)
¡
ø d(
i )
(o
nl
y
po
s
op
ti
on
at
le
ve
l1
)
w
it
h
N
P
op
ti
on
at
le
ve
l2
)
po
s:
in
cl
u
d
es
tr
ee
(s
)
P
:p
ar
am
et
ri
c
p:
p
ar
ti
al
:s
om
e
p
ar
am
et
er
s
u:
u
nc
en
te
re
d
:a
tt
ai
ne
d
d
vs
.
n:
as
su
m
p
ti
on
of
no
rm
al
d
is
tr
ib
u
ti
on
fo
r
se
le
ct
ed
a
p
os
te
ri
or
i,

xe
d
at
va
lu
es
es
ti
m
at
ed
fr
om
d
is
tr
ib
u
ti
on
of
p
ar
am
et
ri
c
es
ti
m
at
es
te
st
st
at
is
ti
c
(a
p
p
lic
ab
le
on
ly
w
it
h
pr
i
fr
om
an
al
ys
is
of
d
at
a
to
d
at
a
d
(i
)
(o
nl
y
w
it
h
P
op
ti
on
at
le
ve
l2
)
op
ti
on
at
le
ve
l1
)
be
u
se
d
fo
r
te
st
in
g
n:
no
op
ti
m
iz
at
io
n
fo
r
a:
ad
d
it
io
na
ln
or
m
al
as
su
m
p
ti
on
(v
ar
ia
nc
e
bo
ot
st
ra
p
p
ed
d
at
a
(g
iv
es
ri
se
of
d
es
ti
m
at
ed
fr
om
va
ri
an
ce
of
si
te
w
is
e
to
R
E
L
L
m
et
h
od
s
w
it
h
d
or
n
d
(k
);
ap
p
lic
ab
le
on
ly
w
it
h
bo
th
pr
ia
n
d
op
ti
on
s
at
le
ve
l5
)
n
op
ti
on
s
at
le
ve
ls
1
an
d
3,
re
sp
ec
ti
ve
ly
)
s:
st
ro
n
ge
r
as
su
m
p
ti
on
of
n
or
m
al
d
is
tr
ib
u
ti
on
fo
r
si
te
w
is
e
d
(k
)(
ap
p
lic
ab
le
on
ly
in
co
m
bi
na
ti
on
w
it
h
bo
th
pr
ia
n
d
n
op
ti
on
s
at
le
ve
ls
1
an
d
3,
re
sp
ec
ti
ve
ly
)
655
TA
B
L
E
2.
R
el
at
io
ns
h
ip
s
of
st
at
is
ti
ca
lt
es
ts
p
re
vi
ou
sl
y
d
es
cr
ib
ed
an
d
p
op
u
la
r
so
ft
w
ar
e
im
p
le
m
en
ta
ti
on
s
w
it
h
te
st
s
d
es
cr
ib
ed
in
th
is
p
ap
er
,w
it
h
ad
d
it
io
n
al
n
ot
es
.
In
no
ta
ti
on
of
In
lit
er
at
u
re
/
co
m
p
u
te
r
im
p
le
m
en
ta
ti
on
th
is
p
ap
er
N
ot
es
K
is
hi
no
–H
as
eg
aw
a
te
st
,f
u
nd
am
en
ta
lc
on
ce
p
t
pr
iN
P
fc
d
N
on
p
ar
am
et
ri
c
te
st
;n
ev
er
be
fo
re
p
u
bl
is
h
ed
/
im
p
le
m
en
te
d
in
th
is
fo
rm
a
H
as
eg
aw
a
an
d
K
is
hi
n
o
(1
98
9)
pr
iN
P
f²
²b
D
is
tr
ib
u
ti
on
of
d
d
er
iv
ed
in
a
d
if
fe
re
nt
co
n
te
xt
;n
o
st
at
is
ti
ca
lt
es
ts
p
ec
i
ed
K
is
hi
no
an
d
H
as
eg
aw
a
(1
98
9)
pr
iN
P
n²
²b
R
E
L
L
an
d
no
rm
al
ap
p
ro
xi
m
at
io
ns
in
tr
od
u
ce
d
;s
ta
ti
st
ic
al
te
st
s
on
ly
br
ie

y
d
is
cu
ss
ed
P
H
Y
L
IP
(F
el
se
ns
te
in
,1
99
5)
an
d
P
U
Z
Z
L
E
(S
tr
im
m
er
an
d
pr
iN
P
nc
a
U
se
ad
d
it
io
n
al
n
or
m
al
as
su
m
p
ti
on
an
d
p
er
fo
rm
(t
w
o-
si
d
ed
)
z-
te
st
vo
n
H
ae
se
le
r,
19
96
;S
tr
im
m
er
et
al
.,
19
97
)
im
p
le
m
en
ta
ti
on
s
M
O
L
P
H
Y
im
p
le
m
en
ta
ti
on
(A
d
ac
h
ia
n
d
H
as
eg
aw
a,
19
96
)
pr
iN
P
nc
a
U
se
s
ad
d
it
io
n
al
n
or
m
al
as
su
m
p
ti
on
;e
st
im
at
es
va
ri
an
ce
of
d
bu
tp
er
fo
rm
s
no
te
st
PA
U
P
*
im
p
le
m
en
ta
ti
on
(S
w
of
fo
rd
,1
99
8)
pr
iN
P
nc
s
U
se
s
st
ro
ng
er
no
rm
al
as
su
m
p
ti
on
an
d
p
er
fo
rm
s
(t
w
o-
si
d
ed
)p
ai
re
d
t-
te
st
Sh
im
od
ai
ra
an
d
H
as
eg
aw
a
(1
99
9)
im
p
le
m
en
ta
ti
on
of
pr
iN
P
nc
d
U
se
d
in
an
ex
am
p
le
(w
it
h
R
E
L
L
an
d
a
on
e-
si
d
ed
te
st
),
fo
r
co
m
p
ar
is
on
w
it
h
po
sN
P
nc
d
K
is
hi
no
–H
as
eg
aw
a
te
st
Sh
im
od
ai
ra
–H
as
eg
aw
a
te
st
,f
u
nd
am
en
ta
lc
on
ce
p
t
po
sN
P
fc
d
N
on
p
ar
am
et
ri
c
te
st
;n
ev
er
be
fo
re
im
p
le
m
en
te
d
in
th
is
fo
rm
a
Sh
im
od
ai
ra
an
d
H
as
eg
aw
a
(1
99
9)
po
sN
P
nc
d
U
se
s
R
E
L
L
;t
es
t
d
es
cr
ib
ed
an
d
u
se
d
in
an
ex
am
p
le
SO
W
H
-t
es
t,
fu
nd
am
en
ta
lc
on
ce
p
t
po
sP
fu
d
P
ar
am
et
ri
c
te
st
;o
ri
gi
n
al
ly
d
es
cr
ib
ed
by
Sw
of
fo
rd
et
al
.(
19
96
)
SO
W
H
-t
es
t,
al
te
rn
at
iv
e
im
p
le
m
en
ta
ti
on
in
th
is
p
ap
er
po
sP
pu
d
U
se
d
in
an
ex
am
p
le
(s
om
e
ap
p
ro
xi
m
at
io
ns
u
nd
er
H
A
);
se
e
te
xt
fo
r
d
et
ai
ls
a
T
he
se
te
st
s,
am
on
gs
to
th
er
s,
ar
e
im
p
le
m
en
te
d
in
th
is
p
ap
er
fo
r
th
e
H
IV
-1
d
at
a
se
t.
b
D
ot
s
re
p
re
se
nt
co
m
po
ne
nt
s
of
te
st
in
g
pr
oc
ed
ur
es
th
at
w
er
e
no
ts
p
ec
i
ed
in
th
e
co
rr
es
p
on
di
ng
p
ub
lic
at
io
ns
.
656
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 657
main reason for this was probably the com-
putation time required for the step in which
free parameters h 1, h 2 are reestimated for
eachbootstrapdata set. (Nowadays this com-
putational demand would not be problem-
atic but this form of the test is still not used,
probably because interest is typically in phy-
logenies, at least one of which has been cho-
sen a posteriori—see below.) Accordingly,
methods were devised to reduce the compu-
tational burden.
The KH-Test: Time-Saving Approximations
The fundamentalKH-test (priNPfcd above)
has the disadvantage that likelihood max-
imization is performed for each bootstrap
replicate data set i. Although no maximiza-
tion over topologies is required, because
in this case only two a priori–specied
topologies are being considered,Kishino and
Hasegawa (1989) were concerned about the
computation time needed. To reduce the
computational burden, they developed a re-
sampling estimated log-likelihood (RELL)
technique (Table 1, level 3, option n; see also
Kishino et al., 1990). In brief, they showed
that instead of performing time-consuming
likelihood optimizations for each bootstrap
data set, one could use values of d (i ) calcu-
lated with the optimized parameter values
(ˆh 1, ˆh 2) from the original data set. Certain
asymptotic conditions (correctly specied
evolutionary models and sufciently large
amounts of data) are required for this ap-
proximation to be valid; the RELL method
has been shown to perform well in the esti-
mation of bootstrapprobabilities of phyloge-
nies (Hasegawa and Kishino, 1994; see also
below for discussion of the possible effects
of approximations to log-likelihood scores in
LRTs). The necessary likelihood calculations
now require no optimization after the initial
analysis of the original data, which saves a
large amount of computational effort. By us-
ing a prime symbol ( 0 ) to denote this form
of approximation where parameters are not
re-optimized for replicate data sets, the re-
sulting test can be described as follows:
Test priNPncd:
² Calculate the test statistic d ´ L1 ¡ L2.
² Resample data (repeated bootstrap data
sets i).
² Using the ML estimates of any free pa-
rameters ˆh 1, ˆh 2 (branch lengths and so
forth) derived from the original data set,
compute log-likelihoods L 0 (i)1 and L
0 (i )
2
under T1 andT2, respectively (the resam-
pling is effectively being made from the
sitewise log-likelihoods L1(k) and L2(k)
estimated under H0; hence the RELL
mnemonic).
² Calculate bootstrap values of d 0 (i ) ´
L 0 (i )1 ¡ L 0 (i )2 .² As before, perform the centering proce-
dure ˜d 0 (i ) ´ d 0 (i ) ¡ ød 0 (i ).
² Test whether the attained value of d
(from the original data) is a plausible
sample from the distribution of the ˜d 0 (i )
by seeing if it falls within the condence
interval for E[ d ] given by appropriate
points of the ranked list of the ˜d 0 (i) (two-
sided test).
Kishino and Hasegawa (1989) further
showed that the difference ( d ) in log-
likelihoods between two topologies specied
a priori would follow a normal distribution;
the mean and variance of which could be
specied in terms of the differences in log-
likelihoods ( d (i )) calculated for nonparamet-
ric bootstrap data sets i. This approximation,
based on theCentralLimit Theorem, requires
the same asymptotic conditions as the RELL
method for its validity. An alternative to us-
ing the direct comparison of the attained d
with the distribution of the ˜d 0 (i ), as in the last
step of test priNPncd, is then to utilize this
normal approximation for d (Table 1, level 5,
option n):
Test priNPncn:
² Proceed as in test priNPncd above, but
replace the nal step with the following:
² Compute the variance of the ˜d 0 (i ) (denote
this by m 2) and test whether the attained
value of d (from the original data) is a
plausible sample from aN(0, m 2) distri-
bution, by seeing if it falls within the
condence interval for E[ d ] given, for
example, by 0 § 1.96m (two-sided test;
5% signicance level in this example).
In practice, these tests have rarely been
implemented, to our knowledge. More usu-
ally, an additional assumption is also made:
that the variance of d can be estimated from
the variance (over sites k = 1, 2, . . . , S) of
the sitewise log-likelihood differences d (k) ´
658 SYSTEMATIC BIOLOGY VOL. 49
L (k)1 ¡ L (k)2 (Table 1, level 5, option a; Kishino
and Hasegawa, 1989). In this case a test can
be made without any resampling, thus giv-
ing an even greater saving in time:
Test priNPnca:
² Calculate the test statistic d ´ (L1 ¡ L2).
² Using the ML estimates of any free pa-
rameters ˆh 1, ˆh 2 (branch lengths, and so
forth) derived from the original data set,
compute sitewise log-likelihoods L1(k)
and L2(k), under T1 and T2, respectively,
for the sites k of the original data set.
² Calculate the values d (k) ´ L1(k) ¡ L2(k)
and hence the centered values ˜d (k) ´
d (k) ¡ ød (k) and an estimate of their vari-
ance m 2 = k(˜d (k))
2 /(S ¡ 1) (clearly, the
variancesof the d (k) and the ˜d (k) are iden-
tical). Because d ´ k ˜d (k) + Sød (k), andød = 0 under H0, S m 2 is an estimate of the
variance of d .
² Test whether the attained value of d cal-
culated from the original data is a plausi-
ble sample from aN(0, S m 2) distribution,
for example, by comparing it with the
condence interval 0 § 1.96
p
S m (two-
sided test; 5% signicance level in this
example).
This is themethod implemented invarious
programs of the PHYLIP (Felsenstein, 1995),
MOLPHY (Adachi and Hasegawa, 1996),
and PUZZLE (Strimmer and von Haeseler,
1996; Strimmer et al., 1997) packages. (Pro-
grams in MOLPHY compute
p
Sm but leave
statistical testing to the user).
In Swofford’s (1998) PAUP* program, a
stronger assumption is made (D. Swofford,
pers. comm.): that the sitewise log-likelihood
differences d (k) are themselves normally dis-
tributed (Table 1, level 5, option s). This as-
sumption, if accurate, guarantees the accu-
racyof the normal approximationsdescribed
above (Table 1, level 5, options n and a) and
permits a different test to be performed di-
rectly on the sitewise log-likelihoods:
Test priNPncs:
² Proceed as in test priNPnca above, but
replace the nal two steps with the
following:
² Perform a paired-t-test of the L1(k)
and L2(k) (pairs {L1(1), L2(1)}, {L1(2),
L2(2)}, . . . , {L1(S), L2(S)}) to determine if
the means of the {L1(k)} and {L2(k)} are
equal (two-sided test).
We know of no theoretical justication for
this additional assumption, and it does not
give rise to any signicant saving in com-
putation time. However, we would expect
that it will only make the smallest of dif-
ferences in real applications (with a large
number of sites S), and the signicance lev-
els reported by PAUP* and by the DNAML
program of PHYLIP are invariably very sim-
ilar (J. Felsenstein, pers. comm.; D. Swofford,
pers. comm.; J.P. Anderson, unpubl.). Note
that both the priNPnca and priNPncs tests re-
quire no resampling and so are even faster
than the priNPncd and priNPncn tests, which
use RELL methods.
Incorrect Usage of the KH-Test
Many of the arguments in the derivations
of the statistical tests above are strongly de-
pendent on the topologies T1 and T2 having
been selected independently of any analysis
of the data used for the testing. In particu-
lar, this assumption is necessary to justify the
fundamental hypothesis H0: E[ d ] = 0. Unfor-
tunately,when the selection of topologieshas
been made with reference to the data, espe-
cially if they have been selected by a criterion
linked to their likelihood scores, this expec-
tation is no longer justied. Two particular
cases in which it is not reasonable to expect
E[d ] = 0 are (1) the comparison of the tree
found to have the maximal likelihood, TML,
with an a priori tree, T1, and (2) the compari-
son of TML with a tree selected for having the
second- (or third-, and so forth) highest like-
lihood. In fact, in both of these cases E[ d ] > 0.
TML is selected exactly because its likelihood
for the data at hand is greater than that of
any other tree: In other words, it is guaran-
teed that LML will be at least as large as L1 or
the log-likelihood of any other topology.
This is not a minor discrepancy: no re-
sult suggests that E[d ] will be even near to
0 in these cases. Further, given that neces-
sarily E[ d ] > 0, two-sided tests are no longer
appropriate: we are interested in assessing
deviations only in one “direction” from ex-
pectation, and one-sided tests are required.
In our experience, however, situations such
as those just described in which trees are
selected a posteriori are precisely those for
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 659
which the KH-test has most often been used.
Indeed, even Hasegawa and coworkers ap-
pear to omit consideration of whether E[ d ]
= 0 is a valid assumption (Hasegawa et al.,
1988:8; Kishino and Hasegawa, 1989:175),
even though Kishino and Hasegawa (1989 :
177, equation 20 and following) recognize
that E[d ] depends on how the topologies be-
ing assessed were chosen.
Webelieve that the results ofall such analy-
ses using the KH-test are invalid and require
recomputation bymethods such as those de-
scribed later in this paper. We stress that this
is not a minor, obscure, or purely hypotheti-
cal point, of interest only to theoretical statis-
ticians. Although the KH-test is suitable for
the questions it was designed to answer, it is
entirely inappropriate for use in testing the
signicance of trees selected by ML from the
data which are to be used for the testing. We
can nd only one possible adjustment appli-
cable to the results of incorrect applications
of KH-tests thatmay render them useful; this
is discussed below.
To help illustrate why we can no longer
base tests on the hypothesis E[ d ] = 0, we
use an analogy of running races. The coach
of a running squad is interested to know
whether two runners, Matthew and Mark,
differ signicantly in their average running
times for the 100 m sprint. To determine this,
he times the two runners when they partici-
pate in several races. For each race, the coach
calculates the difference in running times
t between Matthew and Mark: d (Matthew,
Mark) ´ t(Matthew) ¡ t(Mark). Note that
d (Matthew, Mark) can sometimes be positive
and sometimes be negative, depending on
who runs faster in any given race; in fact,
if Matthew and Mark are equally good at
the 100 m sprint, then the average value of
d (Matthew, Mark) over many races will tend
to 0. In fact, as the team statistician approv-
ingly explains, the data the coach has col-
lected can be used to estimate the variance of
d (Matthew, Mark) and, consequently, to test
the following hypothesis:
H0: E[ d (Matthew, Mark)] = 0
HA: E[ d (Matthew, Mark)] 6= 0.
This is analogous to the KH-test for phylo-
genies, withMatthew andMark correspond-
ing to two a priori topologies T1 and T2,
each race equivalent to a sample of data,
t(Matthew) and t(Mark) equivalent to the
log-likelihoods L1 and L2, respectively, and
d (Matthew, Mark) corresponding to the dif-
ference in log-likelihoods d .
The coach is also interested in another
runner, Luke, whom he believes to be the
fastest runner on his squad. Given his suc-
cess at collecting data for the earlier hypoth-
esis test, the coach decides to do something
similar with Luke. He obtains running times
for Luke, t(Luke), over several races amongst
the squad members, as well as the fastest
time for each race, t(fastest). For each race he
computes thedifference between these times,
d (Luke, fastest) ´ t(Luke) ¡ t(fastest), argu-
ing that if Luke truly is the fastest then, over
many races, the average of d (Luke, fastest)
will be zero. However, as the team statis-
tician points out, this assumption is neces-
sarily false. The reason for this is simple. If
Luke truly is the fastest, then we may ex-
pect that in the majority of the races he par-
ticipates in, his time is the fastest time, i.e.,
t(Luke) = t(fastest) and d (Luke, fastest) = 0.
However, we also expect that some other
squad members will manage to win some
races, if only infrequently, so that d (Luke,
fastest) >0. Note that it is never possible that
d (Luke, fastest) <0, and consequently the av-
erage of d (Luke, fastest) over several races
(the majority with d (Luke, fastest) = 0 and
some with d (Luke, fastest) >0) must neces-
sarily be >0. Variations in the squad mem-
bers’ performances in different races ensures
that even if none is systematically faster than
Luke, there is a chance that someone of equal
or lower ability will appear to outperform
Luke in any one race. In fact, the bigger the
squad, themore likely this is, and the greater
the level of outperformance one can expect.
Thestatisticaltestused should reect this fact
and cannot be based on E[ d (Luke, fastest)] ´
E[t(Luke) ¡ t(fastest)] = 0.
This example is analogous to the com-
mon but incorrect application of the KH-
test, when TML and T1 are identied with
the faster runner and Luke, respectively, LML
and L1 with t(fastest) and t(Luke); and d with
d (Luke, fastest). It would be possible, but of
little interest here, to devise a correct test
based on runners selected a posteriori. In-
stead, we will revert to discussing phyloge-
netic examples and will describe two tests
that can be used in place of the KH-test when
it is not applicable.
660 SYSTEMATIC BIOLOGY VOL. 49
The Shimodaira–Hasegawa Test: A Corrected
Nonparametric Test of Topologies
Although it has been noted in the past that
the KH-test is suitable only for cases where
E[ d ] = 0 (Swofford et al., 1996), it appears
that Shimodaira andHasegawa(1999)are the
rst to publish a full explanation of why the
test is not appropriate when one or more
topologies under test were selected with ref-
erence to the same data being used for test-
ing. Our arguments in the preceding section
are essentially an extended version of those
of Shimodaira and Hasegawa (1999). Based
on earlier work by Shimodaira (1993, 1998),
Shimodaira and Hasegawa (1999) have pro-
posed anonparametric test similar to theKH-
test but making the appropriate allowance
for the method by which topologies are usu-
ally selected for statistical comparison. The
Shimodaira–Hasegawa test (SH-test) simul-
taneously compares all topologies in some
setM and makes appropriate allowance for
these multiple comparisons. It is necessary
thatM contains every topology that canpos-
sibly be entertained as the true topology,
to ensure that the true topology is always
“available” to be the ML topology for any
bootstrapdata set; if this condition is notmet,
the signicance levels computedwill be inac-
curate (Westfall and Young, 1993:48). In ad-
dition, selection of topologies for the setM
should be made a priori and not with refer-
ence to the observed data; otherwise, signi-
cance levels will again be inaccurate. Choos-
ingM to be the set of all possible topologies
is always safe, if conservative.
We cannot write the null hypothesis as
E[ d ] = 0 for this test; instead, the hypothe-
ses tested are as follows:
H0: all Tx 2 M (including TML, the ML
tree) are equally good explanations
of the data
HA: some or all Tx 2 M are not equally
good explanations of the data
and the test may proceed as follows:
Test posNPfcd:
² Calculate a test statistic d x for each topol-
ogy Tx 2 M: d x is the attained value of
LML ¡ Lx .
² Generate nonparametric bootstraprepli-
cate data sets i and for each one maxi-
mize likelihoods over parameters h x for
each permitted topologyTx , giving opti-
mal log-likelihood values L (i )x .
² For each topology Tx , form the adjusted
log-likelihood L˜ (i )x ´ L (i )x ¡ øL (i )x by sub-
tracting øL (i )x , the mean over replicates i
of L (i )x , from each value of L
(i )
x —this is
the centering method devised by Shi-
modaira (1998), which is appropriate for
enforcing that the resampled data con-
form to H0 for this a posteriori test.
² For each replicate i, nd L˜ (i )ML, the maxi-
mum over topologies Tx of the adjusted
log-likelihoods L˜ (i )x , and form bootstrap
replicate statistics d (i)x ´ L˜ (i )ML ¡ L˜ (i )x ; this
allows for the a posteriori selection of
TML.
² For each topology Tx , test whether the
attained d x is a plausible sample from
the distribution (over replicates i) of the
d
(i )
x by seeing if it falls within the con-
dence interval for E[ d x ] given, for exam-
ple, by the interval between 0 and the
95% point of the ranked list of the d (i )x .
Such a one-sided test is appropriate, be-
cause we know that only L˜ (i )ML ¸ L˜
(i )
x is
possible; in this example, a 5% signi-
cance level is being used.
(We have used some notation different from
that of Shimodaira and Hasegawa [1999], to
maintain a consistent style within this pa-
per. Shimodaira and Hasegawa [1999] use
Ta , a = 1, 2, . . . , M; L˜ a ¢ i ; R˜a ¢ i ; and S˜a ¢ i , where
we have used d xTx 2 M; L (i )x ; L˜ (i )x ; and d (i )x ,
respectively.)
Time-saving approximations are also
possible with this test. Shimodaira and
Hasegawa (1999) propose the use of the
RELL method for nding approximate
values of L (i )x without having to re-optimize
h x for each replicate data set. This test,
implemented by Shimodaira and Hasegawa
(1999) and Buckley et al. (unpubl.), can be
described as follows:
Test posNPncd:
² Calculate a test statistic d x for each topol-
ogy Tx 2 M: d x is the attained value of
LML ¡ Lx .
² Generate nonparametric bootstraprepli-
cate data sets i; for each one, and for
each tree Tx, use the ML estimates ˆh x of
any free parameters derived for each tree
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 661
Tx from the original data set to compute
log-likelihoods L 0 (i )x , which approximate
the optimized values L (i )x in test posNPfcd
above.
² For each topology Tx, form the adjusted
log-likelihood L˜ 0 (i )x ´ L 0 (i )x ¡ øL 0 (i)x (center-
ing).
² For each replicate i, nd L˜ 0 (i )ML, the maxi-
mum over topologies Tx of the adjusted
log-likelihoods L˜ 0 (i )x , and form bootstrap
replicate statistics d 0 (i )x ´ L˜ 0 (i )ML ¡ L˜ 0 (i )x .² For each topology Tx, test whether the
attained d x is a plausible sample from the
distribution (over replicates i) of the d 0 (i)x
by seeing if it falls within the condence
interval for E[ d x] given, for example, by
0 and the 95% point of the ranked list of
the d 0 (i )x (one-sided test; 5% signicance
level used in this example).
Note that the SH-test simultaneously as-
sesses the signicance level for each of the
topologies Tx 2 M. It immediately reduces
to a version of the KH-test, modied for
the comparisonof a priori–selected topology
T1 and a posteriori–selected topology TML,
when attention is restricted to the signi-
cance level computed for d 1 from the distri-
bution of the d (i )1 or d
0 (i )
1 . Note, however, that
the setM of all plausible topologies still has
tobe considered to compute thisdistribution.
The effect of the new centering procedure
introduced in this method is to decrease the
signicance accorded to the difference d x in
log-likelihoods between each topology Tx
and the ML topology TML (Shimodaira and
Hasegawa, 1999), in comparison with the
signicance indicated by the corresponding
but inappropriate KH-test. Intuitively, this
is because the attained value of d x should
be attributed to two components: one (nec-
essarily positive) being a consequence of
the selection of TML precisely because it has
the highest likelihood, and another (of un-
known sign) attributable to the difference
in the abilities of Tx and TML to explain
the observed data. Whereas the SH-test cor-
rectly compares Tx and TML on the basis of
the second component alone, making an ap-
propriate allowance for the rst component,
the incorrectly applied KH-test assesses both
components combined as though they were
only the second component. The fact that
the rst component is necessarily > 0 acts
to make the new test more conservative (i.e.,
less likely to reject thenull hypothesis).How-
ever, the SH-test correctly uses a one-sided
test, and this acts to increase the signicance
of results.
Is It Possible to Salvage the Results
of Incorrect Applications of the KH-Test?
We can nd only one possible adjustment
thatmight render somepreviouslypublished
results from incorrect applicationsof theKH-
test useful in the light of the theoretical ad-
vances described in this paper. It is straight-
forward to convert the signicance level of
a two-sided test to that of a one-sided test:
the P-value should simply be halved. If the
P-value obtained from an incorrectly applied
KH-test is p, then the P-value that would be
obtained in the SH-test is necessarily ¸ p/2.
Therefore, if the adjusted value p/2 is large
enough to indicate no rejection of the null
hypothesis (a priori tree T1), e.g., p/2 > 0.05
for a 5% signicance level, we can be certain
that using the SH-test would give the same
conclusion.
However, in all other cases (where the ad-
justed value p/2 is sufciently small to indi-
cate rejection of the null hypothesis in favor
of theML tree, e.g., p/2 < 0.05 for a 5% signif-
icance level) we cannot assume that this re-
sult would hold under a SH-test, whichmust
give a P-value that would exceed p/2 by an
unknown amount. Note that this will neces-
sarily be the casewhenever p indicated rejec-
tion of the null hypothesis in the incorrectly
applied KH-test (e.g., p < 0.05 implies p/2 <
0.025), and in some instances when p did not
indicate rejection of the null hypothesis (e.g.,
0.05 < p < 0.1 implies 0.025 < p/2 < 0.05).
In summary, if the P-value obtained from
an incorrectly applied KH-test is greater than
twice the value required to indicate no rejec-
tion of the null hypothesis, then that conclu-
sion would hold under the SH-test. If the P-
value is less than this, we cannot determine
from theKH-test resultwhat the resultwould
be for any testmakingproper allowance for a
posteriori selection of hypotheses, and a full
reanalysis of the original data by appropriate
tests is necessary.
The SOWH-Test: a Correct Parametric
Test of Topologies
Parametric statistical testing of hypothe-
ses is becoming increasingly popular in
662 SYSTEMATIC BIOLOGY VOL. 49
phylogenetics, based on the same models
of sequence evolution being used for mak-
ing phylogenetic inferences. These tests are
generally based onparametricbootstrapping
techniques (also known as Monte Carlo sim-
ulation), the theory of which is described
in more detail by Goldman (1993), Huelsen-
beck and Crandall (1997), and Huelsenbeck
and Rannala (1997). Whereas in nonpara-
metric bootstrapmethods, replicate data sets
are created by resampling with replacement
from the originaldata set, inparametricboot-
strapping, replicate data sets that conform
precisely to the assumptions of a paramet-
ric null hypothesis are created by simulat-
ing data through the use of those assump-
tions in conjunction with parameter values
estimated under the null hypothesis from
the original data set (Goldman, 1993). Sub-
sequent analysis of these data sets by the
same methods as used for the original data
gives replicate values of any required statis-
tic. These are guaranteed to be drawn from
thedistribution induced by the null hypothe-
sis, and their distribution therefore is a para-
metric estimate of the null hypothesis distri-
bution of that statistic.
Parametric tests offer the possibility of
more power than nonparametric tests, be-
cause the knowledge they canuse of the form
of the distribution giving rise to the data is
unavailable to nonparametric tests. The cost
of this power is an increased reliance on the
models they assume (which could be inaccu-
rate and thus lead to misinterpretation of the
data). Typically, LRTs in phylogenetics (in-
cluding those performed by using the para-
metricbootstrap)havebeen found tobepow-
erful and are quite robust to deviations from
the assumed model so long as a reasonable
effort is made to use a model sufciently
complex to encompass the major features of
the distribution of the data (e.g., Goldman,
1993;Yang et al., 1994, 1995;Hillis et al., 1996;
Huelsenbeck and Crandall, 1997; Huelsen-
beck and Rannala, 1997; Cunningham et al.,
1998; Zhang, 1999).
It is possible to create a parametric boot-
strap LRT to assess whether an a priori se-
lected topology T1 is supported by a se-
quence data set or should be rejected in favor
of another topology. The following test is a
straightforward application of the paramet-
ric bootstrap,yet it appears tobe little-known
or -used. The only previous (and brief) de-
scriptionwe know of is due to Swofford et al.
(1996), and the only published application is
by Hillis et al. (1996). We refer to it as the
SOWH-test, after the authors who originally
described it. The hypotheses compared are
these:
H0: T1 is the true topology
HA: some other topology is true
and the parametric bootstrap statistical test
of these hypothesis is as follows:
Test posPfud:
² Calculate the test statistic d ´ LML ¡ L1.
² Simulate data sets i by parametric boot-
strapping, based on the null hypothesis
topologyT1 and theML estimates of any
free parameters, ˆh 1, derived for T1 from
the original data set.
² Use T1 and reestimate free parameters
h 1 to get maximized log-likelihoods L
(i )
1
under H0.
² Maximize likelihood over all topologies
Tx and their respective parameters h x to
get log-likelihoods L (i )ML.
² Calculate values of d (i ) ´ L (i )ML ¡ L (i )1 , the
set of these giving an estimate of the dis-
tribution (under H0) of d .
² Testwhether the attainedvalueof d (from
the original data) is a plausible sam-
ple from the estimated distribution of d
given by the set of the d (i ) by seeing if
it falls below the 95% point (for exam-
ple) of the ranked list of the d (i ). Such a
one-sided test is appropriate because we
know that d must be >0; in this example,
a 5% signicance level is being used.
Notice that the test statistic d is the same as
in theKH- and SH-tests. The use ofTML in the
test means that the assumption E[ d ] = 0 can-
not be made, but the use of parametric boot-
strapping to generate data conforming to the
null hypothesis means that this presents no
problem: the repeated analysis of parametric
bootstrap data sets guarantees the appropri-
ate statistical properties. (Indeed, E[ d ] may
be estimated by ød (i ), themean of the d (i ).) The
fact that the data necessarily conform to the
null hypothesis is also the reason that no cen-
tering procedure is necessary for this test (Ta-
ble 1, level 4, option u).
This test has a substantial time penalty,
however, caused by the need to repeatedly
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 663
maximize likelihoods over topologies under
the hypothesis HA. The same penalty ex-
ists in the basic SH-test (posNPfcd) above but
is avoided by using the RELL method (test
posNPncd above). Although we do not have
theoretical results to justify applying all the
mostuseful approximationsdescribed above
for nonparametric tests, we have a several
suggestions for possible ways to reduce the
computational burden of the aboveparamet-
ric test.
The rst suggestion is to use RELL-like
methods applied only to the a priori–spe-
cied null hypothesis topology T1 (Table 1,
level 3, option p):
Test posPpud (approximation under H0):
² Calculate the test statistic d ´ LML ¡ L1.
² Simulate data sets i by parametric boot-
strapping, based on the null hypothesis
topologyT1 and theML estimates of any
free parameters, ˆh 1, derived for T1 from
the original data set.
² Use T1 and the ML estimates of param-
eters ˆh 1 to get log-likelihoods L
0 (i )
1 under
H0.
² Maximize likelihood over all topologies
and their respective h x to get maximized
log-likelihoods L (i )ML under HA.
² Calculate values of d 0 (i ) ´ L (i )ML ¡ L 0 (i)1 .² Test whether the attained value of d
(from the original data) is a plausible
sample from the estimated distribution
of d given by the set of the d 0 ( i ) by see-
ing if it falls below the 95% point of
the ranked list of the d 0 (i ) (one-sided
test; 5% signicance level used in this
example).
This saves on the maximization of param-
eters under the xed topology T1 and results
in a small saving in computation time. It does
not address the more difcult problem of re-
peated maximizations over topologies in the
alternative hypothesis. As with other tests
described above, the approximation under
H0 can be trusted and the signicance lev-
els taken at face value. Alternatively, note
that necessarily L 0 (i )1 · L
(i )
1 and so d
0 (i ) ¸ d (i ).
Therefore, if this test rejects H0 (the attained
d is too big), then this result is certain (the
approximation cannot have changed the re-
sult). But if the test does not reject H0 (the
attained d is sufciently small), we do not
knowwhether it would have been rejected if
the exact d (i ) had been used in place of the
d 0 (i ), and the test does not give us a denitive
result.
A similar approach applied to the alter-
native hypothesis will be less effective (e.g.,
for a test denoted posPnud). Although it pro-
vides a much greater scope for saving time
under HA, because searches are performed
over topologies, using xed values of TML
and ˆh ML from the ML analysis (over all trees)
of the original data to assess the replicate
data set is not sensible. The original TML
and corresponding ˆh ML will probably be far
from the optimal values for replicate data
sets (which were simulated using the origi-
nal T1 and ˆh 1), so the difference between L
(i )
ML
and its possible approximation L 0 (i )ML may be
large.
However, ML estimates of some param-
eters of nucleotide substitution models are
known to be quite stable over different
topologies (e.g., Yang et al., 1994, 1998; Sulli-
van et al., 1996;Yang, 1997).Examples of such
parameters are base frequencies ( p A, p C, p G,
p T), the transition/transversion rate ratio j ,
and the shape parameter a of the gamma dis-
tribution widely used to model among-sites
rate variation. Therefore, we think it reason-
able to use xed values of these parameters
estimatedunderH0 fromeach bootstrapdata
set i (i.e., the components of ˆh (i )1 that are not
the lengths of branches of T1 and are thus
common to all topologies Tx) when assess-
ing that data set under HA. This gives the
following test:
Test posPpud (approximation under HA):
² Calculate the test statistic d ´ LML ¡ L1.
² Simulate data sets i by parametric boot-
strapping, based on the null hypothesis
topology T1 and theML estimates of any
free parameters, ˆh 1, derived for T1 from
the original data set.
² Use T1 and reestimate free parameters
h 1 to get maximized log-likelihoods L
(i )
1
under H0 (and respective optimal values
of ˆh (i)1 ).² Maximize likelihood over all topologies
Tx to get log-likelihoods L
0 (i)
ML under HA:
these maximizations all x the values
of substitution process parameters to be
equal to ˆh (i )1 , but themaximization is per-
formed over topologies Tx and their re-
spective branch length parameters.
664 SYSTEMATIC BIOLOGY VOL. 49
² Calculate values of d 0 (i ) ´ L 0 (i )ML ¡ L (i )1 .² Test whether the attained value of d
(from the original data) is a plausible
sample from the estimated distribution
of d given by the set of the d 0 (i ) by see-
ing if it falls below the 95% point of the
ranked list of the d 0 (i ) (one-sided test; 5%
signicance level used in this example).
(Note that the two preceding tests both re-
ceive the mnemonic posPpud because they
vary only in the form of the approxima-
tion used in their likelihood maximizations
[Table 1, level 3]. A more complex naming
system thatwould assign different mnemon-
ics to these tests seems unwarranted in this
paper.) Now, some substantial saving of time
is made as the substitution process parame-
ter values are xed during the likelihood op-
timizations under HA. The greater problem
of optimizing over topologies is still not ad-
dressed. For this test,we know that necessar-
ily that L 0 (i )ML · L
(i )
ML and so d
0 (i ) · d (i ). There-
fore, if this test fails to rejectH0 (attained d not
excessively large relative to the null hypoth-
esis distribution of the d 0 (i )), then this result is
certain. If this test does reject H0, this could
in principle be a consequence solely of the
approximation. However, we expect the ef-
fect of this approximation to be small; in the
example given below, it is insignicant and
has no bearing on the conclusions reached.
If approximationsaremadeunder bothhy-
potheses, for example, by some combination
of the two posPpud tests above (and as in
testspriNPncd,priNPncn, priNPnca, priNPncs,
and posNPncd above), it is no longer possi-
ble to make general statements about the di-
rection of the bias that they produce in the
d (i ). The precise effects of the combination
of such approximations in a posteriori para-
metric tests require further investigation.Ap-
proximationsbased on assumptions of a nor-
mal distribution for d (Table 1, level 5, options
n, a, and s) seem unlikely to be useful in tests
designed for hypotheses chosen a posteriori,
given that the necessary condition of d ¸ 0
indicates a truncation of the distribution of d ,
which precludes normality.
Other SOWH-Like Tests
It is also straightforward to devise a para-
metric bootstrap test of the following hy-
potheses, which are akin to those of the fun-
damental KH-test for a priori–specied trees
T1 and T2:
H0: T1 is the true topology
HA: T2 is the true topology
This fundamental version of such a test
would be denoted priPfud (see Table 1). De-
noting the topologywith secondhighest like-
lihood by TML2, we could also devise a para-
metric bootstrap test of the hypotheses:
H0: TML2 is the true topology
HA: TML is the true topology
This test would be based on modica-
tions of posPfud by using the test statis-
tic d ´ LML ¡ LML2, data simulated by us-
ing TML2 and ˆh ML2; ML analysis of simulated
data sets to nd the distinct topologies T (i )ML
and T (i )ML2which give the greatest and second-
greatest likelihoods, respectively; and d (i ) ´
L (i )ML ¡ L (i )ML2. Having introduced the general
principles of such tests, we will not go into
further details here. We also draw readers’
attention to the related parametric bootstrap
test ofmonophyly described byHuelsenbeck
et al. (1996), which compares partially con-
strained topologies (chosen a priori) with the
ML topology (chosen a posteriori).
EXAMPLES
HIV-1 Subtypes A, B, D, and E gag and pol
Nucleotide Sequences
Six homologous sequences, each consist-
ing of 2,000 base pairs (bp) from the gag
and pol genes, were selected from isolates of
HIV-1 subtypes A (two sequences, A1 and
A2), B (one sequence), D (one sequence), and
E (two sequences, E1 and E2). The sequences
were easily aligned by eye. The conventional
phylogeny for these subtypes would group
the two subtype A sequences and also the
two subtype E sequences—that is, T1 = ((A1,
A2), (B, D), (E1, E2))—for which the opti-
mal log-likelihood is L1 = ¡ 5,073.75.For our
sequences, however, the ML phylogeny in-
dicated that the subtype A sequences did
not cluster together; that is, TML = (A1, (B,
D), (A2, (E1, E2))) with LML = ¡ 5,069.85.
In this example, all ML calculations were
performed with the general time reversible
model of nucleotide substitution, using a
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 665
TABLE 3. Results of statistical tests of topologies for HIV-1 gag and pol gene nucleotide data set.
Test code Notes P-valuea
priNPfcd KH-test (incorrect application); full optimization; direct estimation 0.38 (0.19)
of P-value
priNPfcn KH-test (incorrect application); full optimization; normal approximation 0.41 (0.20)
for distribution of d
priNPncs KH-test (incorrect application); RELL approximation; stronger normal approximation 0.38 (0.19)
for distribution of d (k)
posNPfcd SH-test; full optimization; direct estimation of P-value 0.26
posPfud SOWH-test; full optimization; direct estimation of P-value 0.002
posPpud SOWH-test; partial optimization under HA; direct estimation of P-value 0.002
aFirst value is from a two-sided test, as widely used to date; second value, when present, is for the more appropriateone-sided
test.
gamma distribution to model rate hetero-
geneity among sites (REV+ C ; Yang, 1994,
1996, 1997); the parameters h x for topol-
ogy Tx are branch lengths, base frequencies,
parameters describing the relative rates of
substitution between each nucleotide pair,
and the shape parameter a of the gamma
distribution.
We illustrate some of the statistical tests
described above by investigating whether
or not the data provide signicant evidence
that TML is to be preferred over T1. For all
the tests we performed, the test statistic
d = LML ¡ L1 = ¡ 5,069.85 ¡ ( ¡ 5,073.75) =
3.90. Because TML has been selected for
testing a posteriori, that is, as a consequence
of having the highest likelihood, the KH-test
is inappropriate (but was performed for
comparative purposes), and the SH- or
SOWH-tests should be used. These tests
were performed as described above, with
1,000 replicates used whenever parametric
or nonparametric bootstraps were per-
formed. The results are summarized in
Table 3.
We performed three versions of the KH-
test, two using full likelihood optimizations
and computing the tests’ P-values either di-
rectly (test priNPfcd) or by assuming a nor-
mal distribution for d (test priNPfcn), and
one using the strongest assumption of nor-
mality of the sitewise d (k) (test priNPncs). In
all cases, both a two-sided test and a one-
sided test were performed. The two-sided
test is inappropriate for this a posteriori test
(as indeed is the entire KH-test) but repre-
sents the computationperformed in themost
widely available implementations of theKH-
test (PHYLIP, Felsenstein, 1995; PUZZLE,
Strimmer and von Haeseler, 1996; Strimmer
et al., 1997; and PAUP*, Swofford, 1998). The
one-sided test is more suitable and, as de-
scribed above, at least has the possibility of
giving a statistically interpretable result. In-
deed, that is the case in this example: the
one-sided P-values of » 0.2 indicate no rejec-
tion of the null hypothesis, and as explained
above, this conclusion must necessarily be
maintained by the correction inherent in the
SH-test.We also note the good agreement be-
tween the P-values calculated by the three
variants of the KH-test.
Our application of the SH-test used full
likelihood optimizations (test posNPfcd) and
permitted the consideration of three topolo-
gies as possibly true: T1, TML, and the topol-
ogy (A2, (B, D), (A1, (E1, E2))). We report
only the signicance level for the test of T1
against TML. This test, with its allowance for
the a posteriori selection of one topology,
must give a higher P-value (i.e., a less signif-
icant result), and this is conrmed in Table 3.
There seemsnowaytodrawanygeneral con-
clusions about the size of the difference in
the P-values (0.26 vs. 0.19–0.20 for the KH-
tests). Figure 1 shows the distribution of the
1,000 replicate values d (i )1 against which the
attainedvalue d 1 = 3.90 is compared.We con-
clude that the SH-test indicates no signicant
difference between T1 and TML; therefore, we
do not reject T1 in favor of TML for these data.
We also note fromFigure 1 that theminimum
value of d 1 that would indicate rejection of
the null hypothesis (T1) in this example is
» 8.8 (the value of d for which the SH-test
distribution reaches a cumulative frequency
of 0.95).
The results of the SOWH-test are very dif-
ferent. We performed two versions of this
test, one using full likelihood optimizations
666 SYSTEMATIC BIOLOGY VOL. 49
FIGURE 1. Test distributions for SH-test (nonparametric bootstrap) and SOWH-tests (parametric bootstrap) of
topologies for HIV-1 gag and pol gene nucleotide data set. The histogram (right-hand y-axis; note the break used
on this scale) shows the distribution over 1,000 replicates i of the d (i )1 (SH-test, code posNPfcd; wide dark-gray bars),
d (i ) (SOWH-test, code posPfud; narrow white bars), and d 0 (i ) (SOWH-test, code posPpud; light-gray bars). The curves
(left-hand y-axis) show the cumulative frequency distributions of the d (i)1 (SH-test; solid line) and d
(i ) (SOWH-test
posPfud; dashed line). The cumulative frequency distribution of the d 0 (i ) (SOWH-test posPpud) is indistinguishable
from that of the d (i ). The points at which the horizontal line (dashed gray) at a cumulative frequency of 0.95 crosses
these curves indicate the values of d thatmust be exceeded for a signicant result at the 5% level. Given the attained
value of d = 3.90, the SH-test is not signicant and does not reject T1, but the SOWH-tests are highly signicant and
reject T1 in favor of TML (see text for further details).
(test posPfud) and one using the approxima-
tion described above as test posPpud (ap-
proximation under HA). The differences be-
tween these two tests were negligible in this
example, and both indicated a P-value of
0.002 (Fig. 1; Table 3). For these data, this
test strongly rejects topology T1 in favor
of TML. As Figure 1 shows, any observed
value of d exceeding » 1.2 would have re-
sulted in rejection of T1 at the 95% level.
The attained value is 7.7 standard deviations
above the mean of the SOWH-test statistic
distribution.
One explanation of the difference between
the signicance levels for the SH-test and
the SOWH-test is the different forms of their
null hypotheses. In this example the SH-
test considers whether the three competing
topologies are equally good explanations of
the data, whereas the SOWH-test considers
whether other topologies are better than the
single topology T1. As a consequence, the
SH-test is permitting more a priori possible
topologies in its null hypothesis, which will
generally lead tomore conservative results—
an effect of the allowances made for the
multiple statistical comparisons being made
between the ML and all other permitted
hypotheses.
Another factor affecting the signicance
levels of the different tests may simply be the
increase in power expected for a parametric
test over a nonparametric test. We also recall
the reliance of parametric tests on themodels
that they assume.Althoughwemay hope for
robustness of tests to inaccuracy of models,
this has generally been left untested in phy-
logenetics. To examine whether the REV+ C
model ts the data well in the present ex-
ample, we performed ML analyses under a
variety of nucleotide substitution models to
compare thosemodels (Goldman, 1993;Yang
et al., 1994). The results of these analyses are
shown in Table 4. It is immediately evident
that the REV+ C model ts these data signif-
icantly better than any of the other models
considered, in agreement with the good per-
formance of both the REVand C components
reported over a variety of data sets (see Yang,
1994, 1996; Arvestad and Bruno, 1997; and
references therein). We conclude that in this
example all reasonable steps have been taken
to exclude any effects on the SOWH-test at-
tributable to model inaccuracy.
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 667
TABLE 4. Maximum likelihood scores for HIV-1 gag
andpolgenedata set under variousmodels of nucleotide
substitution. Models JC69 (Jukes and Cantor, 1969),
K80 (Kimura, 1980), F81 (Felsenstein, 1981), HKY85
(Hasegawa et al., 1985), and REV (Yang, 1994)were im-
plemented, eachwithout (no C ) andwith (+ C ) a gamma
distribution to model rate heterogeneity amongst sites
(Yang, 1996,1997).All calculations were performedwith
the topology referred to in the text as TML . Numbers
given represent the log-likelihood value by which each
model is worse than the best value, attained under the
REV+C model, ¡ 5,069.85. Also shown, in parentheses,
are the numbers of free parameters in each substitution
model. Pairs of nestedmodels can be compared byusing
a test statistic that is twice the log-likelihood difference
between those models, assessed with either a v 2 distri-
bution (models compared are both of the no ‘ C ’ form or
both of the +‘ C ’ form) or a øv 2 distribution (exactly one
of the models compared is of the +‘C ’ form), degrees of
freedom are given by the difference in the numbers of
free parameters. For full details of these tests see, for
example, Yang et al. (1994) and Goldman and Whelan
(2000).
Substitution model No C + C
JC69 395.08 (0) 349.93 (1)
K80 190.28 (1) 131.32 (2)
F81 280.19 (3) 231.43 (4)
HKY85 81.29 (4) 12.79 (5)
REV 65.09 (8) 0 (9)
Mammalian Mitochondrial Protein Amino
Acid Sequences
Shimodaira and Hasegawa (1999) illus-
trated the SH-test with a data set consisting
of aligned mt protein sequences, each
comprising 3,414 aa, from six mammals:
human, harbor seal, cow, rabbit, mouse,
and opossum. The grouping (harbor seal,
cow) was assumed to be true, which left
15 candidate topologies to be evaluated.
Shimodaira and Hasegawa (1999) applied
the SH-test to this data set, comparing all
15 candidate topologies simultaneously,
and concluded that seven topologies could
not be rejected. To illustrate the SOWH-
test, we selected (a priori) the topology T1
= ((human, ((harbor seal, cow), rabbit)),
mouse, opossum), called topology a = 2 by
Shimodaira and Hasegawa (1999), To test
against the ML topology, which for these
TABLE 5. Results of statistical tests of topologies for mammalian mitochondrial protein amino acid data set.
Test code Notes P-value
priNPncd KH-test (incorrect application); RELL approximation; direct estimation of P-value 0.36a
posNPncd SH-test; RELL approximation; direct estimation of P-value 0.81a
posPfud SOWH-test; full optimization; direct estimation of P-value < 0.001
aFrom Shimodaira and Hasegawa (1999).
data is TML = (((human, (harbor seal, cow)),
rabbit), mouse, opossum)—topology a = 1
of Shimodaira and Hasegawa (1999). We
compare our results from the SOWH-test
with Shimodaira and Hasegawa’s (1999)
results for analogous comparisons from
KH- and SH-tests. In this example, as in
Shimodaira and Hasegawa (1999), all ML
calculations were performed using a model
of mammalian mt aa replacement described
by Yang et al. (1998), with aa frequencies
estimated from the data set being ana-
lyzed and using a gamma distribution to
model rate heterogeneity amongst sites
(mtmam+F+C ; see also Yang, 1997). For
this model, the optimal log-likelihoods
for these topologies were L1 = ¡ 21,727.26
and LML = ¡ 21,724.60; therefore, the test
statistic for all the tests of topologies
considered below was d = LML ¡ L1 =
¡ 21,727.26 ¡ ( ¡ 21,724.60) = 2.66. Table 5
summarizes the results of the KH-, SH-, and
SOWH-tests for these data. The KH- and
SH- test results are taken from Shimodaira
and Hasegawa (1999) and were calculated
by using RELL approximations and esti-
mating the tests’ P-values directly (without
a normal approximation). The SOWH-test
was performed by using full likelihood
optimizations.
The P-value obtained from a one-sided
comparison in the KH-test, as given by
Shimodaira and Hasegawa (1999), was
0.36, which suggests that T1 cannot be
rejected in favor of TML. As explained
above, this conclusion must be maintained
by the SH-test and we see from Table 5
that this is so (P = 0.81). Notice that the
difference between the P-values for the
(one-sided) KH- and SH-tests (0.36 and
0.81, respectively) is considerably greater
than in the HIV-1 example ( » 0.20 and 0.26,
respectively).
The SOWH-test again gives very different
results. The P-value from this test, for 1,000
replicate parametric bootstrap data sets, is
estimated to be <0.001—in other words, in
none of the 1,000 replicates i did the value
668 SYSTEMATIC BIOLOGY VOL. 49
of d (i ) equal or exceed the value d = 2.66
observed for the real data. (The attained
value d = 2.66 lies 27.8 standard deviations
above the mean of the d (i ).) Thus, topology
T1 is very strongly rejected in favor of TML.
As with the HIV-1 example above, there
is no obvious single reason for the contrast-
ing results of the SH- and SOWH-tests for
these mt protein sequences. The SOWH-test
considers only one a priori topology, T1,
and of the 1,000 replicate data sets gener-
ated by using T1 only 7 resulted in topolo-
gies different from T1 when analyzed byML.
Evidently, if this topology, its correspond-
ing parameter values ˆh 1 (as estimated by
ML from the original mt protein data set),
and the mtmam+F+C model of aa replace-
ment were all adequate, then we would ex-
pect to retrieve the correct topology from a
data set of 3,414 aa with high probability
(1,000 ¡ 7)/1,000 ¼ 0.99; consequently, our
nding that for the original data TML and
not T1 is optimal seems unreconcilable with
the hypothesis that T1 is true. In contrast, the
SH-test has 15 topologies considered equally
plausible a priori in its null hypothesis and
therefore the signicance level assigned to a
particular one of these, e.g., T1, is reduced.
The effects of differences between parametric
and nonparametric tests and the possibility
that the mtmam+F+C model is inadequate
have not been assessed.
DISCUSSION
We want to emphasize once more that the
problemsdescribed abovewith typical appli-
cations of the KH-test are very real and will
have practical consequences in many appli-
cations. We contend that all future applica-
tions must use new methods such as the SH-
test and the SOWH-test (above). Assessment
of the results of published analyses based on
incorrect applications of the KH-test must be
made with extreme caution. The sole correc-
tion to these results that we have been able
to derive (see above) will often generate in-
conclusive results, demanding reanalysis of
data.
Evidently, it is vital that researchers think
carefully about what phylogenetic hypothe-
ses they wish to test.A priori hypotheses and
aposteriorihypotheses canbe quite different,
as can the statistical distributions required to
test them. It serves no scientic purpose to
“cheat” and represent an aposteriori hypoth-
esis as an a priori one simply for the expedi-
ency of amore readily available or faster test.
The SOWH-test, as described above, tests a
single a priori hypothesis of topology. If such
tests are used repeatedly, to assess the sig-
nicance of multiple trees, the issue of cor-
recting signicance values for multiple tests
arises. This might occur with data sets for
which large numbers of tree topologies are
considered plausible a priori. Bar-Hen and
Kishino (in press) describe a novel paramet-
ric likelihood-based test for computing si-
multaneous signicance values for multiple
topologies.
The SH-test simultaneously compares all
members of a setM of topologies. The inclu-
sion inM of all a priori possible topologies
is important. Even topologies with low boot-
strap replicate likelihoods (L (i )x ) can readily
affect the signicance levels of other topolo-
gies, because these are based only on varia-
tions in likelihoods over bootstrap replicates
(L˜ (i )x ´ L (i )x ¡ øL (i )x ). A posteriori selection of
topologies for inclusion in or exclusion from
M based on their likelihoods may thus bias
all signicance levels recorded—analogous
to performing multiple comparisons tests on
only a subset of a larger number of compar-
isons, selected (for example) to be the most
(or least) signicant. Decreasing the number
of comparisons performed this way will un-
justiably increase the apparent signicance
levels of the results. In the HIV-1 example
above, if the SH-test (posNPfcd) is applied
by considering that all 105 topologies for
six sequences are possibly true, the P-value
for T1 is increased from 0.26 to 0.90. Con-
sidering all 105 possible topologies in the
SH-test applied in the mt protein sequence
example above increases the P-value for T1
from 0.81 to 0.93 (RELL approximation, pos-
NPncd); for the topologies called a = 9–15 by
Shimodaira and Hasegawa (1999), P-values
are increased from signicant values (<0.05)
to nonsigncant values (>0.05). Clearly, the
honest choice of a priori hypothesis topolo-
gies may be crucial to the conclusions ulti-
mately drawn.
The claim is sometimesmade—when phy-
logenies of different genes are compared, for
instance—that no a priori topologies can be
constructed. In such cases, however, one can
usually recast the hypothesis and its statisti-
cal test differently. To use the example above,
when comparing the evolutionary histories
of different genes, we may restate this as
a test of whether the two (or more) trees
2000 GOLDMAN ET AL.—TESTS OF TOPOLOGIES IN PHYLOGENETICS 669
are sample estimates of the same phylogeny
(Rodrigo et al., 1993).
As illustrated in this paper, the results of
parametric tests (e.g., the SOWH-test) and
nonparametric tests (e.g., the SH-test) can ap-
pear to be very different. The SH-test may
often appear to be more conservative than
the SOWH-test. As we have explained, this
may be due to some or all of the following
phenomena: different forms of null hypothe-
ses; increased power of parametric tests; and
greater reliance of parametric tests on mod-
els of sequence evolution. The relative con-
sequences of these and other effects require
further investigation in the future.
PROGRAM AND DATA AVAILABILITY
Notes on the use of PAUP* (Swofford,
1998) to perform SOWH-tests, and details of
theHIV-1 nucleotide sequences (6 sequences,
each 2,000 bp) and mammalian mt protein
aa sequences (6 sequences, each 3,414 aa)
used in the examples above, can be obtained
from the authors at http://www.zoo.cam.
ac.uk/zoostaff/goldman/tests and ‘down-
stream’ Web pages. A computer program,
shtests, to perform SH-tests by using the
RELL approximation (posNPncd above)
can be obtained from Andrew Rambaut
at http://evolve.zoo.ox.ac.uk/software/
shtests. Versions of PHYLIP and PAUP*
package programs (Felsenstein, 1995;
Swofford, 1998) implementing the SH-
test are currently under development
(J. Felsenstein, pers. comm.; D. Swofford,
pers. comm.).
ACKNOWLEDGMENTS
Work by N.G. and A.G.R. on this topic was partially
supported by the Isaac Newton Institute for the Mathe-
matical Sciences programmeon“Biomolecular Function
and Evolution in the Context of the Genome Project”
(July–December 1998). N. G. is supported by a Well-
come Trust Fellowship in Biodiversity Research. J.P.A.
is supported by a NIH Institutional NRSA Interdisci-
plinary Training in Genomic Sciences Fellowship and
by the University of Washington Center for AIDS Re-
search (CFAR). We are very grateful for the assistance
given to us by Hidetoshi Shimodaira, Joe Felsenstein,
David Swofford, Hirohisa Kishino, and Andrew Ram-
baut throughout the preparation of this paper; for pre-
publication versions of papers provided by Hidetoshi
Shimodaira,ThomasBuckley, andHirohisaKishino; and
for critical readings of draft versions of the paper by Ed-
wardHolmes, AnnOakenfull, TimMassingham,Martin
Embley, and Andrew Rambaut. Andrew Rambaut and
Korbinian Strimmer provided all of the 105-topology
SH-test P-value calculations given in the Discussion.
REFERENCES
ADACHI, J., AND M. HASEGAWA. 1996. MOLPHY: Pro-
grams for molecular phylogenetics based on maxi-
mumlikelihood, vers. 2.3. Institute of StatisticalMath-
ematics, Tokyo.
ARVESTAD, L., AND W. J. BRUNO. 1997. Estimation of
reversible substitution matrices from multiple pairs
of sequences. J. Mol. Evol. 45:696–703.
BAR-HEN, A., AND H. KISHINO . In press. Comparing the
likelihood functions of phylogenetic trees. Ann. Inst.
Stat. Math.
CUNNINGHAM , C. W., H. ZHU, AND D. M. HILLIS . 1998.
Best-tmaximum-likelihoodmodels forphylogenetic
inference: empirical tests with known phylogenies.
Evolution 52:978–987.
EFRON, B. 1982. The jackknife, the bootstrap and other
resampling plans. CBMS-NSF regional conference se-
ries in applied mathematics, volume 38. Society for
Industrial and Applied Mathematics, Philadelphia.
EFRON, B.,AND R. TIBSHIRANI . 1986.Bootstrapmethods
for standard errors, condence intervals, and other
measures of statistical accuracy. Stat. Sci. 1:54–77.
EFRON, B., E. HALLORAN, AND S. HOLMES . 1996. Boot-
strap condence levels for phylogenetic trees. Proc.
Natl. Acad. Sci. USA 93:13429–13434.
FELSENSTEIN, J. 1981. Evolutionary trees from DNA se-
quences: A maximum likelihood approach. J. Mol.
Evol. 17:368–376.
FELSENSTEIN, J. 1985.Condence limits on phylogenies:
an approach using the bootstrap. Evolution 39:783–
791.
FELSENSTEIN, J. 1995. PHYLIP (Phylogenetic inference
package), version 3.57. Univ. of Washington, Seattle.
GOLDMAN, N. 1993. Statistical tests of models of DNA
substitution. J. Mol. Evol. 36:182–198.
GOLDMAN, N., AND S. WHELAN. 2000. Statistical tests
of gamma-distributed rate heterogeneity in models of
sequence evolution in phylogenetics. Mol. Biol. Evol.
17:975–978.
HALL, P., AND S. R. WILSON. 1991. Two guidelines for
bootstrap hypothesis testing. Biometrics 47:757–762.
HASEGAWA,M., ANDH.KISHINO . 1989.Condence lim-
its on the maximum-likelihood estimate of the homi-
noid tree from mitochondrial-DNA sequences. Evo-
lution 43:672–677.
HASEGAWA, M., AND H. KISHINO . 1994. Accuracies of
the simplemethods for estimating the bootstrapprob-
ability of a maximum-likelihood tree. Mol. Biol. Evol.
11:142–145.
HASEGAWA,M., H.KISHINO , AND T. YANO. 1985.Dating
of the human–ape splitting by a molecular clock of
mitochondrial DNA. J. Mol. Evol. 22:160–174.
HASEGAWA, M., H. KISHINO , AND T. YANO. 1988. Phy-
logenetic inference from DNA sequence data. Pages
1–13 in Statistical theory and data analysis II (K. Mu-
tusita, ed.). Elsevier, Amsterdam.
HILLIS , D. M., B. K. MABLE, AND C. MORITZ. 1996. Ap-
plications of molecular systematics: the state of the
eld and a look to the future. Pages 515–543 inMolec-
ular systematics (D. M. Hillis, C. Moritz, and B. K.
Mable, eds.). Sinauer, Sunderland, Massachusetts.
HOPE, A. C. A. 1968. A simplied Monte Carlo signi-
cance test procedure. J. R. Statist. Soc. B 30:582–598.
HUELSENBECK, J. P., AND K. A. CRANDALL. 1997. Phy-
logeny estimation and hypothesis testing using max-
imum likelihood. Annu. Rev. Ecol. Syst. 28:437–466.
HUELSENBECK, J. P., AND B. RANNALA. 1997. Phyloge-
netic methods come of age: Testing hypotheses in an
evolutionary context. Science 276:227–232.
670 SYSTEMATIC BIOLOGY VOL. 49
HUELSENBECK , J. P., D. M. HILLIS , AND R. NIELSEN.
1996. A likelihood-ratio test of monophyly. Syst. Biol.
45:546–558.
JUKES , T. H.,AND C. R. CANTOR. 1969.Evolution of pro-
tein molecules. Pages 21–132 in Mammalian protein
metabolism (H.N.Munro, ed.). Academic Press, New
York.
KIMURA, M. 1980. A simple method for estimating evo-
lutionary rates of base substitutions through compar-
ative studies of nucleotide sequences. J. Mol. Evol.
16:111–120.
KISHINO , H., AND M. HASEGAWA. 1989. Evaluation of
the maximum likelihood estimate of the evolution-
ary tree topologies from DNA sequence data, and the
branching order in Hominoidea. J. Mol. Evol. 29:170–
179.
KISHINO , H., T. MIYATA, AND M. HASEGAWA. 1990.
Maximum likelihood inference of protein phylogeny
and the origin of chloroplasts. J.Mol. Evol. 31:151–160.
MARRIOTT, F. H. C. 1979. Barnard’s Monte Carlo tests:
how many simulations? Appl. Statist. 28:75–77.
RODRIGO, A. G., M. KELLY-BORGES, P. R. BERGQUIST,
AND P. L. BERGQUIST. 1993. A randomization test of
the null hypothesis that two cladograms are sample
estimates of a parametric phylogenetic tree. N.Z. J.
Bot. 31:257–268.
SHIMODAIRA, H. 1993. A model search technique based
on condence set andmap of models. Proc. Inst. Stat.
Math. 41:131–147 (in Japanese).
SHIMODAIRA, H. 1998. An application of multiple com-
parison techniques to model selection. Ann. Inst. Stat.
Math. 50:1–13.
SHIMODAIRA, H., AND M. HASEGAWA. 1999. Multiple
comparisons of log-likelihoods with applications to
phylogenetic inference. Mol. Biol. Evol. 16:1114–1116.
STRIMMER, K., AND A. VON HAESELER. 1996. Quartet
puzzling: a quartet maximum-likelihood method for
reconstructing tree topologies. Mol. Biol. Evol. 13:964–
969.
STRIMMER, K., N. GOLDMAN, AND A. VON HAESELER.
1997. Bayesian probabilities and quartet puzzling.
Mol. Biol. Evol. 14:210–211.
SULLIVAN, J., K. E. HOLSINGER, AND C. S IMON. 1996.
The effect of topology on estimates of among-site rate
variation. J. Mol. Evol. 42:308–312.
SWOFFORD, D. L. 1998. PAUP* 4.00: *Phylogenetic anal-
ysis using parsimony (and other methods). Sinauer,
Sunderland, Massachusetts.
SWOFFORD, D. L., G. J. OLSEN, P. J.WADDELL,AND D.M.
HILLIS . 1996.Phylogenetic inference. Pages 407–514 in
Molecular systematics (D. M. Hillis, C. Moritz, and B.
K. Mable, eds.). Sinauer, Sunderland, Massachusetts.
TEMPLETON, A. R. 1983. Phylogenetic inference from re-
striction endonuclease cleavage site maps with par-
ticular reference to the evolution of humans and the
apes. Evolution 37:221–244.
WESTFALL, P. H., AND S. S. YOUNG. 1993. Resampling-
based multiple testing: Examples and methods for
p-value adjustment. John Wiley & Sons, New York.
YANG, Z. 1994.Estimating the pattern of nucleotide sub-
stitution. J. Mol. Evol. 39:105–111.
YANG, Z. 1996. Among-site variation and its impact on
phylogenetic analysis. TREE 11:367–372.
YANG, Z. 1997. PAML: A program package for phy-
logenetic analysis by maximum likelihood. CABIOS
13:555–556.
YANG, Z., N. GOLDMAN, AND A. FRIDAY. 1994. Com-
parison of models for nucleotide substitution used in
maximum-likelihood phylogenetic estimation. Mol.
Biol. Evol. 11:316–324.
YANG, Z., N. GOLDMAN, AND A. FRIDAY. 1995. Maxi-
mum likelihood trees from DNA sequences: a pecu-
liar statistical estimation problem. Syst. Biol. 44:384–
399.
YANG, Z., R.NIELSEN,ANDM.HASEGAWA. 1998.Models
of amino acid substitution and applications to mito-
chondrial protein evolution. Mol. Biol. Evol. 15:1600–
1611.
ZHANG , J. 1999. Performance of likelihood ratio tests of
evolutionary hypotheses under inadequate substitu-
tion models. Mol. Biol. Evol. 16:868–875.
Received 9 November 1999; accepted 17 December 1999
Associate Editor: R. Olmstead
