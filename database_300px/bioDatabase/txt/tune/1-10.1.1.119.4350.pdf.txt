I. Mandoiu and A. Zelikovsky (Eds.): ISBRA 2007, LNBI 4463, pp. 329–337, 2007. 
© Springer-Verlag Berlin Heidelberg 2007 
Enhancing Motif Refinement by Incorporating 
Comparative Genomics Data 
Erliang Zeng and Giri Narasimhan 
Bioinformatics Research Group (BioRG), School of Computing and Information Sciences, 
Florida International University, Miami, Florida, 33199, USA 
{ezeng001,giri}@cis.fiu.edu 
Abstract. Transcription factor binding sites (TFBS) are often located in the 
upstream regions of genes and transcription factors (TFs) cause transcription 
regulation by binding at these locations. Predicting these binding sites is a 
difficult problem, and traditional methods have a high degree of false positives in 
their predictions. Comparative genomics data can help to improve motif 
predictions. In this paper, a new strategy is presented, which refines motif by 
taking the comparative genomics data into account. Tested with the help of both 
simulation data and biological data, we show that our method makes improved 
predictions. We also propose a new metric to score a motif profile. This score is 
biologically motivated and helps the algorithm in its predictions.  
1   Introduction 
Transcription, the process to produce messenger RNA (mRNA) from DNA, is a key step 
in the “Central Dogma” of life. Transcription regulation is a complex process and a lot of 
proteins are involved. A protein that regulates transcription by binding to short DNA 
sequences located in the upstream region of a gene is called a transcription factor (TF); 
the short DNA sequences are referred as transcription factor binding sites (TFBS) or 
regulatory elements. Typically, a single TF regulates a large set of genes. The 
transcription regulation of a single gene may be the effect of a single TF or the combined 
effect of multiple TFs. The upstream region of each gene regulated by the same TF must 
have at least one binding site specific to that particular TF. All the binding sites for the 
same TF share a high similarity but need not be identical. The bioinformatics problem is 
to find these sites and to describe them in an efficient way.  
A motif is a sequence signature that provides a description of a TFBS. The possible 
ways to represent a motif include a consensus sequence, a frequency matrix, a 
position-specific scoring matrix (PSSM), or a position weight matrix (PWM) [1, 2]. 
Based on the motif representation used, the algorithms to predict TFBSs fall into two 
categories: those based on a consensus sequence representation and those based on a 
matrix representation. Since a matrix representation is considerably more general and 
more descriptive than its consensus sequence counterpart, we only consider algorithms 
based on matrix representations in this paper. Examples of such algorithms include 
AlignACE [3], MEME [4], Bioprospector [5], MDscan [6], YMF [7], Weeder [8], and 
330 E. Zeng and G. Narasimhan 
many more. Different searching strategies were applied is these algorithms. Each 
algorithm has a motif scoring function that it attempt to optimize. Several popular 
scoring functions include IC (information content) [9], MAP (maximum a posteriori 
probability) score [6], Group Specificity Score [3], LLBG (least likely under the 
background model) [10], and Bayesian scoring function [11]. The basic idea behind all 
these algorithms is to look for sequence signatures in the upstream region of a given 
gene set that are statistically overrepresented as compared to a reference set of genes or 
to the genome background.  
Although all the algorithms described above have their successful applications, they 
are far from perfect [12-14]. The common problem is that each algorithm reports a lot 
of motifs and it is very hard to verify all of them. It is very likely that a large fraction of 
these predictions are false positives. The first goal is to reduce the false positives in the 
predictions, and the second goal is to rank the motifs in a biologically meaningful way. 
Comparative genomics data is a relatively new source of data which can help to 
improve the motif prediction. It is well known that motifs that are conserved in 
orthologous sequences are more likely to be functional. So motif conservation across 
related genomes can be used to measure biological significance. The degree of 
conservation of the binding sites among the evolutionarily-related multiple genomes is a 
crude surrogate for the significance of a motif. It is clear that the increasing number of 
whole genome sequences of evolutionarily-related organisms can provide additional 
support to the predictions of binding sites [15-18]. The “phylogenetic footprinting” 
strategy has be used to find motifs that are conserved across related organisms [19]. 
However, any motif that is unique for a particular species will not be detected by this 
method. Furthermore, not all genes have orthologs in all related organisms. Another 
approach is to treat the orthologous sequences in the same way as sequences that are not 
phylogenetically related, that is, simply pool the co-regulated genes and their orthologous 
counterpart before applying computational methods. Obviously, the orthology 
information is under-utilized in such an approach. Several subtle approaches such as 
EMnEM [20] (EM-based), PhyloCon [21] (Greedy algorithm), PhyME [22] (EM-based), 
PhyloGibbs [23] (based on Gibbs Sampling) were developed recently to resolve this 
problem while taking the phylogenetic relationships into account. However, phylogenetic 
relationships are notoriously difficult to infer and are often unreliable. Furthermore, most 
of them need the input sequences to be preprocessed to obtain alignments, which again 
are potentially unreliable. Inaccurate alignments (or phylogenies) hurt the ability to make 
accurate predictions.  
Unlike the de novo motif detection approaches, the method described in this paper 
refines any given motif by incorporating comparative genomics data. It first searches 
sequences for candidate sites. And then filters out those that are not the instances of the 
motif. Recently, Comin et al. reported a subtle motif discovery method using a similar 
two-step strategy [24]. The differences are twofold. First, we incorporate comparative 
genomics data, and second, we use profiles instead of consensus sequences to represent 
the motifs.  
It is important to note that our method can refine a motif starting from one or more 
known (perhaps imprecisely specified) binding sites. This makes sense in many cases 
where biological experiments may have reported partial information wet lab 
 Enhancing Motif Refinement by Incorporating Comparative Genomics Data 331 
experiments from laboratories are often very focused and it is common that only few 
genes and even fewer binding sites are identified by such studies. A good starting point 
for most motif detection methods is the results of gene expression studies, which can 
help to identify co-expressed (and, therefore, potentially co-regulated) sets of genes. 
Then using the method described in this paper, and starting from one or two 
experimentally verified binding sites, we can predict the rest of the relevant binding 
sites of the genes in the pathway and also output a refined profile for the motif. 
2   Methods 
2.1   Enhanced Motif Refinement (EMR Algorithm) 
One simple approach to integrate comparative genomics data into existing motif-finding 
methods is to filter out motifs not conserved across related organisms. However, this 
approach is too simplistic and only considers comparative genomic data in a limited way. 
Our proposed method considers comparative genomics data in a dual manner. 
Comparative genomics data is used not merely to filter  out motifs, but also to filter out 
individual sites that are not instances of the motif. Success of ab initio methods is often 
dictated by the signal-to-noise ratio of the input sequences, which is often rather low. 
Thus, filtering out the individual sites that are not instances of the motif is necessary and 
meaningful because these sites determine the profile of the motif. 
Our algorithm is described below in Figure 1. The algorithm takes as input any motif 
discovered in a given genome Γ1 using any motif detection method. Using one or more 
additional genomes Γ2, the algorithm returns an enhanced motif.  
The motif scoring function optimized in the EMR algorithm is the MAP (maximum 
a posteriori probability) score. 
Input: a) Motif PWM M1, motif length l, and associated gene set G1 from genome Γ1, 
        b) upstream sequences of the ORFs in G1, 
        c) Additional genome(s) Γ2,.and the orthology map for all the genomes, and 
        d) upstream sequences of the ORFs in G2, the orthologs of G1 in Γ2.    
Output: Refined motif PWM Mr  
Algorithm:  
1. Scan the upstream sequences of gene set G2 in genome Γ2 with motif M1 for 
instances.  
2. Add all instances found in Γ2 to M1 and update motif, if doing so increases motif 
score. 
3. Scan the upstream sequences of gene set G1 with the updated motif. 
4. Again, add instances of motif found in G1 and update motif, if doing so increases 
motif score. 
5. Remove instances of motif and update motif, if doing so increases motif score. 
6. Return updated motif. 
 
Fig. 1. EMR Algorithm 
332 E. Zeng and G. Narasimhan 
The EMR algorithm uses two main subroutines. One uses the motif described as a 
PWM and finds all instances of it in a given set of sequences. This is achieved by 
sliding a window of length l and scoring the windows with the PWM, and checking if 
the score is above an appropriate threshold. Given a sequence S, denoted by s1s2…sl, the 
following quantity given by 
( | )ln ( | )s
P S MW
P S B
=
  
measures the ratio of P(S|M), the probability of generating S under model M, to P(S|B), 
the corresponding probability under a background model. Thus if wij is the entry of 
PWM corresponding to base r at position i, then 
1
( )ij
l
s
i
W w
=
=∑ . 
We denote by wir the entry of base r at position i in the PWM, where base r is the ith 
base of the motif consensus sequence c. And we define  
1
ir
l
c
i
W w
=
=∑ . 
Obviously, Wc is the weight of consensus sequence of the motif, and is the largest 
weight among all segments. Now we define a ratio Rsc between Ws and Wc as similarity 
of segment S to motif M.  
s
sc
c
WR
W
=
 
Another implementation related issue is how to choose a motif scoring function. 
Many scoring functions have been used in previous motif discovery methods. Motif 
discovery methods attempt to optimize an appropriate scoring function. A widely used 
scoring function is the MAP (maximum a posteriori probability) score, which is a 
combination of the negative entropy of the PWM and the rareness of the PWM with 
respect to the background [6]. 
4
0
1 1
log( ) 1( log log( ( )))
l
m
ij ij
mi j alls
xMAP w w P s
l x
= =
= −∑∑ ∑ ,  
where l is the width of the motif, xm is the number of sites used to construct the motif, 
Wij is the entry of base j at position i in the PWM and P0(s) is the probability of 
generating the candidate site s from the background model. MAP score maintains a 
good balance well between motif specificity and motif diversity and seems to improve 
the performance of motif finding algorithm [6]. Therefore it was used in this paper. 
 Enhancing Motif Refinement by Incorporating Comparative Genomics Data 333 
2.2   Motif Ranking 
The advantage of EMR algorithm is that it refines the motif predictions resulting from 
any of the current algorithms. Previous research has shown that different motif 
discovery methods often complement each other [25]. That is, many motif discovery 
algorithms often find motifs that are missed by other algorithms. Motif finding 
algorithms search for motifs that maximize different metrics. As a result, motifs judged 
significant by one algorithm may not be ranked as highly by the others. Scoring 
functions like the MAP score are good for optimization methods, but are not necessarily 
good for ranking motifs.  
In this paper, we consider metrics (and develop new ones) that are better suited for 
methods that use comparative genomics data. The hypothesis of these methods is that 
motifs which are conserved in orthologous sequences are more likely to be functional, 
i.e., biologically significant. The straightforward conservation score was defined as the 
average number of orthologous upstream sequences in which the motif is found across 
the genome. Such conservation score was used by Getz et al. [17]. In that paper, each 
gene that has motif sites receives a score that is equal to the number of species in which 
the corresponding ortholog contained a site in its upstream sequence. The scores for all 
the genes that contained at least one site in reference genome are averaged together to 
give the conservation score for a particular motif. In brief, the conservation score S is 
defined as:  
1
i
n
i
sS
n
=
=∑ , 
where si is the number of species in which the ortholog of gene i contained a site in its 
upstream sequence, and n is the total number of genes in the reference genome whose 
upstream sequence has at least one site of the motif. The weakness of this conservation 
score is that it does not consider the following key facts:  
Fact 1: if m denotes the number of species in comparative genomic data, the more   
            instances in which ni equals to m, the more significant the motif is;  
Fact 2: with the same conservation score, the motif with larger value of n is more  
            significant. 
After taking the above two facts into account, we propose a new metric to measure 
the conservation score and use it to rank the motifs resulting from the EMR algorithm. 
The new metric is given by: 
[ ] 1 1
1
log , ,
i
m
i
i
c i i
m
i
i
w in
S mn w w i
n w
=
−
=
= > ∀
∑
∑
   
where m is the number of species in comparative genomic data, n is the total number of 
genes in the reference genome whose upstream sequence has at least one site of the 
motif, ni is the number of genes that has i number of species in which the corresponding 
334 E. Zeng and G. Narasimhan 
ortholog contained at least one motif site in the upstream sequence, and wi is the weight 
constant which satisfies wi > wi-1 for all i, i. e., higher significance is assigned to motif 
instances that occurs in the orthologs of more genomes.  
3   Results and Analysis 
3.1   Synthetic Data 
3.1.1   Constructing Synthetic Data 
The input to the EMR algorithm are the upstream sequences of ORFs of the reference 
genome and the upstream sequences of ORFs from genomes of phylogenetically related 
organisms. The yeast genome was used to constructe a synthetic data set to evaluate the 
EMR algorithm, we used the data set for the metabolic phase in sporulation, which was 
complied by Narasimhan et al., from the work of Chu et al. [26, 27].  
Diploid cells of yeast produce haploid cells through the developmental program of 
sporulation, which is characterized by sequential transcription of at least four sets of 
genes — early, middle, mid-late, and late [26, 28]. A conserved site (URS1) was found 
in the upstream region of many of the known early genes [29]. A total of 42 genes were 
compiled from the work of Chu et al. following a pattern of expression characterized by 
early induction. The upstream regions of 15 of these genes contained a URS1 motif. 
The upstream sequences of these 42 genes were obtained as the first step in 
constructing the synthetic data. All orthologous sequences corresponding to the 42 
sequences were extracted from the genomes - S. paradoxus, S. mikatae, and S. bayanus 
[30]. The gene set associated with these orthologous sequences serve as the gene set G2 
in the EMR algorithm. For keeping the phylogenetic information purpose, the upstream 
sequence of gene set G2 remained unchanged. The upstream sequences of gene set G1 
were constructed from the 15 binding sites. A total of 65 random sequences of length 
800bp were generated based on the GC content of yeast genome Saccharomyces 
cerevisiae. One copy of a known 15 URS1 binding sites was inserted in a random 
location of each of the 15 sequences. 
3.1.2   Results from Synthetic Data Using EMR Algorithm 
The generated sequences (described above) were fed into the motif finding programs 
AlignACE and MEME. The predictions of motif URS1 from AlignACE and MEME 
were then refined using the EMR algorithm. The results are shown in Table 1. 
From the results summary from Table 1, we can see that all the characteristics of the 
motif including MAP score, information content, and number of false sites, showed 
improvement after refinement by the EMR method, regardless of whether the input was 
the results of using AlignACE or MEME. Although the EMR algorithm attempts to 
optimize the MAP score, the IC (information content) score of the motif also showed 
improvement. The data set fed to motif finding algorithms had low signal-to-noise ratio 
(0.23 in this example), which make it difficult for motif finding algorithm to discover 
real motif instances. For example, the output of AlignACE found 6 false sites, while 
 
 Enhancing Motif Refinement by Incorporating Comparative Genomics Data 335 
Table 1. Refined motif from synthetic data (the characteristics of motif before and after 
refinement using the EMR algorithm. The characteristics include consensus sequences or motif 
logos, MAP scores, information content, and number of false sites). 
Program 
Known consensus,  
predicted motif logo,  
and refined motif logo 
MAP Score 
(Before/After) 
Information Content 
(Before/After) 
No. of false sites 
(Before/After) 
AlignACE 
TAGCCGCCGA 
 
 
2.02/3.63 6.85/8.49 6/2 
MEME 
TAGCCGCCGA 
  
2.81/3.64 6.70/8.02 2/2 
MEME introduced 2. After refinement, the number of false sites reduced to 2 using the 
output of AlignACE, and remained unchanged using the output of MEME.  
3.2   Results of Yeast Data 
In a second set of experiments, we applied the EMR algorithm to real yeast data. The 
motif data were obtained from the work of Narasimhan et al. [27]. Four known binding 
sites were investigated including are EBF1, GAL4, PDR, and URS1. The data set 
consisted of upstream sequences of a set of genes. The details of data sets are 
summarized in Table 2.  
Table 2. Yeast Motif Data Sets Summary 
Motif Total No. of sequences No. of sequences that have motif hits Known consensus 
EBF1 16 16 ACACCCA 
GAL4 10 10 CGGNNNNNNNNNNNCCG 
PDR 11 11 TCCGCGGA 
URS1 20 47 TAGCCGCCGA 
Table 3. Motif Ranking by conservation score Sc 
Motif Rank reported by MEME 
Rank reported by 
EMR Sc Score* 
EBF1 3 1 1.0276 ( 0.8187, 0.7756, 0.7322, 0.7971 ) 
GAL4 1 1 0.9672 (0.7284, 0.3548, 0.4359, 0.3054) 
PDR 1 1 0.6176 (0.2543, 0.1324, 0.2180, 0.4560) 
URS1 3 1 0.9168 (0.8198, 0.8686, 0.8321, 0.5123) 
* The score outside the parenthesis is the conservation score for the motif listed in the 
corresponding first column. The score within parenthesis is the conservation score for four 
other motifs reported by MEME. 
336 E. Zeng and G. Narasimhan 
Motif finding program MEME was applied to these four data sets. For each data set, 
five highest-rank motifs based on the metric used by MEME were chosen to report. The 
motifs listed in Table 3 were expected to be reported as the highest one in each 
corresponding category. But this is not always the case as shown in Table 3. However, 
after refinement by our method, the motifs listed in Table 3 were output as the top list. 
Table 3 summarizes the results.  
4   Discussion 
Comparative genomics data can play an important role in motif finding and motif 
ranking. Our work shows that comparative genomics data provides significant 
improvements in these two areas. Our proposed EMR algorithm helps improve motif 
prediction by removing artificial upstream segment.  
Many variants of motif-finding algorithms have been proposed by researchers. 
Different algorithms optimize different scoring functions. Our proposed new metric 
measures the motif score by integrating the comparative genomics data. Previous 
research shows that evolutionarily conserved motifs are functionally relevant. Our 
results show that by using comparative genomics data in a sophisticated manner, motif 
conservation score calculated by our method gives consistent motif ranking and teases 
out biologically-relevant motifs. When motif finding algorithms are applied to a whole 
genome sequence, it generated a lot of output with a large number of false positives. 
Our proposed metric helps to rank these genome-wide motifs to facilitate researchers to 
choose the best ones for experimental verification. 
Acknowledgements. The work of G. N. was supported in part by a grant from NIH 
under NIH/NIGMS S06 GM008205. E. Z. was supported by Florida International 
University Presidential Fellowship. 
References 
1. Stormo, G.D., DNA binding sites: representation and discovery. Bioinformatics, 2000. 
16(1): p. 16-23. 
2. Werner, T., Models for prediction and recognition of eukaryotic promoters. Mamm 
Genome, 1999. 10(2): p. 168-75. 
3. Hughes, J.D., et al., Computational identification of cis-regulatory elements associated with 
groups of functionally related genes in Saccharomyces cerevisiae. J Mol Biol, 2000. 296(5): 
p. 1205-14. 
4. Bailey, T.L. and C. Elkan, Fitting a mixture model by expectation maximization to discover 
motifs in biopolymers. Proc Int Conf Intell Syst Mol Biol, 1994. 2: p. 28-36. 
5. Liu, X., D.L. Brutlag, and J.S. Liu, BioProspector: discovering conserved DNA motifs in 
upstream regulatory regions of co-expressed genes. Pac Symp Biocomput, 2001: p. 127-38. 
6. Liu, X.S., D.L. Brutlag, and J.S. Liu, An algorithm for finding protein-DNA binding sites 
with applications to chromatin-immunoprecipitation microarray experiments. Nat 
Biotechnol, 2002. 20(8): p. 835-9. 
7. Sinha, S. and M. Tompa, YMF: A program for discovery of novel transcription factor 
binding sites by statistical overrepresentation. Nucleic Acids Res, 2003. 31(13): p. 3586-8. 
 Enhancing Motif Refinement by Incorporating Comparative Genomics Data 337 
8. Pavesi, G., et al., Weeder Web: discovery of transcription factor binding sites in a set of 
sequences from co-regulated genes. Nucleic Acids Res, 2004. 32(Web Server issue): p. 
W199-203. 
9. Hertz, G.Z. and G.D. Stormo, Identifying DNA and protein patterns with statistically 
significant alignments of multiple sequences. Bioinformatics, 1999. 15(7-8): p. 563-77. 
10. Friberg, M., P. von Rohr, and G. Gonnet, Scoring functions for transcription factor binding 
site prediction. BMC Bioinformatics, 2005. 6: p. 84. 
11. Jensen, S.T. and J.S. Liu, BioOptimizer: a Bayesian scoring function approach to motif 
discovery. Bioinformatics, 2004. 20(10): p. 1557-64. 
12. MacIsaac, K.D. and E. Fraenkel, Practical strategies for discovering regulatory DNA 
sequence motifs. PLoS Comput Biol, 2006. 2(4): p. e36. 
13. Sandve, G.K. and F. Drablos, A survey of motif discovery methods in an integrated 
framework. Biol Direct, 2006. 1: p. 11. 
14. GuhaThakurta, D., Computational identification of transcriptional regulatory elements in 
DNA sequence. Nucleic Acids Res, 2006. 34(12): p. 3585-98. 
15. van Nimwegen, E., et al., Probabilistic clustering of sequences: inferring new bacterial 
regulons by comparative genomics. Proc Natl Acad Sci U S A, 2002. 99(11): p. 7323-8. 
16. Xie, X., et al., Systematic discovery of regulatory motifs in human promoters and 3' UTRs 
by comparison of several mammals. Nature, 2005. 434(7031): p. 338-45. 
17. Gertz, J., et al., Discovery, validation, and genetic dissection of transcription factor binding 
sites by comparative and functional genomics. Genome Res, 2005. 15(8): p. 1145-52. 
18. Gertz, J., J.C. Fay, and B.A. Cohen, Phylogeny based discovery of regulatory elements. 
BMC Bioinformatics, 2006. 7: p. 266. 
19. Blanchette, M. and M. Tompa, Discovery of regulatory elements by a computational 
method for phylogenetic footprinting. Genome Res, 2002. 12(5): p. 739-48. 
20. Moses, A.M., D.Y. Chiang, and M.B. Eisen, Phylogenetic motif detection by 
expectation-maximization on evolutionary mixtures. Pac Symp Biocomput, 2004: p. 324-35. 
21. Wang, T. and G.D. Stormo, Combining phylogenetic data with co-regulated genes to 
identify regulatory motifs. Bioinformatics, 2003. 19(18): p. 2369-80. 
22. Sinha, S., M. Blanchette, and M. Tompa, PhyME: a probabilistic algorithm for finding 
motifs in sets of orthologous sequences. BMC Bioinformatics, 2004. 5: p. 170. 
23. Siddharthan, R., E.D. Siggia, and E. van Nimwegen, PhyloGibbs: a Gibbs sampling motif 
finder that incorporates phylogeny. PLoS Comput Biol, 2005. 1(7): p. e67. 
24. Comin, M. and L. Parida. Subtle Motif Discovery for Detection of DNA regulatory sites. in 
Asia Pacific Bioinformatics Conference (APBC2007). 2007. Hong Kong. 
25. Tompa, M., et al., Assessing computational tools for the discovery of transcription factor 
binding sites. Nat Biotechnol, 2005. 23(1): p. 137-44. 
26. Chu, S., et al., The transcriptional program of sporulation in budding yeast. Science, 1998. 
282(5389): p. 699-705. 
27. Narasimhan, C., P. LoCascio, and E. Uberbacher, Background rareness-based iterative 
multiple sequence alignment algorithm for regulatory element detection. Bioinformatics, 
2003. 19(15): p. 1952-63. 
28. Mitchell, A.P., Control of meiotic gene expression in Saccharomyces cerevisiae. Microbiol 
Rev, 1994. 58(1): p. 56-70. 
29. Rubin-Bejerano, I., et al., Induction of meiosis in Saccharomyces cerevisiae depends on 
conversion of the transcriptional represssor Ume6 to a positive regulator by its regulated 
association with the transcriptional activator Ime1. Mol Cell Biol, 1996. 16(5): p. 2518-26. 
30. Kellis, M., et al., Sequencing and comparison of yeast species to identify genes and 
regulatory elements. Nature, 2003. 423(6937): p. 241-54. 
