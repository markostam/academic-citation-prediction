D880–D884 Nucleic Acids Research, 2009, Vol. 37, Database issue
doi:10.1093/nar/gkn878
CleanEx: new data extraction and merging
tools based on MeSH term annotation
Viviane Praz1,* and Philipp Bucher2
1ISREC, Swiss Institute of Bioinformatics, Boveresses 155, Epalinges, VD 1066 and 2ISREC/EPFL, Swiss
Institute of Bioinformatics, Epalinges, VD, Switzerland
Received September 16, 2008; Revised October 16, 2008; Accepted October 17, 2008
ABSTRACT
The CleanEx expression database (http://www.clea
nex.isb-sib.ch) provides access to public gene
expression data via unique gene names as well as
via experiments biomedical characteristics. To
reach this, a dual annotation of both sequences
and experiments has been generated. First, the
system links official gene symbols to any kind of
sequences used for gene expression measurements
(cDNA, Affymetrix, oligonucleotide arrays, SAGE or
MPSS tags, Expressed Sequence Tags or other
mRNA sequences, etc.). For the biomedical annota-
tion, we re-annotate each experiment from the
CleanEx database with the MeSH (Medical Subject
Headings) terms, primarily used by NLM (National
Library of Medicine) for indexing articles for the
MEDLINE/PubMED database. This annotation
allows a fast and easy retrieval of expression data
with common biological or medical features. The
numerical data can then be exported as matrix-like
tab-delimited text files. Data can be extracted
from either one dataset or from heterogeneous
datasets.
INTRODUCTION
Given the increasing size of public databases storing high-
throughput gene expression experiments, namely GEO (1)
and ArrayExpress (2), the problem of speciﬁc expression
data retrieval is becoming a serious challenge, mainly
related to two major annotation issues: a precise and
up-to-date link between the numerical results of the
expression measurements and the name of the correspond-
ing transcripts, the tag-to-gene mapping, and second, a
correct and universal biomedical annotation of the
samples and experiments, or experiments’ annotation.
Due to the rapid evolution of genomes’ annotations, the
tag-to-gene mapping needs to be refreshed continuously to
maintain its usefulness. On the other hand, the experi-
ments’ annotation, often based on a free-text variable
description, needs to be standardized once via a
common biological ontology.
To meet these annotation standards for public expres-
sion data, we developed the CleanEx (3) tags-to-gene
re-annotation and biomedical integration system, which
allows to keep an up-to-date gene annotation for expres-
sion data, and which provides a standard biomedical
annotation of Human and Mouse public expression data-
sets, based on the Medical Subjects Headings (MeSH
http://www.nlm.nih.gov/mesh/) terms. The CleanEx
database now contains nearly one thousand of Human
and Mouse datasets, most of them were uploaded
from the GEO database and biologically re-annotated
by CleanEx. The upload rhythm depends on the post-
processing needed for each dataset. During last year, a
mean of 15 datasets per month have been integrated in
the CleanEx re-annotated data. The ﬁrst choice for data
upload goes to cancer data, in particular breast and lung
cancer data, as these are the main research topics at the
Swiss Institute for Experimental Research. It is estimated
that at least 60% of all publicly available data meeting
these criteria are currently available via CleanEx.
Regarding tags-to-gene mapping, CleanEx newly pro-
vides a mapping for SAGE (4) or MPSS (5) tags. The
CleanEx Aﬀymetrix (http://www.aﬀymetrix.com) map-
ping ﬁles are now also accessible by an external
Aﬀymetrix probes viewer called Splicy (http://host10.
bioinfo3.ifom-ieo-campus.it/splicy/) (6).
Major improvement in the web interfaces has lead to an
eﬃcient mechanism for both data retrieval and analysis.
The expression measurements can be searched via gene
names, as well as via the biomedical MeSH terms.
Speciﬁc data can then be analyzed on the CleanEx
server or downloaded as a matrix-formatted text ﬁle.
The CleanEx data analysis system is now coupled with
the Signal Search Analysis (SSA) server (http://www.
isrec.isb-sib.ch/ssa/) (7), and a promoter sequence retrieval
system.
*To whom correspondence should be addressed. Tel/Fax: 4121 692 5956; Email: viviane.praz@unil.ch
 2008 The Author(s)
This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/
by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.
 at Pennsylvania State U
niversity on February 26, 2014
http://nar.oxfordjournals.org/
D
ow
nloaded from
 
GEO, ArrayExpress AND CleanEx
Amongst the three oﬃcial gene expression repositories
selected by the MIAME consortium, two are heavily
populated and oﬀer user-friendly data access interfaces,
namely ArrayExpress (http://www.ebi.ac.uk/microarray-
as/ae/) and GEO (http://www.ncbi.nlm.nih.gov/geo/).
ArrayExpress is the second in terms of data quantity,
while GEO has become the major repository and contains
now nearly 10 000 experiments, or series, generated with
very heterogeneous experimental procedures. Though the
ﬁrst aim of these two databases was to serve as public
expression data archives and distribution centers, they
both evolved considerably beyond this scope and oﬀer
a number of tools to query an integrated database of
expression proﬁles.
GEO provides, via the NCBI Entrez (http://
www.ncbi.nlm.nih.gov/) system or directly via dataset
identiﬁers, some interesting data retrieval tools, going
from the single-gene expression retrieval with expression
graphs to complex queries allowing data clustering.
However, clustering is possible only for a subset of anno-
tated GEO series (GSE), called datasets (GDS), which
have been manually annotated and classiﬁed according
to speciﬁc experimental criteria. The data retrieval and
analysis is limited to a single series/dataset at a time.
ArrayExpress oﬀers a search system which retrieves
all the annotated experiments for one gene at once.
The ArrayExpress team has also set up its own ontology
(Ontology—EFO: http://www.ebi.ac.uk/ontology-lookup/
browse.do?ontName=EFO) (8), based on the MGED
(http://www.mged.org/) Ontology Work Group (OWG
http://mged.sourceforge.net/ontologies/index.php) pro-
posals, as a trial to classify the data via a list of standard
terms. This ontology contains biomedical terms, as well as
terms associated with gene expression proﬁling protocols.
The expression data query interface, however, is not yet
linked to the tree-like structure of this ontology.
Despite the emergence of biomedical ontologies (9),
the expression experiments’ annotation is still quite incon-
sistent, often using diﬀerent synonyms for the same con-
cept. This heterogeneity problem has already been faced
for the numerical expression values. While the numerical
values, though not standardized across diﬀerent plat-
forms, are now stored in well-deﬁned formats that make
retrieval and downstream analysis easy the usual format
for experimental annotation is stil based on a free text
description. The annotation standardization is mainly
done after data integration, by the repository maintainers.
An example is the previously mentioned ‘datasets’ (GDS)
of GEO, which are pools of manually annotated
experiments.
In the following part we will describe the methods devel-
oped in the CleanEx database to handle the two annota-
tion issues mentioned above, namely the gene mapping
and the experiments’ annotation standardization.
CleanEx TAG-TO-GENE MAPPING
The CleanEx ‘tag-to-gene’ mapping, which provides all
expression measurements for one gene under one single
name (usually the oﬃcial gene symbol), has already been
described in the former paper (3). In brief, all the sequences
which appear in a CleanEx dataset (Aﬀymetrix probe set
sequences, SAGE or MPSS tags, RefSeq entries (http://
www.ncbi.nlm.nih.gov/RefSeq/), Expressed Sequence
Tags (ESTs) or oligonucleotides) called ‘targets’ are
remapped to known RNA sequences (RefSeq, ESTs,
mRNAs, etc.), or ‘features’. In the second step, these
sequences, through their accession numbers, are mapped
onto gene names via the Unigene (http://www.ncbi.nlm.
nih.gov/sites/entrez?db=unigene) database. Note that
the tag-to-gene mapping may initially associate one
target with multiple genes. For instance, individual
sequences of an Aﬀymetrix probeset may match diﬀerent
mRNAs. The way such ambiguities are handled has been
described in detail in the previous paper (3). Note further
that the accuracy of the annotation depends both on
the genome’s annotation accuracy, and on the depth of
the arrays’ or platforms’ annotation. If the authors of the
experiments give access to the raw sequences for their plat-
form (Aﬀymetrix, SAGE and MPSS), we regularly re-map
these sequences onto the continuously growing RNA
sequence repositories to increase the mapping precision.
For other experiments, the platform annotation often
refers to accession numbers of published sequences which
matched the spotted sequence at the moment the experi-
ment was carried out. Then, only the mapping of the
sequence accession numbers onto Unigene clusters is pos-
sible, and there is a risk of information loss with time as
sequence accession numbers may disappear from Unigene.
The regular remapping of accession numbers on the
Unigene database can anyway improve the accuracy of
the gene annotation, as sequences considered as ‘unknown’
when entered in the databases later become members of
Unigene clusters of known genes. To follow the continuous
evolution of the organisms’ speciﬁc gene catalogs, this
mapping procedure is done on a monthly basis.
In addition to the mapping of dual channel and
Aﬀymetrix platforms, CleanEx now also provides an accu-
rate mapping for SAGE, LONGSAGE, MPSS and
LONGMPSS tags via a procedure which resembles the
one used for Aﬀymetrix, except that we reduce the
sequence search space by using only RNA sequences
which have already been associated with SAGE and
MPSS tags. This ﬁlter is based on an in-house built
Human and Mouse transcriptome called the Trome data-
base (http://www.isrec.isb-sib.ch/tromer/) (10). Using this
ﬁltered sequences database, the procedure maps tags to
sequences via the ‘tagger’ program (11), and then links
sequence identiﬁers to gene names via Unigene clusters.
Each SAGE or MPSS tag is ﬂagged with a quality tag
which indicates its speciﬁcity (Figure 1). This quality tag
is also provided for other targets. For Aﬀymetrix probe-
sets, the quality tag is based on the mapping of the indi-
vidual probes sequences. The CleanEx mapping can be
retrieved either on a single-gene basis, or via a batch
web query which can handle multiple identiﬁer types,
such as Unigene, RefSeq, GenBank/EMBL (http://www.
ncbi.nlm.nih.gov/Genbank/) gene symbols or Entrez
GeneID (http://www.ncbi.nlm.nih.gov/sites/entrez?db=
gene). The Aﬀymetrix probes mapping on ESTs,
Nucleic Acids Research, 2009, Vol. 37, Database issue D881
 at Pennsylvania State U
niversity on February 26, 2014
http://nar.oxfordjournals.org/
D
ow
nloaded from
 
mRNAs from GenBank, RefSeq mRNAs and HTCs for
each chip and each organism is provided as separated text
ﬁles on the ftp server (ftp://ftp.epd.unil.ch/pub/databases/
CleanEx/Aﬀy_mapping).
CleanEx EXPRESSION EXPERIMENT
ANNOTATION
In order to get an accurate experiment annotation
from the usual free-text descriptions provided in the
data repositories, we have re-annotated all the CleanEx
datasets with the terms belonging to the MeSH controlled
vocabulary dictionary. MeSH is the National Library
of Medicine’s controlled vocabulary thesaurus, which is
constantly improved and developed. It consists of sets of
terms naming descriptors in a hierarchical structure
that allows searching at various levels of speciﬁcity.
The MeSH thesaurus is used to index articles from
biomedical journals for the MEDLINE/PubMED
database.
The hierarchical structure of this catalog, as well as the
fact that it is already used to retrieve biomedical data,
makes it a good start to annotate gene expression experi-
ments. We generated a semi-automatic procedure which
ﬁrst associates the corresponding MeSH terms to all its
stored synonyms, then searches these terms in the free-text
expression experiment annotation and stores the oﬃcial
terms list for each experiment. In a second phase, the
accuracy of the association between the MeSH terms
and the experiments is manually veriﬁed. The automati-
cally selected MeSH terms are either accepted or rejected,
according to their relevance for the given experiment. This
two-step procedure ensures that:
– Only MeSH terms are kept in the experiments’ anno-
tations, and all the recorded synonyms for each MeSH
term are checked.
– The terms retrieved are consistent with the experiment
original free-text description.
CleanEx WEB-BASED TOOLS
To ease data retrieval, the ﬁnal annotation is stored in an
indexed ﬁle for both the whole datasets and the individual
experiments. To keep the MeSH tree in a reasonable
range, only the part of the tree which is related to
CleanEx datasets or experiments is reproduced on the
CleanEx query web server. The biomedical annotations
of the datasets can be searched in diﬀerent ways via the
proposed web-based tools. All the tools are listed on the
database main page (http://www.cleanex.isb-sib.ch). A list
of output examples is also available from the CleanEx
server (http://www.cleanex.isb-sib.ch/examples.html).
First, the MeSH-oriented retrieval tool is linked to the
gene-oriented search tools. This allows users to retrieve
speciﬁc expression data together with a speciﬁc gene
description with very high annotation accuracy. As an
example, one can retrieve the list of all the CleanEx data-
sets related to Breast Cancer AND associated with the
ﬁbronectin one (FN1) gene via this dual gene/experiment
query form.
Second, the MeSH-based annotation can be used to
retrieve and extract numerical expression data from
Figure 1. Mapping process for SAGE and MPSS tags. Sequences belonging to Trome clusters are stored in a tempory database The SAGE or
MPSS tags are then mapped onto these sequences via the ‘‘tager’’ program. The corresponding gene name for the stored sequence identiﬁres
is extracted from Unigene. The quality is given according to the following criteria, for each SAGE or MPSS tag : if all the targeted sequences
belong to one or two Unigene clusters, the quality is set as ‘‘High’’, If all the targeted sequences belong to more than two but less than ﬁve clusters,
the quality is set as ‘‘Medium’’. For more than clusters, is ‘‘low’’. Otherwise, the quality is considered as ‘‘Unknown’’. The process is done for human
and mouse.
D882 Nucleic Acids Research, 2009, Vol. 37, Database issue
 at Pennsylvania State U
niversity on February 26, 2014
http://nar.oxfordjournals.org/
D
ow
nloaded from
 
datasets with speciﬁc biomedical criteria (see examples 7
and 8 at http://www.cleanex.isb-sib.ch/examples.html).
All the checked terms are then searched in the indexed
ﬁle, and the corresponding experiments are extracted
from the CleanEx datasets. The search along the MeSH
tree is fast and accurate and can be done either at the
datasets level or at the experiments level. Data can thus
be extracted either from one single dataset or from multi-
ple, possibly platform-heterogeneous datasets. In the
former case, the user can select the numerical ﬁeld to
extract from the original data. For example, for a dual
channel experiment, one could extract only the ‘red’ chan-
nel, or the ratio, or directly the normalized data, if these
ﬁelds are provided by the authors of the experiment. For
heterogeneous data retrieval, a rank-based scaling is
applied on the numerical data, where all the numerical
values for all individual samples or arrays are scaled
between 0 and 1000, in order to make the comparison
between data coming from diﬀerent datasets possible.
The procedure extracts these numerical data for all the
common genes across the selected experiments.
All the search tools using the MeSH based datasets and
experiments annotation can be queried by either using the
javascript ‘walk down the MeSH tree’ page to select the
appropriate terms, or by directly listing the speciﬁc MeSH
terms to search in the database. In both cases, the terms to
search can be linked by diﬀerent operators (AND, OR or
BUT NOT), allowing the generation of complex queries
for the indexed annotation ﬁles. An example of such a
query could be: ‘Colon OR Pancreas BUT NOT Cell
Line AND Neoplasms BUT NOT Neoplasm Metastasis’.
After data selection and extraction, the numerical
values are provided as a matrix ﬁle in which the columns
represent the experiments, or samples, and the lines repre-
sent either targets, for single dataset extraction, or genes,
for heterogeneous data extraction. The targets’ annotation
and the original experiments’ description are provided as
additional ﬁles. These ﬁles can then be used as inputs for
speciﬁc expression data analysis programs, such as R
(http://www.r-project.org/) and Bioconductor (http://
www.bioconductor.org/), or on-line expression analysis
tools, such as EPClust (http://www.bioinf.ebc.ee/EP/EP/
EPCLUST/) or the SotArray server (http://www.tran
scriptome.ens.fr/cgi-bin/gepas/sotarray) (12).
CleanEx also provides a comparison tool, in which you
can generate two experiments pools based on diﬀerent
biomedical criteria, and extract the scaled numerical
values of the corresponding experiments. Numerical data
are provided as two diﬀerent matrices, one for each pool.
The experiments’ description, as well as the gene list, is
given in two separated ﬁles. One can then compare the
expression level in these two pools via the CleanEx analy-
sis system. This tool is based on a basic ‘mean diﬀerence
ranking’ system, which is described in more details in
the CleanEx online documentation (http://www.cleanex.
isb-sib.ch/tutorial/CleanEx_tutorial.html#analysis_step).
For both pools, the expression mean of each gene is
calculated. The gene list is sorted according to this value
for the two biomedical conditions. The diﬀerence of
the gene position in each pool gives the gene expression
bias between the two experiments pools. From the
given result (a list of genes ordered according to their
expression mean ranking diﬀerence), one can extract the
promoter regions of a selected subset of genes. The
sequences provided in FASTA format can then be
uploaded to web-based motif discovery tools such as
Signal Search Analysis (http://www.isrec.isb-sib.ch/ssa)
(6) or ‘MEME’ (http://meme.nbcr.net) (13). This sequence
download system is unique in the sense that the sequence
list can be generated from a comparison across hetero-
geneous expression experiments. As an example,
Figure 2 shows the graph obtained by using the SSA
server with sequences of genes diﬀerentially expressed in
cancer tissues. The two genes’ lists and their correspond-
ing sequences have been obtained via the CleanEx com-
parison tool. All the CleanEx online tools are described in
details in the CleanEx tutorial (http://www.cleanex.isb-
sib.ch/tutorial/). The description of each tool is illustrated
with speciﬁc examples.
DISCUSSION
Adding extraction and analysis tools to transcriptomics
repositories has greatly facilitated the use of public data
by external users. The use of a tree-based biomedical
ontology system to retrieve speciﬁc data is probably well
adapted for these repositories which contain such a vast
amount of data, as it reduces the search space while going
down the ontology tree. This type of ontologies exists
already. As an example, the EFO ArrayExpress ontology
is a member of the Open Biomedical Ontologies (OBO)
(http://www.obofoundry.org/). All the ontology databases
in OBO can be browsed via the Ontology lookup service
(OLS), a centralized query interface for ontology and con-
trolled vocabulary lookup. There are now more than forty
ontologies integrated in OBO. Though very complete, the
Figure 2. Over-representation of TATA-box-occurrences in human
genes which show up-regulation in cancer tissues. Promoter sequences
for up- and down-regulated sets of genes havae been extracted via the
cleanEX two pools comparision tool and-box freaquency has been
analysed via the SSA server with default options.
Nucleic Acids Research, 2009, Vol. 37, Database issue D883
 at Pennsylvania State U
niversity on February 26, 2014
http://nar.oxfordjournals.org/
D
ow
nloaded from
 
OBO system is also very complex and stores data coming
from a wide range of concepts, amongst which only a few
are relevant for expression data annotation. For that
reason, we decided not to use the complete OBO ontology,
but to focus on biomedical standardized terms used in
MeSH. This catalog has already proven to be very
useful for retrieval of biomedical scientiﬁc publications,
and adapting it to gene expression experiments was
indeed straightforward. The CleanEx database and its col-
lection of MeSH- and gene-oriented query systems can be
considered as a ‘proof of concept’ that using MeSH terms,
or any other well structured biomedical ontology, for tran-
scriptomics data retrieval is doable and eﬀective.
FUNDING
Funding for open access charge: The Swiss Government.
Conﬂict of interest statement. None declared.
REFERENCES
1. Barrett,T., Troup,D.B., Wilhite,S.E., Ledoux,P., Rudnev,D.,
Evangelista,C., Kim,I.F., Soboleva,A., Tomashevsky,M., Edgar,R.
et al. (2006) NCBI GEO: mining tens of millions of expression
proﬁles–database and tools update. Nucleic Acids Res., 35,
D760–D765.
2. Parkinson et al. (2007) ArrayExpress – a public database of
microarray experiments and gene expression proﬁles. Nucleic
Acids Res., 35, D747–D750.
3. Praz,V., Jagannathan,V. and Bucher,P. (2005) CleanEx: a database
of heterogeneous gene expression data based on a consistent gene
nomenclature. Nucleic Acids Res., 32, D542–D547.
4. Velculescu,V.E., Zhang,L., Vogelstein,B. and Kinzler,K.W. (1995)
Serial analysis of gene expression. Science, 270, 484–487.
5. Brenner,S., Johnson,M., Bridgham,J., Golda,G., Lloyd,D.H.,
Johnson,D., Luo,S., McCurdy,S., Foy,M., Ewan,M. et al. (2000)
Gene expression analysis by massively parallel signature sequencing
(MPSS) on microbead arrays. Nat. Biotechnol., 18, 630–634.
6. Rambaldi,D., Felice,B., Prav,V., Bucher,P., Cittaro,D. and
Gufanti,A. (2007) Splicy: a web-based tool for the prediction of
possible alternative splicing events from Aﬀymetrix probeset data.
BMC Bioinformatics, 8, S17.
7. Ambrosini,G., Praz,V., Jagannathan,V. and Bucher,P. (2003) Signal
search analysis server. Nucleic Acids Res., 31, 3618–3620.
8. Malone,J., Rayner,T.F., Bradley,X.Z. and Parkinson,H. (2008)
Developing an application focused experimental factor ontology:
embracing the OBO Community. In Proceedings of ISMB 2008 SIG
meeting on Bio-ontologies.
9. Rubin,D.L., Shah,N.H. and Noy,N.F. (2008) Biomedical ontolo-
gies: a functional perspective. Brief. Bioinform., 9, 75–90.
10. Sperisen,P., Iseli,C., Pagni,M., Stevenson,B.J., Bucher,P. and
Jongeneel,C.V. (2004) trome, trEST and trGEN: databases of
predicted protein sequences. Nucleic Acids Res., 32, D509–D511.
11. Iseli,C., Ambrosini,G., Bucher,P. and Jongeneel,C.V. (2007)
Indexing strategies for rapid searches of short words in genome
sequences. PLoS One, 2, e579.
12. Herrero,J., Al-Shahrour,F., Dı´az-Uriarte,R., Mateos,A´.,
Vaquerizas,J.M., Santoyo,J. and Dopazo,J. (2003) GEPAS, a
web-based resource for microarray gene expression data analysis.
Nucleic Acids Res., 31, 3461–3467.
13. Bailey,T.L., Williams,N., Misleh,C. and Li,W.W. (2006) MEME:
discovering and analyzing DNA and protein sequence motifs.
Nucleic Acids Res., 34, W369–W373.
D884 Nucleic Acids Research, 2009, Vol. 37, Database issue
 at Pennsylvania State U
niversity on February 26, 2014
http://nar.oxfordjournals.org/
D
ow
nloaded from
 
