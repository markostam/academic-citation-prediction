The Vienna RNA Secondary Structure Server
Ivo L. Hofacker
Institut fu¨r Theoretische Chemie und Molekulare Strukturbiologie,
Universita¨t Wien, Wa¨hringerstraße 17, A-1090 Wien, Austria
Abstract
The Vienna RNA secondary structure server provides a web interface to the most
frequently used functions of the Vienna RNA software package for the analysis of
RNA secondary structures. It currently offers prediction of secondary structure from
a single sequence, prediction of the consensus secondary structure for a set of aligned
sequences, and the design of sequences that will fold into a predefined structure.
All three services can be accessed via the the Vienna RNA web server at
http://rna.tbi.univie.ac.at/
Keywords: RNA secondary structure prediction, partition function, consensus struc-
ture, sequence design.
1. Introduction
Biomolecules exhibit a close interplay between structure and function. Therefore the
growing number of RNA molecules with complex functions, beyond that of encod-
ing proteins, has brought increased demand for RNA structure prediction methods.
While prediction of tertiary structure is usually infeasible, the area of RNA secondary
structures is an example where computational methods have been highly successful.
The first practical dynamic programming algorithms to predict the optimal secondary
structure of an RNA sequence date back over 20 years [16]. Since then they’ve been
extended to allow prediction of suboptimal structures [14, 13] and thermodynamic
ensembles [10], which allow to assign a confidence level or “well definedness” to the
predictions [15].
Recently, several methods have addressed the problem of predicting a consensus struc-
ture for a group of related RNA sequences [2, 3, 8, 6, 7, 4]. Such conserved structures
are of particular interest, since conservation of structure in spite of sequence varia-
tion implies that the structure must be functionally important. By enhancing energy
1
Hofacker: Vienna RNA Web Services 2
rules with sequence covariation these methods also obtain much better prediction
accuracies.
The Vienna RNA package [5] is a free software package that implements a variety of
algorithms for the prediction and the analysis of RNA secondary structures. The pack-
age is however strongly geared toward UNIX command-line users and programmers.
For the less computer savvy, or occasional user, it provides neither a point-and-click
graphical user interface nor even pre-compiled binaries.
The Vienna RNA web site tries to address these shortcomings by offering access
to the most popular features via an easy to use web interface. It consists of three
CGI scripts equivalent to the RNAfold, RNAalifold, and RNAinverse command line
programs, respectively. While the servers have to limit request sizes for performance
reasons, they return for each request an equivalent command line invocation. This
makes it easier for users to make the transition to locally installed software, should
their requirements exceed the limits of the web service.
2. The RNAfold Server
Of the three services, the RNAfold server provides both the most basic and most
widely used function. Input consist of a single sequence that has to be typed or
pasted into a textfield of the input form.
In the simplest case, the server predicts only the minimum free energy (mfe) structure
of a single sequence using the classic algorithm of Zuker & Stiegler [16]. In addition
to mfe folding the server can calculate equilibrium base pairing probabilities via John
McCaskill’s partition function algorithm [10].
By default the RNA energy parameters of the Turner group [9] are used, but single
stranded DNA sequences can be handled as well, by selecting the DNA parameter set
provided by John SantaLucia [11].
The fold server output consists of a static html page presenting the predicted mfe
structure as a string in bracket notation and links to the plots generated for visual-
ization. Three types of plots can be produced: First, the predicted mfe structure is
plotted as a conventional secondary structure graph using the naview layout method
[1]. The pair probabilities can be visualized in a so called “dot plot”: on a square
grid of n × n we draw for each possible pair (i, j) a box with area proportional to
its probability pij. Finally, we produce a mountain plot depicting both the predicted
mfe and pair probabilities. A mountain plot is an xy-graph that plots the number of
base pairs enclosing a sequence position (for pair probabilities the average number of
enclosing pairs). See Fig 1 for examples of all three representations.
Secondary structure drawing and dot plots are always produced in Postscript format.
Postscript is used not only because it gives the highest print quality, but also because
it allows the actual data to be embedded in the file, e.g. all pair probabilities are
contained in the dot plot in an easy to parse format. On the other hand, Postscript
files can not be used for inline images on web pages and require additional software
for viewing (e.g. gsview).
Hofacker: Vienna RNA Web Services 3
GCGUAA
G GC G CGG C A C C
U
UGUGC
s31544
G C G U A A G G C G C G G C A C C U U G U G C
G C G U A A G G C G C G G C A C C U U G U G C
G
C
G
U
A
A
G
G
C
G
C
G
G
C
A
C
C
U
U
G
U
G
C GC
G
U
A
A
G
G
C
G
C
G
G
C
A
C
C
U
U
G
U
G
C
Figure 1. Three representations for secondary structure and structure ensembles as pro-
duced by the RNAfold service: Structure graph, mountain plot and dot plot. As can be
seen clearly in the dot plot, the sequence has two almost equally good but very dissimilar
foldings.
A suitable alternative is the new standard for Scalable Vector Graphics, SVG. Users
with SVG enabled browsers (typically through the use of Adobe’s SVG plugin) can
request structure drawings in SVG, which allows some interactivity such as toggling
annotation.
Currently the server accepts sequence up to a maximum length of 4000nt, sequences
up to 300nt will be processed immediately while longer jobs are submitted to a batch
queue, in which case the user is notified by email after completion.
3. The Alifold Server
The Alifold service predicts the consensus secondary structure for a set of aligned RNA
or DNA sequences by using modified dynamic programming algorithms that add a
covariance term to the standard energy model [4], again it supports prediction of mfe
structures and pair probabilities. Usage is almost identical to that of the RNAfold
service. Instead of typing an input sequence, a precomputed sequence alignment is
uploaded via the input form. Currently, only alignments in CLUSTAL format are
accepted. The server restricts both the size of the upload and the length of the
alignment, current limits being 10Kilobytes and 2000nt, respectively.
Results are again visualized in Postscript plots that are enhanced by information on
sequence variation. In the structure drawings mutations supporting the predicted
structure are marked by circles, in the dot plots and mountain plots, color is used
to indicate the number of different pair types. Examples and detailed explanation of
these representations can be found on the online help page.
Hofacker: Vienna RNA Web Services 4
4. The Inverse Fold Server
Finding sequences that fold into a predefined structure is the inverse of structure
prediction problem. Often it is useful to design such sequences e.g. in order to ex-
perimentally test an hypothesis about functional structures. While this is often done
manually for very short sequences, it quickly becomes tedious and error prone.
Our inverse folding service treats sequence design as an optimization problem in se-
quence space that is solved heuristically [5]. There are again two variants based on
mfe and partition function folding. In the first case we minimize the dissimilarity
between the predicted mfe structure and the desired target structure. In the second
case we optimize the frequency of the target structure in the thermodynamic ensem-
ble. While the mfe optimization typically yields sequences that are marginally stable,
i.e. have many alternative foldings, optimization via the partition function produces
sequences with a very strong preference for the target structure.
Input consists simply of the desired structure in bracket notation. The maximum
structure length is currently 100nt. The time needed for the search varies widely
depending on the ubiquity of the target structure. Most valid secondary structure
strings never occur as mfe structure of some sequence (i.e. many sequence design
problems have no solution), while some others are extremely common (see e.g. [12]).
Conversely, the number of search steps performed by the algorithm is a good indicator
for the frequency of a structure in sequence space.
5. Future Plans
The Vienna RNA secondary structure server presented here provide only basic access
to a subset of the functions in the Vienna RNA software package. Nevertheless they
provide a convenient interface for users that need RNA structure prediction only
occasionally and a shallow learning curve for those new to the field.
Work is underway to further improve the visualization of the results, e.g. by producing
structure drawings annotated with various measures of well-definedness. As SVG
enabled browsers become more widespread, a combination of SVG graphics and client
side javascript should allow users to explore the predicted structures interactively.
While the server currently runs on a somewhat dated dual pentium II 450MHz ma-
chine, the use of a batch queuing system allows jobs to be distributed to other ma-
chines should that become necessary.
Acknowledgments: This work is supported by the Austrian Fonds zur Fo¨rderung
der Wissenschaftlichen Forschung, Projects FWF 15893 and P-13545-MAT.
References
[1] R. E. Bruccoleri and G. Heinrich. An improved algorithm for nucleic acid secondary structure
display. CABIOS, 4(1):167 – 173, 1988.
[2] J. Gorodkin, L. J. Heyer, and G. D. Stormo. Finding the most significant common sequence
and structure motifs in a set of RNA sequences. Nucleic Acids Res., 25:3724–3732, 1997.
Hofacker: Vienna RNA Web Services 5
[3] I. L. Hofacker, M. Fekete, C. Flamm, M. A. Huynen, S. Rauscher, P. E. Stolorz, and P. F.
Stadler. Automatic detection of conserved RNA structure elements in complete RNA virus
genomes. Nucl. Acids Res., 26:3825–3836, 1998.
[4] I. L. Hofacker, M. Fekete, and P. F. Stadler. Secondary structure prediction for aligned RNA
sequences. J. Mol. Biol., 319:1059–1066, 2002.
[5] I. L. Hofacker, W. Fontana, P. F. Stadler, S. Bonhoeffer, M. Tacker, and P. Schuster. Fast
folding and comparison of RNA secondary structures. Monatsh. Chem., 125:167–188, 1994.
[6] V. Juan and C. Wilson. RNA secondary structure prediction based on free energy and phylo-
genetic analysis. J. Mol. Biol., 289(4):935–947, 1999.
[7] B. Knudsen and J. Hein. RNA secondary structure prediction using stochastic context-free
grammars and evolutionary history. Bioinformatics, 15:446–454, 1999.
[8] R. Lu¨ck, S. Graf, and G. Steger. ConStruct: a tool for thermodynamic controlled prediction of
conserved secondary structure. Nucl. Acids. Res., 27:4208–4217, 1999.
[9] D. Mathews, J. Sabina, M. Zucker, and H. Turner. Expanded sequence dependence of ther-
modynamic parameters provides robust prediction of RNA secondary structure. J. Mol. Biol.,
288:911–940, 1999.
[10] J. S. McCaskill. The equilibrium partition function and base pair binding probabilities for RNA
secondary structure. Biopolymers, 29:1105–1119, 1990.
[11] J. SantaLucia Jr. A unified view of polymer, dumbbell, and oligonucleotide DNA nearest-
neighbor thermodynamics. Proc. Natl. Acad. Sci., USA, 95:1460–1465, 1998.
[12] P. Schuster, W. Fontana, P. F. Stadler, and I. L. Hofacker. From sequences to shapes and back:
A case study in RNA secondary structures. Proc. Royal Society London B, 255:279–284, 1994.
[13] S. Wuchty, W. Fontana, I. L. Hofacker, and P. Schuster. Complete suboptimal folding of RNA
and the stability of secondary structures. Biopolymers, 49:145–165, 1999.
[14] M. Zuker. The use of dynamic programming algorithms in RNA secondary structure prediction.
In M. S. Waterman, editor, Mathematical Methods for DNA Sequences, pages 159–184. CRC
Press, 1989.
[15] M. Zuker and A. B. Jacobson. “Well-determined” regions in RNA secondary structure predic-
tion: analysis of small subunit ribosomal RNA. Nucl. Acids Res., 23:2791–2798, 1995.
[16] M. Zuker and P. Stiegler. Optimal computer folding of larger RNA sequences using thermody-
namics and auxiliary information. Nucl. Acids Res., 9:133–148, 1981.
