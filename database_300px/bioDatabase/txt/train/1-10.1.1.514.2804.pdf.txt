Probability density functions of hydraulic head and
velocity in three-dimensional heterogeneous porous media
Wolfgang Nowak,1,2 Ronnie L. Schwede,3 Olaf A. Cirpka,3 and Insa Neuweiler1,4
Received 27 July 2007; revised 16 April 2008; accepted 29 April 2008; published 30 August 2008.
[1] In this study, we assess probability density functions of hydraulic heads and specific
discharges in three-dimensional bounded heterogeneous porous media by Monte Carlo
(MC) simulation. We discuss their empirical shapes and demonstrate that the intuitive
use of obvious information on boundedness leads to parametric distribution functions,
which fit surprisingly well. On the basis of statistical moments of hydraulic heads and
velocities up to fourth order, we discuss the spatial dependence of the empirical
distributions and their dependence on the variance of log conductivity. Comparison of
the first and second central moment to the results from classical numerical first-order
second-moment (FOSM) analysis reveals that FOSM predicts these moments surprisingly
close for hydraulic heads. On the basis of this fact, we demonstrate that fitting the
chosen parametric distributions for hydraulic heads to FOSM moments is promising for
the sake of estimating exceedance probabilities. Our MC scenarios vary in variance of log
conductivity (0.125 to 5.0), in the type of multivariate dependence, in correlation scale
and types of boundary conditions. Our study illustrates that in contrast to the common
assumption, FOSM is a reasonable choice for evaluating multivariate and univariate
moments for heads, if used in conjunction with additional information on distribution
shapes. In the absence of utilizable additional information, we demonstrate that second-
moment methods are mostly inadequate for assessing distributions accurately. Significant
deviations from Gaussian distributions occurred for discharge components even at a
variance of log conductivity as low as 0.125, and we found that the distributions of
transverse discharge components are extremely fat-tailed. The observed non-Gaussianity
questions the results of approximate approaches in solute flux and dispersion studies
where velocity fields are assumed to be multi-Gaussian and then directly represented by or
generated from their covariances. The main implication is to apply more accurate schemes
such as exact non-local methods, extensive MC or higher-order stochastic Galerkin
approaches, and to include higher-order moments, at least if no additional assumptions on
the shape of distributions are available or justifiable.
Citation: Nowak, W., R. L. Schwede, O. A. Cirpka, and I. Neuweiler (2008), Probability density functions of hydraulic head and
velocity in three-dimensional heterogeneous porous media, Water Resour. Res., 44, W08452, doi:10.1029/2007WR006383.
1. Introduction
[2] Most stochastic analyses of flow in heterogeneous
porous media evaluate first and second stochastic moments
of flow-related variables and mainly differ in the order of
approximation or level of accuracy. First-order second-
moment analysis (FOSM) is a conceptually simple and
computationally quick way to approximate mean values
and variances of dependent quantities in stochastic differ-
ential equations such as the stochastic flow equation. One
particular strength of numerically based FOSM methods is
their ability to handle arbitrary domain geometries, arbitrary
boundary conditions and arbitrary trends in the conductivity
field [e.g., Kitanidis, 1997, pp. 196]. When cleverly exploit-
ing problem geometries, using the adjoint-state sensitivity
method [Sun, 1994] and FFT-based methods for handling
stationary or intrinsic covariance functions [e.g., Nowak et
al., 2003; Cirpka and Nowak, 2004], FOSM methods
outrun most other numerical methods while being concep-
tually simple. This holds especially when stochastic
moments at only a few locations are required.
[3] The mathematics quickly become quite intractable
beyond first-order second-moment analysis. Still, there is
a list of studies that account for higher-order effects in the
stochastic flow equation when assessing first and second
moments. For an overview of analytical perturbation and
expansion methods, we refer to the books of Rubin [2003]
and Zhang [2002].
[4] The restriction to bounded domains with arbitrary
boundary conditions reduces the number of available ana-
1Institute of Hydraulic Engineering (LH2), Universita¨t Stuttgart,
Stuttgart, Germany.
2Civil and Environmental Engineering, University of California,
Berkeley, California, USA.
3Water Resources and Drinking Water, Swiss Federal Institute of Aquatic
Science and Technology (Eawag), Du¨bendorf, Switzerland.
4Institute for Fluid Mechanics, Leibniz Universita¨t Hannover, Hannover,
Germany.
Copyright 2008 by the American Geophysical Union.
0043-1397/08/2007WR006383$09.00
W08452
WATER RESOURCES RESEARCH, VOL. 44, W08452, doi:10.1029/2007WR006383, 2008
Click
Here
for
Full
Article
1 of 15
lytical results [e.g., Paleologos et al., 1996] for the stochas-
tic flow problem. Available numerical methods include
exact non-local formalisms for solving the stochastic mo-
ment equations [e.g., Guadagnini and Neuman, 1999],
higher-order perturbation approaches based on polynomial
expansion [e.g., Chaudhuri and Sekhar, 2005], combina-
tions of polynomial expansions with Karhunen-Loeve
expansions of the conductivity field [e.g., Zhang and Lu,
2004; Lu and Zhang, 2004] or stochastic Galerkin proce-
dures invoking the concept of polynomial chaos or the
Askey scheme together with the Karhunen-Loeve expansion
[e.g., Ghanem, 1998; Xiu and Karniadakis, 2002; Matthies
and Keese, 2005]. Most of these methods, with their
polynomial expansions truncated at first order and with no
further significant approximations in the representation of
the random field (no significant truncation of the Karhunen-
Loeve expansion) converge toward traditional FOSM at a
similar computational complexity and with comparable
results.
[5] In spite of the large range of numerical methods,
studies that deal with moments of third order or higher are
hard to find. As a matter of fact, the authors are not aware of
any analytical expressions for skewness and kurtosis of flow
variables in the literature. Only in a very recent study, Li
and Zhang [2007] discuss the reconstruction of probability
density functions from higher-order stochastic expansion
approaches by sampling methods.
[6] In absence of higher-order moments and better
knowledge, the most common explicit or implicit assump-
tion that accompanies second-moment analysis is that the
analyzed quantities obey univariate or multivariate normal
distributions, which constitutes a maximum-entropy as-
sumption on the distribution shape. For example, Cvetkovic
et al. [1992] and Dentz et al. [2002, 2003] perform Monte
Carlo (MC) studies with velocity fields directly generated
from their first-order covariances in order to examine the
large-time limits of ensemble dispersion, local-scale disper-
sion and other transport-related quantities without having to
solve the flow equation repeatedly.
[7] Mostly, however, log conductivity is assumed to be
Gaussian, so that the independent parameter used in the
flow equation is lognormal instead of normal to begin with.
Although the groundwater flow equation reveals a linear
relationship between heads and source terms, the relation-
ship between log conductivity and heads is well known to
be non-linear. This results in non-Gaussian statistical dis-
tributions of both hydraulic heads or velocities, especially
for cases with a high variance of log conductivity: For
example, the increasing skewness and kurtosis of velocity
components with increasing field variance of log conduc-
tivity has been demonstrated by Englert et al. [2006]. We
suspect that ignorance of higher-order moments and/or of
the actual distribution shape may have severe consequences
for the accuracy of macro-transport theory, stochastic sys-
tem analyses or design tasks under uncertainty.
[8] For example, the evaluation of exceedance probabil-
ities in risk assessment and stochastic design requires
assumptions or knowledge of the actual shape of distribu-
tions. Assuming the normal distribution to obtain confi-
dence intervals from second moments may be highly
inaccurate if the actual distribution differs significantly from
the normal. In some cases, however, workarounds may be
found. To give an example, Cirpka et al. [2004] deal with
the stochastic design of funnel and gate systems. They
argued that mass flux capture efficiencies of funnel and
gate systems are designed close to their physical maximum
of 100%, hence have asymmetric bounds and thus are
heavily tailed toward smaller values, following an otherwise
unknown distribution shape. To evade this problem, they
hypothesized that stream function values at the plume and at
gate edges follow a quasi-Gaussian distribution since they
are sufficiently far from any physical bounds. Then, they
used their statistics in their design procedure. Unfortunately,
such workarounds to find adequate pseudo Gaussian vari-
ables with almost-linear relations to the uncertain parame-
ters are available in very few cases only.
[9] Amid general higher-order effects that cause non-
Gaussian behavior of dependent quantities, there are at least
two distinct ones that affect the shape of distributions: First,
the physical requirement of non-negativity constitutes a
one-sided bound for some dependent quantities. The spe-
cific discharge, for example, is practically non-negative in
the direction of mean flow in all but the unlikely case that
high-contrast structures in conductivity lead to a local
reversal of flow. Second, boundary conditions may cause
the range of admissible values to be bounded. For example,
hydraulic heads between two Dirichlet boundaries in ab-
sence of recharge and discharge are bounded to the interval
between the fixed-head values at the boundaries. A compa-
rable behavior is that solute concentrations are bounded
between zero and some initial or fixed concentration value,
as has been demonstrated by Caroni and Fiorotto [2005].
[10] We expect the distribution shapes of flow-related
quantities to depend on the vicinity to a restricting bound-
ary, and hence on space in general. This change in distri-
bution shape is accompanied by well-studied effects such as
the dependence of variance on the distance to the bound-
aries in bounded domains [e.g., Paleologos et al., 1996;
Zhang and Winter, 1999]. In order to investigate these
effects and the distance to Gaussianity in this study, we
evaluate empirical probability density functions for all
quantities of interest. We do this on a dense grid of
observation locations in order to visualize and quantify
the spatial dependence of distribution shapes. Fitting para-
metric distributions that honor boundedness to these empir-
ical distributions is quite tempting, and we demonstrate how
close an intuitive choice of parametric distributions can get
to the empirical distributions. The spatial change of distri-
bution shapes is also visualized by plotting empirical
higher-order stochastic moments in space.
[11] Englert et al. [2006] provide an excellent overview
over the large number of recent three-dimensional Monte
Carlo studies on stochastic flow, which we summarized here
in brief. The Monte Carlos studies by Dykaar and Kitanidis
[1992] and Englert et al. [2006] use low numbers of
realizations (nr  10), but resolve their domains finely with
more than 107 elements, so that they can obtain stochastic
moments by spatial averaging of statistics through invoking
the principle of ergodicity. Other authors such as Naff et al.
[1998] or Neuman et al. [1992] use higher numbers of
realizations with nr = 900 and nr = 500, respectively.
[12] For the purpose of evaluating space-dependent em-
pirical probability density functions, however, a much
higher number of realizations is required. Most of all,
2 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
simple spatial averaging is not applicable since it would
destroy the desired spatial information. In our study, we use
nr = 25,000 realizations. For an adequate spatial resolution
at bearable computational costs, we choose a spatial reso-
lution by 2.5  105 elements in each realization. In order
to improve the convergence of our MC results, we define
the horizontal transverse direction to be periodic. In this
case, all statistics are invariant with respect to translation in
y, and we apply averaging of statistics along that direction
without destroying spatial information along the other
directions.
[13] Besides assessing the spatial dependence of distri-
bution shapes and the distance to Gaussianity, we also
assess how good first-order second-moment (FOSM)
approximations to the mean and variance of distributions
are, compared to empirical moments from Monte Carlo
analysis (MC). We will demonstrate that, in some cases,
these two moments are approximated sufficiently close by
FOSM techniques. Subsequently, we hypothesize paramet-
ric distributions that honor external knowledge on bound-
edness and match them with the FOSM-based moments to
again test the closeness of the resulting fit.
[14] The analysis of empirical distributions, fitting para-
metric distributions and matching with FOSM-based
moments is performed for a set of Monte Carlo scenarios
which differ in the variance of log conductivity. We repeat
the same analysis for a second set of Monte Carlo scenarios
which focuses on the influence of spatially connected
extreme values, using the transformed fields introduced by
Zinn and Harvey [2003]. Additional investigations deal
with different boundary conditions, and with more or less
ergodic domains. All of these scenarios use a constant
anisotropy ratio of the random conductivity fields.
2. Methods
2.1. Simulation of Flow
[15] Specific discharge q [LT1] = (qx, qy, qz) in a porous
medium is defined by Darcy’s law:
q ¼ Krf ð1Þ
in which K [LT1] is the hydraulic conductivity, here
assumed isotropic on the local scale, and f [L] is the
hydraulic head. Total discharge is denoted by Qx [L
3T1].
Under steady-state conditions without internal sources and
sinks, mass conservation yields the steady-state groundwater
flow equation:
r 	 Krfð Þ ¼ 0 in W
n 	 Krfð Þ ¼ q^ on @Wno
f ¼ f^ on @WD
ð2Þ
with W and @W = @Wno [ @WD denoting the domain and its
boundary, which we have restricted to Dirichlet and no-flow
conditions for the greatest part of our simulations. f^ is a
prescribed head function, q^ is a prescribed flux function (set to
zero in most simulations) and n is the unit normal outward
vector. We implemented a vectorized Standard Galerkin
Finite Element Method (FEM) code specialized to regular
grids and a tailored geometric multigrid PCG solver [e.g.,
Press et al., 1992] in MATLAB (R2006b) to efficiently
discretize and solve the flow equation (equation 2) inO(ng log
ng), ng being the number of grid nodes. The FEM code used
cuboidal elements with trilinear interpolation for f and
element-wise constant values ofK. FEM-consistent velocities
are non-conforming across element edges. Preferring con-
sistent velocities over non-conforming techniques (such as
discussed by Cordes and Kinzelbach [1992]), we restricted
our stochastic analyses to consistently evaluated specific
discharge components at element centers.
[16] Our flow domain is three-dimensional, sized Lx 
Ly  Lz = 100 m  50 m  25 m. We chose periodic
boundary conditions along the y-direction (for reasons
explained in section 2.3), while the z-direction boundaries
were assigned no-flow conditions. The x-direction, being our
direction of mean flow, was assigned to have Dirichlet
boundaries with a head difference of Df = 1 m, satisfying
the required periodicity in y-direction. The domain was
discretized by 80  64  48 elements (ne = 245,760) with
ng = 257,985 nodes to fit the coarsening procedure of our
solver. One flow simulation took an average of 8 multigrid
PCG iteration steps and 26 seconds with a relative error norm
L2 = 10
10, running on a contemporary desktop computer.
2.2. Generation of Random Log Conductivity Fields
[17] We consider second-order stationary fields of Y = ln
K with known mean Y . The fields are multivariate
Gaussian with anisotropic exponential or spherical covari-
ance functions:
CYY ;exp hð Þ ¼ s2Y 	 exp hð Þ ð3Þ
CYY ;sph hð Þ ¼
s2Y 	 1
3
2
h
hr
 1
2
h3
h3r
 
for 0  h  hr
0 for h > hr
8><
>: ð4Þ
where sY
2 is the variance, hr[] is the spherical range
parameter, and h[] is the (anisotropic) effective separation
distance scaled by the correlation length scales li[L], i = 1,
2, 3:
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃX3
i¼1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
h2i =l
2
i þ d2
q
 d
 2vuut ð5Þ
Here d[] is a microscale (smoothing) parameter relative to
li [Kitanidis, 1997], and hi is the separation vector
component in direction i. Because conductivity is not
defined on arbitrarily small scales, it is justified to define it
smooth on the local scale, like the moving average of a
noisy sub-scale process. The microscale parameter d acts
like a microscale filter on the generated random fields. It
also reduces fine-scale stochastic noise in all dependent
quantities, improving the convergence of our MC results.
[18] A second type of random fields is obtained from
multivariate Gaussian fields Y by the bijective transformation:
Y ð Þ ¼ Y 
ﬃﬃﬃ
2
p
erf1 2erf
Y 0j jﬃﬃﬃ
2
p
 
 1
 
ð6Þ
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
3 of 15
W08452
as described by Zinn and Harvey [2003], in which Y0 = Y 
Y and j 	 j is the absolute value. This transformation
maintains univariate Gaussianity, but installs a more
complex multivariate structure: Y(+) has inclusions of high
values in a connected low-value background and Y() has
low-value inclusions in a connected high-value background.
Prior to transformation, Y has low and high-value inclusions
in a connected mean-value background. The transformation
also changes the correlation structure and therefore requires
the correlation length to be multiplied by a factor of 5/8 to
install the same integral scale of the transformed fields as in
the base case scenarios. All random conductivity fields were
generated to be periodic along the y-direction, matching
with the periodic boundary conditions of the flow equation.
We implemented the FFT-based fast and exact random field
generator by Dietrich and Newsam [1993], taking less than
one second per realization on our computer.
2.3. Monte Carlo Analysis
[19] Our MC scenarios differ in variance of log conduc-
tivity within the range of 0.125  sY2  5, in the type of
multivariate dependence, correlation scale and boundary
conditions. A complete list of scenarios and statistical
properties of the corresponding random conductivity fields
is shown in Table 1. The correlation length scales are
deliberately chosen to be relatively large compared to the
domain size in order to observe well-pronounced boundary
effects over large parts of the computational domain.
Scenario 13 served as a more ergodic case for comparison.
[20] We consider the following random variables: log
conductivity Y = ln K, hydraulic head f, specific discharge
components qx, qy and qz, and total discharge Qx. In our
analysis, we normalized these quantities:
f* ¼ f=Df
qi* ¼ qi= KeI0ð Þ; for i ¼ x; y; z
Qx* ¼ Qx= KeI0Að Þ
ð7Þ
where Df is the head difference between the Dirichlet
boundaries. For normalization, we used the effective hy-
draulic conductivity for isotropic media, Ke = exp(Y + sY
2/6)
[e.g., Gelhar and Axness, 1983; King, 1987], the mean
hydraulic gradient I0 = Df/Lx, and the cross-sectional Area
A. After normalization, Q*x should be unity for an ergodic
and isotropic domain. We are aware that scaling with
exp(sY
2/6) is valid for statistically isotropic and ergodic
media only [e.g., Rubin, 2003], but we still use it in our
anisotropic non-ergodic case as approximate scaling. The
numerical value of Ke in each realization is the isotropic
ergodic theoretical value for Ke corrected by the respective
value of Q*x, and the empirical ensemble expectation of Ke is
the theoretical Ke times the empirical ensemble mean of
Q*x.
[21] For each random variable s = {Y, f*, q*x, q*y, q*z, Q*x}
we recorded finely resolved histograms with relative fre-
quencies fs:
fs x;Ccð Þ ¼ 1
nr
Xnr
r¼1
I Lc < sr xð Þ  Ucð Þ ð8Þ
sampled on a 21  17  13 grid of locations x (every fourth
node in each direction) with bin index c, bin center Cc,
lower and upper bin limits Lc and Uc, constant bin width
and an auto-adaptive number of classes initially set to nc =
200. I( 	 ) is an indicator function that returns a value of
unity if the condition specified inside the brackets is true,
and zero otherwise. Of course, Q*x has no space dependence.
In order to better resolve, visualize and discuss spatial
trends in the behavior of space variables, we assessed the
following empirical statistics on the entire finite element
grid:
ms xð Þ ¼
1
nr
Xnr
r¼1
sr xð Þ ð9Þ
s2s xð Þ ¼
1
nr  1ð Þ
Xnr
r¼1
sr xð Þ  ms xð Þð Þ2 ð10Þ
gs xð Þ ¼
nr
nr  1ð Þ nr  2ð Þ
Xnr
r¼1
sr xð Þ  ms xð Þ
ss xð Þ
 3
ð11Þ
hs xð Þ ¼
nr nr þ 1ð Þ
nr  1ð Þ nr  2ð Þ nr  3ð Þ
Xnr
r¼1
sr xð Þ  ms xð Þ
ss xð Þ
 4
 3 nr  1ð Þ
2
nr  2ð Þ nr  3ð Þ ð12Þ
where ms, ss
2, gs and hs are estimators of the ensemble mean,
variance, skewness and kurtosis, respectively, x is the
location, and ms, ss
2 are unbiased. The definition of kurtosis
used here is also known as kurtosis excess, where the
Gaussian distribution has a kurtosis of zero.
[22] The effect of periodicity in y-direction is that all
statistics are invariant with respect to y, so all statistics can
be averaged along the y-axis without loss of spatial infor-
mation. This significantly improves the efficiency and
Table 1. Definition of Monte Carlo Scenariosa
No. sY
2 (lx, ly, lz) [m] Miscellaneous
1 0.125 (10, 20, 5) -
2 0.25 (10, 20, 5) -
3 0.5 (10, 20, 5) -
4 1.0 (10, 20, 5) -
5 1.75 (10, 20, 5) -
6 2.5 (10, 20, 5) -
7 3.75 (10, 20, 5) -
8 5.0 (10, 20, 5) -
9 2.5 (10, 20, 5) 	 5
8
Y(+)
10 2.5 (10, 20, 5) 	 5
8
Y()
11 2.5 (10, 20, 5) Neumann BC
12 2.5 (10, 20, 5) linear C(h) (fractal)
13 2.5 (10, 20, 5) 	 1
2
(closer to ergodicity)
aUnless stated otherwise, domain size is L[m] = (100  50  25),
random field type is multi-Gaussian, covariance model is exponential, using
the specified field variance sY
2 and correlation length scales lx, lx and lz.
Y(+) and Y() indicate transformed fields according to equation (6) [Zinn and
Harvey, 2003]. The scale factor of 5/8 maintains the integral scale of the
transformed fields. In all cases, the microscale parameter is d = 0.25, the
discretization is ne = [80  64  48] and the number of realizations is nr =
25,000.
4 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
accuracy of our analysis. We perform this averaging in a
post-processing step so that we can compare the moments
before and after averaging. The Monte Carlo code was
implemented in MATLAB and directly coupled to the
random field generator and the FEM modules to obtain all
statistics on-the-fly. The total average CPU-time per reali-
zation was at about 55 seconds.
[23] For a small number of reference locations, we kept
all simulation data to check convergence using jackknife
methods [e.g. Wonnacott and Wonnacott, 1990]. For relative
frequencies we assume the binomial distribution with n = nr
and p = fs/nr for each bin, which is asymptotically exact for
large nc and large nr. Hence histogram counters have a
coefficient of variation of CV = (nrfs)
1/2, e.g., CV = 0.02
for a histogram bin with relative frequency of fs = 10%. The
statistics of Y were used to assure the exactness of the
random field generator. Further aspects of convergence are
discussed at the end of section 3.1.
2.4. First-Order Second-Moment Analysis
[24] For comparison to the stochastic moments from MC
analysis, we perform first-order second-moment analysis to
yield approximate mean values, variances and covariances
of all dependent random variables s. To evaluate the
expected value of all dependent variables, we use the
zero-order approximation obtained by solving the flow
equation with the homogeneous value of Kg = exp(Y ). For
variances and covariances, we linearized the flow equation
about Kg using a Jacobian matrix Hs derived from adjoint-
state sensitivities (see Appendix A):
Hs : Hjk ¼
@s xj
 
@Y xkð Þ ; k ¼ 1; . . . ; ne ð13Þ
The advantage of adjoint-state sensitivities over direct
numerical differentiation is that only one differential equa-
tion (which is formally identical to the flow equation in our
case) needs to be solved to obtain Hs for one dependent
variable at one location of xj, regardless of the number of
elements ne.
[25] In this study, unlike in practical applications, we
wish to evaluate the moments of the state variables at all
locations xj in the domain. Exploiting symmetry of the
problem and periodicity in y-direction, only 1025 positions
xj were required to cover the sensitivities of all values of
one variable with respect to all values of ln K (the lower left
41  25 quarter of the x, z plane at an arbitrary y-position).
With only one sensitivity of Qx with respect to Y, this totaled
5126 adjoint-state problems for all dependent variables
(1025 for f, qx, qy and qz each, plus one for Qx).
[26] Given the sensitivities H and an auto-covariance
matrix CYY of Y = ln K evaluated according to equations
(3) or (4), linear error propagation yields the cross-cova-
riances between Y and dependent variables s and auto-
covariances of dependent variables s:
CYs ¼ CYYHT ð14Þ
Css ¼ HCYYHT ð15Þ
The space-dependent variance of a dependent variable s can
directly be read from the diagonal of Css. In order to
efficiently evaluate equations (14) and (15), we use fast
and exact spectral methods for multiplication of covariance
matrices as described by Nowak et al. [2003].
2.5. Fitting Parametric Distributions
[27] We restrict most of our analyses of random flow
variables to two-parameter probability distributions, since
their parameters could be directly inferred from first and
second stochastic moments, if desired. In absence of any
other information than first and second moments, the max-
imum-entropy univariate probability density function (pdf)
that satisfies these moments is the Gaussian. However,
physical properties of an observed system may imply bound-
edness of a stochastic variable, suggesting to apply other
parametric distributions. A simple two-parameter distribu-
tion that honors non-negativity is the lognormal distribution,
and a two-parameter distribution that honors two-sided
boundedness is the beta-distribution with support of [0; 1].
The corresponding probability density functions, mean val-
ues and variances are provided in Table 2. For properties of
these distributions, see article by Evans et al. [2000]. For
some quantities, we will also make use of the family of
exponential power distributions, which includes the Laplace
and the Gaussian distributions as special cases for k = 1 and
Table 2. Selected Two-Parameter and Three-Parameter Probability Density Functions p(s), Their Mean Values ms and Their Variances
ss
2B(	) is the Beta-Function and G(	) is the Gamma-Function [e.g., Evans et al., 2000]
Name pdf p(s) Mean ms Higher Moments (ss
2, hs)
Gaussian
1ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2pb2
p 	 exp  s að Þ
2
2b2
 !
a ss
2 = bs
2
Lognormal
1
s 	
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2pb2
p 	 exp  1
2
ln s að Þ2
b2
 !
exp (a +
b2
2
) ss
2 =
exp b2ð Þ  1
exp 2a b2Þð
Beta
1
B a; bð Þ 	 s
a1(1  s)b1 a
aþ b ss
2 =
ab
aþ bð Þ2 aþ bþ 1ð Þ
Laplace
1
2b
	 exp( s aj j
b
) a ss
2 = 2b2
Exponential power
1
2bG 1þ 1=kð Þ 	 exp 
s aj jk
bk
 !
a s2s ¼
b2
3
G 1þ 3=kð Þ
G 1þ 1=kð Þ
hs ¼
9
5
G 1þ 5=kð ÞG 1þ 1=kð Þ
G2 1þ 3=kð Þ
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
5 of 15
W08452
k = 2, respectively. The corresponding moments have been
taken from integral tables [Abramowitz and Stegun, 1972].
[28] In order to fit these parametric distributions ps(a, b, k)
(k is only required for the exponential distribution family) to
the histograms obtained from the MC analysis, we used
maximum-likelihood estimation (MLE) [e.g., Law and
Kelton, 1992]. The MLE parameters (a, b, k) of a chosen
parametric distribution maximize the log likelihood log L for
observing an empirical histogram when sampling from the
respective parametric distribution:
log L fs;Cc; a; b; kð Þ
¼
Xnc
c¼1
fcnr log p Cc; a; b; kð Þð Þ ! max ð16Þ
We fitted the same parametric distributions ps to the moments
obtained from our FOSM or MC analysis by matching the
moments (MM). For this purpose, we rearranged the expres-
sions for mean and variance provided in Table 2 for the
parameters (a, b, k).
[29] The quality of fitting between parametric distribu-
tions ps and empirical curves fs from our histogram analysis
was assessed using a one-sided c2 hypothesis test on a a =
5% significance level based on the test statistic
c2test ¼
Xnc
c¼1
DPs Ccð Þ  fs Ccð Þð Þ2
s2err
ð17Þ
where DPs is the portion of the parametric distribution
falling into the respective histogram bin. Because we do not
expect our empirical choice of parametric distributions to be
exact, we set
s2err ¼ DPs Ccð Þ þ eerr 	DP2s Ccð Þ ð18Þ
The first term corresponds to the standard c2-test for
distribution fitting. Without further modification, given
the high number of realizations used in our analyses, the
histograms would have to almost exactly resemble the
tested parametric shapes in order to pass the test. Hence we
use the additional relative error eerr in order to allow a slight
model misfit between parametric and empirical curves, here
subjectively chosen to be eerr = 0.01. A fit is rejected if
ctest
2 > ch,1a
2 . ch,1a
2 is the 1  a quantile of the c2-
distribution with h = nc  np degrees of freedom, np is the
number of fitted parameters in ps and nc is the number of
classes.
[30] Later we will see that we encounter many fat-tailed
distributions (i.e., with a kurtosis greater than the Gaussian,
h > 0), so we are concerned about the quality of fit in the
tails. While the c2-test is good to check the quality of fit
between histogram and parametric distributions, it would
not detect insignificant but systematic mis-estimation of
distribution tails. Insignificant but systematic mis-estima-
tion may sum up in cumulative distribution functions to
significant mismatches of the far tails. To test for this type of
misfit, we additionally apply the Kolmogorov-Smirnov (KS)
test, where the absolute deviation between cumulative fre-
quencies and the cumulative distribution function is assessed:
KStest ¼ sup Fs sð Þ  Ps sð Þj j : s 2 Rð Þ ð19Þ
Here Fs are the cumulative relative histogram frequencies
from our MC analysis and Ps are the corresponding
cumulative probabilities of the fitted parametric distribu-
tions. The critical value of the test statistic for nr > 35 is
given by
KScrit ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
 1
2nr
ln
a
2
 r
ð20Þ
with a significance level of a = 5%. We again expect (and
are willing to accept) a model error of the fitted parametric
distributions on top of the pure statistical noise considered
by the standard KS-test. Therefore we subtract an extra 1%
model error (chosen subjectively) from the value of KStest
before evaluating the test criterion. Hence, if a fitted curve
passes this modified KS-test, the corresponding cumulative
density function does not differ from the empirical one by
more than 1% except for statistical noise.
3. Results and Discussion
3.1. Spatial Dependence of Distribution Shapes
[31] Per definition of our domain setup and MC scenar-
ios, all statistics are invariant along the y-direction. In
general, the z-direction will show less variation than the x-
direction. This implies that, apart from their role in defining
the mean flow direction, lateral boundaries are less influ-
ential on the space dependence of stochastic heads and
velocities. In order to visualize the spatial dependence of the
histograms along the x-direction, we plot empirical proba-
bility densities along the centerline of the domain. For a
better overview of spatial dependence in all directions, we
also plot empirical stochastic moments in space. In the
following, we discuss these results for all variables of
interest.
[32] Figures 1 and 2 show these plots (empirical proba-
bility densities and moments, respectively) for normalized
hydraulic heads f*. The Dirichlet boundary conditions for
head restrict the values of normalized head to a range
between zero and unity. This causes the shape of its
distribution to be similar to the beta distribution, where
the mean exhibits the expected linear trend along the
direction of mean flow. The variance is forced to zero at
the boundaries because of the Dirichlet boundary condition
Figure 1. Evolution of the empirical probability density of
normalized hydraulic head f* = f/Df on the centerline
along the main direction of flow for scenario 6 (sY
2 = 2.5).
6 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
and increases toward the center of the domain [e.g., Zhang
and Winter, 1999]. The restriction of values to the interval
of [0; 1] forces the distribution to be asymmetrical close to
the boundaries, leading to a negative skewness near the
inflow boundary and to a positive skewness near the
outflow boundary. Close to the center of the domain,
the distribution is almost Gaussian: the asymmetrical
boundary influence vanishes if the distribution is far from
the interval boundaries, so that both skewness and kurtosis
approach values of zero. As a consequence, for smaller
variances of log K, the region where a Gaussian distribution
prevails and passes the corresponding fitting tests has a
larger extent than for larger variances. As an empirical rule
of thumb based on this behavior, we suggest to trust the
Gaussian shape at all locations in the domain where the
bounding Dirichlet values are at least three standard devia-
tions away from the mean value, i.e., when the 99%
confidence interval of the assumed Gaussian is not cut off.
[33] The spatial dependence in the statistics of q*x, q*y and
q*z is less pronounced by far (see Figure 3). The empirical
pdf of the normalized longitudinal discharge component q*x
is similar to a lognormal distribution with almost no spatial
dependence along the x-axis. The empirical pdf for the
normalized vertical discharge component q*z along the main
direction of flow is shown in the bottom part of Figure 3.
There seems to be no change in the distribution near the
boundaries except for a smaller variance, which is caused
by the prescribed pressure isosurface at the upstream and
downstream boundaries. If we had evaluated velocities at
nodes instead of at element centers, the variance would be
exactly zero at x = 0 and x = 100. The distribution of q*y
looks almost identical to that of q*z and is not shown here.
The transverse components have conspicuously long and fat
tails, which are not representable by a Gaussian distribution.
The tails have been cut off in Figure 3. For example, q*y had
Figure 2. Empirical statistical moments (mean m, variance
s2, skewness g and kurtosis h) of normalized hydraulic
heads f* = f/Df for MC scenario 6 (sY
2 = 2.5). Left:
averaged along the y-direction, right: prior to averaging.
Figure 3. Evolution of the empirical probability densities
of normalized longitudinal and transverse vertical discharge
components q*x(z) = qx(z)/(KeI0) on the centerline along the
main direction of flow for scenario 6 (sY
2 = 2.5).
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
7 of 15
W08452
quantiles of Q90% = 0.31, Q99% = 1.6, Q99.9% = 4.2,
Q99.99% = 8.8, and had its maximum observed value at
q*y = 117.7.
[34] As a consequence of the lateral no-flow boundary
conditions at the top and the bottom of the domain, there is
a slight focusing of the mean z-component to the mid-level
(z = 0.5Lz) of the domain, and a strong but thin focus area of
the x-component along the top and bottom boundaries, as
can be seen from Figure 4. The general pattern in the
variance of discharge components (Figure 5) shows al-
most-zero variance of q*y and q*z at the upstream and
downstream boundaries, almost-zero variance of q*z at the
top and bottom no-flow boundaries. There is a cor-
responding increase of variances in q*x and q*y at the top
and bottom of the domain because vertical discharge close
to the no-flow boundaries is redirected into horizontal
directions. As already discussed and demonstrated by many
authors, the variances of the specific discharge components
are influenced by the boundaries only in a region that is
thinner than one correlation length [e.g., Englert et al.,
2006; Rubin, 2003; Zhang, 2002]. Higher-order features of
the distributions of discharge components (not shown here)
hardly depend on location, but depend heavily on the
variance of ln K, as discussed in the next section. Skewness
and kurtosis are increasing toward the boundaries for all
quantities. For discharge components, this happens within a
region as thin as one correlation length, making the sto-
chastic problem seemingly more non-linear within these
regions.
[35] Figures 2, 4 and 5 show the moments averaged along
the y-direction in the left halves of the domain, and prior to
averaging in the right halves. The distributions of f* are
very well-behaved with a relatively small variance com-
pared to their spatial trends (especially close to the Dirichlet
boundaries); hence their moments are virtually free of noise
before averaging. This is entirely different for the moments
of discharge components: Because of the fat and long tails
of their distributions and their relatively large variational
coefficients, the impact of few but very extreme realizations
on the statistics is substantial (increasing with order of the
moments), and nr = 25,000 is insufficient to obtain satis-
factory moments prior to averaging. Only after averaging
along the y-direction are the mean and variance sufficiently
free of noise to our satisfaction. The higher-order moments
of discharge components, especially those of the transverse
ones, are noisy even after this averaging and yield robust
values only for larger volume averages including the other
Figure 4. Empirical mean m of normalized discharge
components q*i = qi/(KeI0) for scenario 6 (sY
2 = 2.5). Left:
averaged along the y-direction, right: prior to averaging.
Figure 5. Empirical variance s2 of normalized discharge
components q*i = qi/(KeI0) for scenario 6 (sY
2 = 2.5). Left:
averaged along the y-direction, right: prior to averaging.
8 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
dimensions. The degree of convergence of our MC analysis
for stochastic moments is shown in Figure 6 as 95%
confidence intervals. The values and confidence intervals
in Figure 6 have been computed for point values of f* and
for volume averages of q*i averaged over a pseudo-station-
ary volume taking 1/8 of the domain, as also in the articles
by Dykaar and Kitanidis [1992] and Englert et al. [2006].
For fully resolved three-dimensional moments or instation-
ary covariances between flow variables in bounded
domains, we must recommend vastly higher numbers of
realizations.
3.2. Dependence of Distribution Shapes on the
Variance of log K
[36] The shapes of the empirical distributions depend
heavily on the variance sY
2 of log conductivity. Figure 7
shows a set of empirical distributions at specific locations
for sY
2 differing in the range from sY
2 = 0.125 to sY
2 = 5. It
also shows maximum-likelihood fitted parametric distribu-
tions. The parametric distributions are chosen to honor
physical restrictions like non-negativity or two-sided
boundedness.
[37] For hydraulic heads f*, we show results at the
location (x, y, z) = (0.8Lx, 0.5Ly, 0.5Lz) in Figure 7 (top).
This position, being off-center in the x-direction, evidently
demonstrates how the boundedness of admissible values for
f* is becoming increasingly important with increasing sY
2,
inducing an asymmetrical distribution as head fluctuations
approach the restricting boundary value. The gradual
change from a Gaussian distribution to a highly skewed
one is quite obvious. Since the Dirichlet boundary condi-
tions lead to the same effect near the outflow boundary, we
hypothesize a behavior similar to the beta-distribution (see
Table 2). The corresponding maximum-likelihood fit of beta
distributions to the set of empirical distributions is shown as
solid lines, revealing an almost suspiciously tight fit. Nei-
ther the c2 test according to equation (17) nor the KS test
according to equation (19) rejected this hypothesis for any
of the tested curves shown here. Small-variance cases with
Gaussian distributions are covered by the beta distribution
since it asymptotically approaches the Gaussian for ss
2! 0.
Only in regions close to the boundary (not shown here) at
high variances (sY
2  2.5) was the fitted beta distribution
rejected by both tests.
[38] For a variance of 1/12 and a mean value of 0.5, the
beta-distribution is identical to the uniform distribution on
[0; 1]. This is the limiting case for unimodal distributions
(with mean value of one half) of all distributions bounded
between zero and unity. Higher values inevitably lead to
bimodal distributions, regardless of the actual distribution
shape. Hence values of s2(f*) > 1/12 at the domain center
with m(f*) = 0.5 will lead to bimodal distributions of f*.
Such a high variance of f*, however, did not appear within
the observed range of sY
2. We assume that the limiting case
for sY
2 ! 1 between two Dirichlet boundaries is the
uniform distribution for heads.
[39] The statistics of all components of discharge do not
vary over the largest part of the domain. Hence we discuss
the location in the center of the domain. The longitudinal
component q*x of the specific discharge (Figure 7, upper
middle) is non-negative, if high-contrast structures in con-
ductivity do not lead to a local reversal of flow. In our MC
analysis, we could not observe negative values of q*x for any
Figure 6. Dependence of empirical mean values ms,
standard deviation ss, skewness gs and kurtosis hs on sY
2
for heads f* (off-center), specific discharge q*x (center of
domain) and specific discharge q*y (center of domain) and
total discharge Q*x. X marks, black: empirical values with
95% confidence intervals for multi-Gaussian fields (MC
scenarios 1–8). Diamonds, gray: for high-K inclusions
(Y(+), MC 9). Circles, gray: for low-K inclusions (Y(), MC
10). Dotted black line: FOSM predictions. Solid gray line:
FOSM scaled with exp(sY
2 /6).
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
9 of 15
W08452
value of sY
2 to any significant extent (see more detailed
discussion below). This restriction to nonnegative values
leads to skewed distributions for higher values of sY
2.
Hypothesizing and fitting the lognormal distribution is only
natural, and the ML-fitted lognormal distributions in
Figure 7 match very well. The assumption of lognormal
longitudinal velocities has already been used in the literature
as an assumption, for example, in solute flux studies by
Dagan et al. [1992] and Cvetkovic et al. [1992].
[40] For small-variance cases, one expects a Gaussian
distribution of q*x. These cases are also covered by the
lognormal distribution since it approaches the Gaussian for
ss
2/ms
2 ! 0. High-variance cases reveal a tendency to a
heavier tailing behavior than the lognormal distribution
(outside the plotted scale), but still no fitted curves were
rejected anywhere in the domain. Surprisingly enough, the
skewness is clearly visible and significant even for the case
of sY
2 = 0.125. One must conclude that a quasi-linear
relation between perturbations of log conductivity and
perturbations of discharge holds only for very low values
of sY
2, apparently still smaller than the minimum value of
sY
2 = 0.125 considered in this study. Hence a lognormal
distribution should be used for qx for all values of sY
2.
[41] Vanderborght et al. [1998] have found an additional
tailing behavior of longitudinal velocities toward smaller
values in a study on solute flux in unsaturated heteroge-
neous soil. In their study, this tailing became apparent when
plotting the log-velocity cdf in percentile-percentile plots
with normal scale. They concluded that assuming lognormal
distributions for qx leads to an underrepresentation of
almost-stagnant regions, affecting studies on solute flux.
For variances of sY
2  3.75, we occasionally observed
reversal of flow at almost stagnant values of velocities in
overall negligibly small areas of the domain. Other than
that, we did not find evidence for excessive left tails of qx in
saturated media in the cases investigated in our study.
Englert et al. [2006] have reported locally reversed flow
in a Monte Carlo study in saturated heterogeneous media
above sY
2 = 3 and list several past studies which have found
similar phenomena. They explain local flow reversal by
tortuous S-shaped high-conductivity regions. This phenom-
enon was more significant in their study probably because
they used larger, more ergodic domains where the forcing
influence of the boundary conditions was more remote than
in our study.
[42] Figure 7 (lower middle) shows the distribution of q*y.
It also represents the transverse component q*z which hardly
differs from this one in its distribution shape. Both distri-
butions are symmetric about zero because the admissible
range of values is not restricted and the domain setup is
symmetric along the y and z planes. However, the non-
linearity of the stochastic problem leads to extremely heavy
tailing for higher sY
2. Apparently, a parametric distribution
with an additional shape parameter is required, allowing to
control the heaviness of tailing. We found the exponential
power family (see Table 2) a suitable candidate. The
corresponding ML-fitted exponential power distributions
show sufficient agreement to not fail the c2-test and the
KS-test, although it is obvious that just one shape parameter
is insufficient to closely match the empirical distributions.
The exponential power family again includes the Gaussian
as special case for k = 2 and is more peaked (i.e., has a
positive kurtosis and hence longer tails) for k < 2. For higher
variance, the fitted curves get close to the pass/fail limit,
which is mostly because of their inadequately pronounced
peak at s = 0. However, the tailing behavior is reproduced
Figure 7. Maximum-likelihood fit of parametric distribu-
tions (solid lines) to the empirical distribution (marks) for
heads f* (off-center), specific discharge q*x (center of
domain) and specific discharge q*y (center of domain,
symmetric about q*y = 0) and total discharge Q*x in MC
scenarios with different sY
2.
10 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
nicely. Since the statistics of q*y and q*z hardly change within
our domain, no fitted curves in the entire domain were
rejected.
[43] Figure 7 (bottom) shows the distribution of total
discharge Q*x. The histogram is more noisy than that of q*x
since the averaging of statistics over the periodic y-direction
does not apply here. The fact that Q*x has a non-zero
variance is a consequence of the bounded and non-ergodic
domain. Thanks to the central limit theorem, however, its
distribution is tighter and more Gaussian than that of q*x. For
the same reasons as for q*x, we fit a lognormal distribution.
The resulting curves showed an extremely good agreement
and were not rejected for any value of sY
2.
3.3. Deviations From Linear Stochastic Theory With
Variance of ln K
[44] In order to quantify the deviations from linear
stochastic theory, we visualize descriptive parameters of
the empirical distributions as a function of sY
2 in Figure 6.
These are the mean, standard deviation (instead of variance
for better plot scaling), skewness and kurtosis observed at
the same locations as the histograms discussed above. Here
the non-linearity of the flow problem is manifested in two
phenomena: first, the gradual transition of the empirical
distributions from Gaussian to other shapes. For Gaussian
distributions, the skewness g and kurtosis h are always zero,
so that any non-zero value indicates a non-Gaussian distri-
bution. Second, there are deviations of the empirical mean
and variance from the values predicted by linear stochastic
theory, here represented by our FOSM analysis.
[45] Hydraulic head f* at (x, y, z) = (0.8Lx, 0.5Ly, 0.5Lz),
shown in Figure 6 (top) convey a clear picture: the mean
value changes a bit with increasing sY
2. This change is
related to a higher hydraulic gradient within a relaxation
layer up to about one correlation length away from the
boundary. It is statistically significant, but otherwise mostly
negligible. The variance of heads increases slightly but
significantly less than linearly with sY
2, but the deviation
from linear stochastic theory seem to be irrelevant up to
sY
2 = 2.5. Because of the off-center position at x = 0.8Lx, the
skewness rises with increasing sY
2, like it was to be expected
from Figure 7 (top). For kurtosis, there are two super-
imposed competing effects: for non-central positions, kur-
tosis rises as the bounding value imposed by the closer
boundary produces a distinct tail toward adverse values. For
rather broad distributions, the bounding values imposed by
both Dirichlet boundary conditions take effect and restrict
both tails, enforcing a less peaked and rather uniform
distribution with a decreasing kurtosis. In rather central
positions, only the latter effect prevails, leading to strictly
negative values. At the non-central position shown here, the
first effect leads to the initial increase of kurtosis, while the
second one leads to an attenuation of kurtosis for high
values of sY
2. If a consistent way to describe the skewness
and kurtosis effects can be found that is satisfied with the
mean and variance as input information, we hypothesize
that using the mean and variance from FOSM analysis is
sufficient to fully describe the distribution of heads. This
hypothesis will be investigated in the next section.
[46] The moments of q*x in Figure 6 (upper middle) show
two main effects: First, the mean grows faster than predicted
by the effective hydraulic conductivity for infinite isotropic
media, Ke = exp(Y + sY
2/6) (solid gray line). This phenom-
enon is no surprise: (1) there is an increased probability of
continuous highly permeable paths connecting the inflow to
the outflow boundary in bounded domains, and (2) anisot-
ropy aligned with the direction of mean flow increases the
effective conductivity even in infinite domains. General-
izations to anisotropic and bounded domains have been
developed [e.g., Paleologos et al., 1996] and agree with the
effect observed here. Likewise, the boundedness of the
domain increases the variance of q*x more than expected.
This consequence, however, has not been quantified in
analytical expressions in the literature up-to-date. The
second effect shown by the moments of q*x is that the
pronounced asymmetry and the extreme upper tailing
strongly increase with sY
2. This clearly demonstrates that
the Gaussian distribution is inadequate for the longitudinal
component of specific discharge.
[47] Q*x shows a quite similar behavior as q*x: the mean
has the exact same increase with sY
2. The dependence of sQ,
skewness and kurtosis on sY
2 is the same as that of q*x but for
apparent factors of roughly 1/4, 1/5 and 1/50 (given our
specific geometry and degree of non-ergodicity), respec-
tively. We attribute this tendency to a more Gaussian
distribution with a smaller variance to the fact that Q*x is
the spatial average of qx over W and the central limit
theorem. For more ergodic domains, we observed an even
more Gaussian shape with even smaller variance. At the
ergodic limit, the variance is known to vanish. The even-
order moments of transverse discharge components (here:
q*y) are almost identical to those of q*x, but symmetry sets the
odd moments (mean and skewness) to zero.
[48] Altogether, first-order theory performs quite poor for
discharge, especially for sY
2 > 0.5, but deviations from
Gaussianity are apparent even at sY
2 = 0.125. When using
low-order approximations of discharge in conjunction with
Gaussian distributions (e.g., in the context of risk assess-
ment, for assessing solute mass fluxes or for evaluating
dispersivities in heterogeneous porous media), the heavy
tails and the inaccuracy of first-order mean values and
variances imply that higher-order statistics (including
higher-order moments) of transport processes and the reli-
ability of first-order approaches for larger values of sY
2 need
to be investigated further. Quite interestingly, Bellin et al.
[1992] found that different errors in linearizing flow and
transport compensate for each other so that dispersivities
derived from linear theory are sufficiently accurate even up
to sY
2 = 1.6.
3.4. Using First-Order Second-Moment
Approximations
[49] In order to asses the utility of FOSM-based
moments, we employ the method of moment matching in
conjunction with the parametric distributions used above.
For hydraulic heads, Figure 8 (top) illustrates that combin-
ing FOSM with the intuitively chosen beta distribution
delivers surprisingly good results. Only in the high-variance
cases with sY
2  2.5 are the moment-matched curves
rejected. This rejection is mainly because of the inexact
behavior at the lower bounding value which originates from
a slightly too high value for the variance. If we had used the
Gaussian distribution instead, the results would have been a
lot less encouraging: only up to sY
2 = 0.25 is the skewness of
the empirical distribution sufficiently small to fit with a
Gaussian one.
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
11 of 15
W08452
[50] For discharge components, the picture is less cheery. It
is obvious from Figure 6 and the related discussion that the
Gaussian shape will be a poor approximation in almost any
case, and that FOSM-based moments are quite frustratingly
poor. All curve fitting attempts based on FOSM moments,
regardless of using the Gaussian or other parametric distri-
butions, failed in the c2- and theKS-test. Since the lognormal
distribution q*x and Q*x has been shown to be a reliable model
for the pdf shape, higher-order accurate values for mean and
variance are sufficient. The exponential power distribution
for q*y and q*z requires at least a variance and a kurtosis
(assuming the mean value to be zero) in order to be fitted,
calling out for higher-order stochastic moments.
[51] Hence, instead of matching with FOSM moments,
we demonstrate the advantage of having higher-order
moments or higher-order expressions for mean and variance
available by using our MC-based moments. Figure 8 (mid-
dle) shows the lognormal distribution for q*x with MC-based
values for the mean and variance. All c2-tests pass but the
for case of sY
2 = 2.5. This single misfit seems to be an effect
of statistical noise for the curves close to the pass/fail limit
for high values of sY
2. The KS-test fails only for high
variances sY
2  2.5. Higher-order analytical expressions
for the mean and variance of longitudinal velocities are
available and have been tested by Englert et al. [2006] in a
Monte Carlo study.
[52] The comparison of curves from the exponential
power family with empirical distributions for the transverse
discharge components is shown in Figure 8 (bottom), based
on MC-based values of the variance and kurtosis. The misfit
of the pronounced peak at q*y = 0 is a rather local
phenomenon, whereas the tails are fitting well over a large
range. None of them was rejected by the c2 test, but some
were just above the pass/fail limit in the KS-test due to their
extreme peak at q*y = 0. Unfortunately, we could not find
analytical expressions for higher-order moments of flow
variables in the literature.
3.5. Special Cases
[53] Up to here, the generated random conductivity fields
were multi-Gaussian. The non-linear transformation of
Gaussian fields according to equation (6) leads to (1)
inclusions of high-conductivity material (denoted by Y(+))
with a connected low-permeable background or to (2)
inclusions of low-conductivity material (denoted by Y())
embedded in a connected highly permeable background
(used in MC scenarios 9 and 10, respectively). Connectivity
of extreme materials is known to lead to cumbersome
effects in solute transport or in variably saturated flow, as
has been discussed by Zinn and Harvey [2003], Neuweiler
and Cirpka [2005], and Neuweiler and Vogel [2007]. In
Figure 9, we compare empirical distributions of heads and
discharge for Y(+), Y() to those in plain multi-Gaussian
fields for reference, each for sY
2 = 2.5. A comparison of the
statistical moments is included in Figure 6.
[54] We first discuss the effect of low-conductivity inclu-
sions (Y()) with a connected backbone of preferential flow
paths. The latter term is borrowed from multiphase flow, but
seems to be graphically descriptive for the resulting flow
patterns. While ‘‘path’’ applies to 2D fields, where the
connected regions form tortuous lines, the term ‘‘skin’’ is
more appropriate for three-dimensional domains, where the
connected material resides around the inclusions in skin-like
layers. For sufficiently high sY
2, the inclusions can be
regarded as dead zones of essentially stagnant water.
[55] From looking at heads in Figure 9 (top), the back-
bone obviously has an equilibrating effect on pressure, since
the heads are much more clustered about their mean value,
spoiling the good fit of the beta-distribution. This is
measurable in a decreased variance and an increased kur-
tosis in Figure 6. For q*x, hardly any effect is visible in
Figure 9 (upper middle). An increased mean value and
variance of q*x (see Figure 6) is caused by a heavier and
longer tail of extremely high velocities, which is not within
the scale of Figure 9. Given the structure of stagnant regions
nerved with preferential flow skins, a higher variance and
mean value was to be expected. With the ratio between
skewness and variance changed, the lognormal distribution
is rejected. For transverse directions, here represented by q*y,
the flow following the tortuous backbones leads to in-
Figure 8. Comparison of parametric distributions obtained
from moment matching, using moments from first-order
second-moment or Monte Carlo analysis (solid lines) versus
empirical distributions for head f* and discharge compo-
nents q*x and q*y in MC scenarios with different sY
2 (marks).
12 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
creased local deviations from the mean flow direction, in-
creasing the variance through fatter and longer tails (again
outside the scale of this plot). Because of the connectivity of
high-conductivity paths, the total dischargeQ*x also rises, the
peakedness of the empirical shape is decreased, and the
lognormal distribution is rejected. Altogether, the connected
highly permeablematerial seems to adversely affect the fitting
of the curves which matched well in the multi-Gaussian case.
[56] The case of high-conductivity inclusions (Y(+)) leads
to a connected network of low-permeably skins that try to
prevent the high-permeable regions from participating in
flow. Since the thickness of these skins is small, the highly
permeable inclusions are still being flown through, and the
effect of connectivity on the flow variables is less pro-
nounced by far. As a matter of fact, the mean total discharge
does not significantly differ from that for multi-Gaussian
fields (see Figure 6), although one would intuitively expect
a drastic decrease in effective conductivity. These findings
are incompatible to recent findings for variably saturated
flow [e.g., Neuweiler and Cirpka, 2005], where connected
fine-material skins are those regions which maintain a
higher saturation during drainage and form a flow-active
network when coarse material is already close to residual
saturation and hence almost impermeable. Altogether, the
fitted curves are better than in the case of low-conductivity
inclusions (Y()). Especially the ML-fitting is successful in
all cases, but the moment-matched distributions are rejected
in all cases but for q*x.
[57] The remaining MC scenarios 11–13 listed in Table 1
are not discussed in detail since they merely confirm
expected phenomena:
[58] (1) If the Dirichlet inflow boundary is replaced by a
Neumann boundary, hydraulic heads only have a one-sided
bound. This makes them nonnegative but not restricted
toward high values. The resulting hypothesized parametric
distribution is the lognormal one. The lognormal distribu-
tion fits very well and is rejected nowhere in the domain.
[59] (2) For a linear covariance function (approximated
by a spherical one with the range parameter hr adjusted so
that the range is at least two times the domain length in each
direction), there is variability on all scales. The resulting
fields are effectively less ergodic and the variance of all
quantities rises, while the mean total discharge increases.
[60] (3) For smaller correlation length scales, keeping the
domain size constant, the opposite effect applies.
4. Summary and Conclusions
[61] In this study, we have performed an extensive Monte
Carlo analysis for hydraulic heads and discharge components
in three-dimensional bounded and heterogeneous domains.
The empirical probability distributions of heads and veloci-
ties are extremely non-Gaussian even for smaller variances of
log conductivity. For the case of discharge, even sY
2 = 0.125
lead to obviously different distribution shapes.
[62] By accounting for bounds of the distributions imposed
by the boundary conditions of the flow problem, we intui-
tively found parametric distributions which fit the stochastic
flow variables surprisingly well. For example, hydraulic
heads without recharge obey the beta-distribution very well
if they lie between twoDirichlet boundaries, and closely meet
the lognormal distribution between a Dirichlet and a Neu-
mann boundary. The longitudinal discharge component was
Figure 9. Maximum-likelihood (ML) fit of parametric
distributions (solid and dash-dotted lines) to the empirical
distribution (marks) for heads f* (off-center), specific
discharge q*x (center of domain) and specific discharge q*y
(center of domain) and total discharge Q*x in MC scenarios
with different connectivity features for sY
2 = 2.5. Marks:
empirical distributions. Solid/dashed lines: ML fits. Dotted
line: FOSM-based moment matching (FOMM, identical for
all Y() and Y(+)) or MC-based moment matching (MCMM,
different for Y() and Y(+)).
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
13 of 15
W08452
lognormal in all cases, and transverse components showed
extremely heavy and long tailing, fitting the exponential
power distribution with powers between 0.4 and 2. Using
transformed fields with connectivity of highly permeable or
hardly permeable material leads to more peculiar empirical
distributions and heavily impaired the fitting.
[63] These findings let us judge the application of linear
methods quite skeptically. In absence of better information,
i.e., when only second moments are available or if the
boundary conditions do not allow an intuitive choice of
distributions that honor non-negativity or two-sided bounded-
ness, the picture is quite poor. Especially the tailing behavior of
transverse discharge components has the potential to affect
studies on transverse dispersivities that assumemulti-Gaussian
distributions of velocities. Also, for the sake of risk assessment
or stochastic design, distribution shapes need to be assumed in
order to estimate exceedance probabilities. In absence of
higher-order moments from higher-order accurate methods
or knowledge of empirical distribution shapes, exceedance
probabilities based on the assumption of Gaussianity will lead
to highly erroneous results.
[64] We tested how good mean values and variances
based on numerical first-order second-moment (FOSM)
analysis are when using them in conjunction with the
intuitively chosen parametric distributions that we found
to fit the empirical ones. This analysis revealed that for
hydraulic heads, FOSM-based moments are a powerful tool
if used together with adequate parametric distributions. For
the case of discharge components, FOSM-based moments
performed too poorly for the moment-matching approach to
succeed. Instead, we showed that higher-order accurate
moments beyond the mean value and variance (here taken
from our MC analysis) would suffice to obtain the same
success for discharge components.
[65] In the case presented here, the simple geometry and
boundary conditions offer a good support for choosing
parametric distributions, and a few lower moments suffice
to determine a well-fitting distribution. The main implica-
tion of this study is to use this intuitive but highly valuable
information, if available. Unfortunately, information on
non-negativity or two-sided boundedness will not always
be available or applicable for complicated domain geome-
tries with less trivial boundary conditions. Then, only direct
evaluation of probability density functions or the conversion
of higher-order moments to probability density functions
[e.g., Blinnikov and Moessner, 1998] would help to avoid
the application of brute-force Monte Carlo techniques. In
the introduction, we have listed a number of studies that
discuss higher-order accurate approaches to the stochastic
flow problem. Ironically, although some of these methods
can even be arbitrarily exact, none of the authors have
implemented moments of orders higher than the variance.
[66] The second implication of this study is to further
advance these methods toward higher-order moments or the
direct evaluation of probability distributions, as has been
done by Li and Zhang [2007]. When using Monte Carlo
methods for higher-order moments of discharge in bounded
domains (without exploiting ergodicity), numbers of real-
izations far above our nr = 25,000 will have to be used
because of the extremely long and fat tails of transverse
discharge components. We expect, most of all, stochastic
Galerkin methods to be offer a sufficiently flexible alterna-
tive tool in this context. The order of approximation,
however, will have to be sufficiently high to meet at least
the moments up to fourth order accurately.
Appendix A: Adjoint-State Sensitivities
[67] The evaluation of auto- and cross-covariances of
dependent quantities in equations (14) and (15) require
sensitivities as given by equation (13). We evaluate the
sensitivities using the continuous adjoint-state method [e.g.,
Sun, 1994], linearized about the zeroth-order (homogeneous)
solution ~f(x) using ~K(x) = Kg. For each sensitivity, we solve
one adjoint-state equation. The adjoint state yfj of f
observed at location xj is [e.g., Cirpka and Kitanidis, 2001]:
r 	 ~Kryfj
  ¼ d xj  in W
n 	 ~Kryfj
  ¼ 0 on @Wno
yfj ¼ 0 on @WD
ðA1Þ
where d(xj) is the Dirac delta function at the location of
observation. For specific discharge, adjoint-state sensitivities
have not been reported in literature yet. For this study, we have
developed a corresponding adjoint-state equation given by:
r 	 ~Kryqij
  ¼ r 	 eid xj ~K  in W
n 	 ~Kryqij
  ¼ 0 on @Wno
yqij ¼ 0 on @WD
ðA2Þ
where ei is the unit vector in direction of the desired discharge
component and
r 	 eid xj
   ¼ @
@xi
d xj
  ðA3Þ
is a Dirac dipole at the location of observation. Weighted with
~K, this resembles the partial derivative of discharge with
respect to heads. For the total discharge, we have developed
an adjoint state yQx identical to the equation for f with
reversed Dirichlet boundary values:
r 	 ~KryQx
  ¼ 0 in W
n 	 ~KryQx
  ¼ 0 on @Wno
yQx ¼ f^ on @WD
ðA4Þ
Given solutions to these adjoint-state equations (using the
same numerical scheme as for the original governing equa-
tions), the sensitivities of a dependent variable s (f, qi andQx)
observed at location xj with respect to piecewise constant
values Yk within sub-volumes Wk (here: FEM grid cells with
element center xk) are given by:
Hf
 
jk
¼ @f xj
 
@Yk
¼ 
Z
Wk
~K r~f 	 ryfj
  
dW;
Hqi
 
jk
¼ @qi xj
 
@Yk
¼ 
Z
Wk
~K r~f 	 ryqij þ eid xj
   
dW
HQx
 
k
¼ @Qx
@Yk
¼ 
Z
Wk
~K r~f 	 ryQx
  
dW
ðA5Þ
These integrals can be evaluated using analytical solutions of
the element stiffness matrix (and related quantities) for all
14 of 15
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY W08452
sub-volumes Wk in one simultaneous third-order tensor
multiplication [Nowak, 2005].
[68] Acknowledgments. This study has been funded by Deutsche
Forschungsgemeinschaft under grant Ne 824/3-1. Additional funding has
been provided by the Swiss National Science Foundation under grant
200021-109169/1. We thank the anonymous reviewers for their construc-
tive comments.
References
Abramowitz, M., and I. A. Stegun (1972), Handbook of Mathematical
Functions with Formulas, Graphs, and Mathematical Tables, 9th print-
ing, Dover, New York.
Bellin, A., P. Salandin, and A. Rinaldo (1992), Simulation of dispersion in
heterogeneous porous formations: Statistics, first-order theories, conver-
gence of computations, Water Resour. Res., 28(9), 2211–2227.
Blinnikov, S., and R. Moessner (1998), Expansions for nearly Gaussian
distributions, Astron. Astrophys., Suppl. Ser., 130, 193–205.
Caroni, E., and V. Fiorotto (2005), Analysis of concentration as sampled in
natural aquifers, Trans. Porous Med., 59, 19–45, doi:10.107/s11242-004-
1119-x.
Chaudhuri, A., and M. Sekhar (2005), Stochastic finite element method for
the probabilistic analysis of flow and transport in a three-dimensional
heterogeneous porous formation, Water Resour. Res., 41, W09404,
doi:10.1029/2004WR003844.
Cirpka, O. A., and P. K. Kitanidis (2001), Sensitivity of temporal moments
calculated by the adjoint-state method, and joint inversing of head and
tracer data, Adv. Water Resour., 24(1), 89–103.
Cirpka, O. A., and W. Nowak (2004), First-order variance of travel time in
non-stationary formations, Water Resour. Res., 40, W03507,
doi:10.1029/2003WR002851.
Cirpka, O. A., C. M. Bu¨rger, W. Nowak, and M. Finkel (2004), Uncertainty
and data worth analysis for the hydraulic design of funnel-and-gate sys-
tems in heterogeneous aquifers, Water Resour. Res., 40, W11502,
doi:10.1029/2004WR003352.
Cordes, C., and W. Kinzelbach (1992), Continuous groundwater velocity
fields and path lines in linear, bilinear, and trilinear finite elements,Water
Resour. Res., 28(11), 2903–2911.
Cvetkovic, A., A. M. Shapiro, and G. Dagan (1992), A solute flux approach
to transport in heterogeneous formations: 2. Uncertainty analysis, Water
Resour. Res., 28(5), 1377–1388, doi:10.1029/91WR03085.
Dagan, G., V. Cvetkovic, and A. M. Shapiro (1992), A solute flux approach
to transport in heterogeneous formations: 1. The general framework,
Water Resour. Res., 28(5), 1369–1376.
Dentz, M., H. Kinzelbach, S. Attinger, and W. Kinzelbach (2002),
Temporal behaviour of a solute cloud in a heterogeneous porous med-
ium: 3. Numerical simulations, Water Resour. Res., 38(7), 1118,
doi:10.1029/2001WR000436.
Dentz, M., H. Kinzelbach, S. Attinger, and W. Kinzelbach (2003), Numer-
ical studies of the transport behavior of a passive solute in a two-dimen-
sional incompressible random flow field, Phys. Rev. E, 67(4), 046,306,
doi:10.1103/PhysRevE.67.046306.
Dietrich, C. R., and G. N. Newsam (1993), A fast and exact method for
multidimensional Gaussian stochastic simulations, Water Resour. Res.,
29(8), 2861–2869.
Dykaar, B. B., and P. K. Kitanidis (1992), Determination of the effective
hydraulic conductivity for heterogeneous porous media using a numerical
spectral approach: 1. Method, Water Resour. Res., 28(4), 1155–1166.
Englert, A., J. Vanderborght, and H. Vereecken (2006), Prediction of velo-
city statistics in three-dimensional multi-Gaussian hydraulic conductivity
fields, Water Resour. Res., 42, W03418, doi:10.1029/2005WR004014.
Evans, M., N. Hastings, and B. Peacock (2000), Statistical Distributions,
3rd ed., John Wiley & Sons, Inc., New York.
Gelhar, L. W., and C. L. Axness (1983), Three-dimensional stochastic
analysis of macrodispersion in aquifers, Water Resour. Res., 19(1),
161–180.
Ghanem, R. (1998), Scales of fluctuation and the propagation of uncertainty
in random porous media, Water Resour. Res., 34(9), 2123–2136.
Guadagnini, A., and S. P. Neuman (1999), Nonlocal and localized analyses
of conditional mean steady state flow in bounded, randomly nonuniform
domains: 1. Theory and computational approach, Water Resour. Res.,
35(10), 2999–3018.
King, P. (1987), The use of field theoretic methods for the study of flow in a
heterogeneous porous medium, J. Phys. A, 20, 3935–3947.
Kitanidis, P. K. (1997), Introduction to Geostatistics, Cambridge Univ.
Press, Cambridge, U.K.
Law, A. M., and W. D. Kelton (1992), Simulation modeling and analysis,
McGraw-Hill, New York.
Li, H., and D. Zhang (2007), Probabilistic collocation method for flow in
porous media: Comparisons with other stochastic methods, Water Re-
sour. Res., 43, W09409, doi:10.1029/2006WR005673.
Lu, Z., and D. Zhang (2004), A comparative study on uncertainty quanti-
fication for flow in randomly heterogeneous media using Monte Carlo
simulations and conventional and KL-based moment-equation ap-
proaches, SIAM J. Sci. Comput., 26(2), 558–577.
Matthies, H. G., andA.Keese (2005), Galerkinmethods for linear and nonlinear
elliptic stochastic partial differential equations,Comput.Methods Appl.Mech.
Eng., 194(12–16), 1295–1331, doi:10.1016/j.cma.2004.05.027.
Naff, R. L., D. F. Haley, and E. A. Sudicky (1998), High-resolutionMonte Carlo
simulation of flow and conservative transport in heterogeneous porousmedia:
1. Methodology and flow results,Water Resour. Res., 34(4), 663–677.
Neuman, S. P., S. Orr, O. Levin, and E. Paleologos (1992), Theory and
high-resolution finite element analysis of 2-D and 3-D effective perme-
abilities in strongly heterogeneous porous media, in Mathematical Mod-
eling in Water Resources, vol. 2, edited by T. F. Russel et al., pp. 118–
136, Elsevier, New York.
Neuweiler, I., and O. A. Cirpka (2005), Homogenization of Richards equa-
tion in permeability fields with different connectivities, Water Resour.
Res., 41, W02009, doi:10.1029/2004WR003329.
Neuweiler, I., and H.-J. Vogel (2007), Upscaling for unsaturated flow for
non-Gaussian heterogeneous porous media, Water Resour. Res., 43,
W03443, doi:10.1029/2005WR004771.
Nowak, W. (2005), Geostatistical methods for the identification of flow and
transport parameters in subsurface flow, Ph.D. thesis, Institut fu¨r Was-
serbau, Universita¨t Stuttgart, http://elib.uni-stuttgart.de/opus/frontdoor.
php?source_opus=2275.
Nowak, W., S. Tenkleve, and O. A. Cirpka (2003), Efficient computation of
linearized cross-covariance and auto-covariance matrices of interdepen-
dent quantities, Math. Geol., 35(1), 53–66.
Paleologos, E. K., S. P. Neuman, and D. Tartakovsky (1996), Effective
hydraulic conductivity of bounded, strongly heterogeneous porous med-
ia, Water Resour. Res., 32(5), 1333–1341.
Press, W. H., B. P. F. S. A. Teukolsky, and W. T. Vetterling (1992), Numer-
ical Recipes: The Art of Scientific Computing, 2nd ed., Cambridge Univ.
Press, Cambridge, U.K.
Rubin, Y. (2003), Applied Stochastic Hydrogeology, Oxford Univ. Press,
Oxford, U.K.
Sun, N.-Z. (1994), Inverse Problems in Groundwater Modeling, Theory
and Applications of Transport in Porous Media, Kluwer Academic Pub-
lishers, Dordrecht, Netherlands.
Vanderborght, J., D. Mallants, and J. Feyen (1998), Solute transport in a
heterogeneous soil for boundary and initial conditions: Evaluation of
first-order approximations, Water Resour. Res., 34(12), 3255–3270.
Wonnacott, R. J., and T. H. Wonnacott (1990), Introductory Statistics, 5th
ed., John Wiley, New York.
Xiu, D., and G. E. Karniadakis (2002), Modeling uncertainty in steady state
diffusion problems via generalizd polynomial chaos, Comput. Methods
Appl. Mech. Eng., 191, 4927–4948.
Zhang, D. (2002), Stochastic Methods for Flow in Porous Media, Aca-
demic Press, San Diego, Calif.
Zhang,D., and Z. Lu (2004), An efficient, higher-order perturbation approach
for flow in random porous media via Karhunen-Loe`ve and polynomial
expansions, J. Comput. Phys., 194, 773–794.
Zhang, J., and C. L.Winter (1999), Moment equation approach to single-phase
fluid flow in heterogeneous reservoirs, Soc. Pet. Eng. J., 4(2), 118–127.
Zinn, B., and C. F. Harvey (2003), When good statistical models of aquifer
heterogeneity go bad: A comparison of flow, dispersion, and mass trans-
fer in connected and multivariate Gaussian hydraulic conductivity fields,
Water Resour. Res., 39(3), 1051, doi:10.1029/2001WR001146.

O. A. Cirpka and R. L. Schwede, Swiss Federal Institute of Aquatic
Science and Technology (Eawag), U¨berlandstr. 133, 8600 Du¨bendorf,
Switzerland. (olaf.cirpka@eawag.ch; ronnie.schwede@eawag.ch)
I. Neuweiler, Institute for Fluid Mechanics, Leibniz Universita¨t Hann-
over, Appelstrasse 9a, 30167 Hannover, Germany. (neuweiler@hydromech.
uni-hannover.de)
W. Nowak, Civil and Environmental Engineering, University of
California at Berkeley, 760 Davis Hall, Berkeley, CA 94708-1710, USA.
(wolfgang.nowak@berkeley.edu)
W08452 NOWAK ET AL.: PROBABILITY DENSITIES OF HYDRAULIC HEAD AND VELOCITY
15 of 15
W08452
