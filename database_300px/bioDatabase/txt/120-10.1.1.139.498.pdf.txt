BIOMETRICS 55, 1-12 
March 1999 
Bayesian Phylogenetic Inference via 
Markov Chain Monte Carlo Methods 
Bob Mau,lI* Michael A. and Bret Larget3 
‘Department of Statistics, University of Wisconsin-Madison, 
1210 West Dayton Street, Madison, Wisconsin 53706-1685, U.S.A. 
2Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison, 
600 Highland Avenue, Madison, Wisconsin 53792, U.S.A. 
3Department of Mathematics and Computer Science, Duquesne University, 
College Hall 440, Pittsburgh, Pennsylvania 15282-1704, U.S.A. 
* emait: Robertm@genetics.wisc.edu 
SUMMARY. We derive a Markov chain to  sample from the posterior distribution for a phylogenetic tree 
given sequence information from the corresponding set of organisms, a stochastic model for these data, and 
a prior distribution on the space of trees. A transformation of the tree into a canonical cophenetic matrix 
form suggests a simple and effective proposal distribution for selecting candidate trees close to the current 
tree in the chain. We illustrate the algorithm with restriction site data on 9 plant species, then extend to 
DNA sequences from 32 species of fish. The algorithm mixes well in both examples from random starting 
trees, generating reproducible estimates and credible sets for the path of evolution. 
KEY WORDS: Cophenetic matrix; Evolution; Metropolis-Hastings algorithm; Phylogeny reconstruction. 
1. Introduction 
“A phylogeny is a branching tree diagram showing the course 
of evolution in a group of organisms” (Felsenstein, 1983, p. 
246). More and more, phylogenetic inference is based on mc- 
lecular data, such as DNA or protein sequences. Given such 
data, life scientists wish to reconstruct the phylogeny whence 
these organisms arose. Their reasons are as diverse as the or- 
ganisms they study. Systematists use the phylogeny to aggre- 
gate organisms into monophyletic groups, or clades, for taxo- 
nomic purposes (hence the generic term tam). For others, the 
phylogeny might be of peripheral importance, yet ignoring 
it can lead to unwarranted conclusions. For example, given 
a phylogeny, comparative biologists interested in the correla- 
tion between continuous character traits in a group of organ- 
isms can correct for dependencies among species (Felsenstein, 
198513). Huelsenbeck and Rannala (1997) discuss a range of 
inferences that rely on the phylogeny. 
Existing reconstruction techniques attempt to find the phy- 
logeny most compatible with the data under consideration. 
Among the more popular methods, one can categorize those 
using distance matrices (e.g., Sokal and Sneath, 1963; Fitch 
and Margoliash, 1967) in numerical taxonomy as clustering 
algorithms, whereas maximum parsimony (Camin and Sokal, 
1965) and maximum likelihood (Felsenstein, 1981, 1983) each 
optimize an objective function on the space of trees. Felsen- 
stein (1988) provides a comprehensive review of traditional 
methods (see also Swofford et al., 1996). 
Phylogenetic inference can also be dichotomized function- 
ally. Maximum likelihood, maximum parsimony, and distance- 
matrix methods are practical for data sets relating many taxa, 
but beyond point estimates these methods do not produce 
valid inferences. Measures of uncertainty rely exclusively on 
computer-intensive and approximate bootstrap analyses 
(Felsenstein, 1985a; Newton 1996). More recently developed 
techniques, such as the phylogenetic invariants of Cavender, 
Felsenstein, and Lake (see Evans and Speed, 1993; Navidi, 
Churchill, and von Haeseler, 1993) and a Bayesian approach 
(Hasegawa and Kishino, 1989; Smouse and Li, 1989; 
Sinsheimer, Lake, and Little, 1996), allow exact inference, 
but mathematical and computational complexity have con- 
strained these methods to  very small problems. 
We elect a Bayesian approach and use Markov chain Monte 
Carlo (MCMC) methods to provide a computationally feasi- 
ble technique that meets practitioners’ demands for more taxa 
while keeping statistical inference on a sound footing, prc- 
vided certain convergence criteria can be adequately demon- 
strated. Individual components comprising our technique can 
be found in the phylogenetic literature: Smouse and Li (1989) 
introduced the Bayesian paradigm, if not the terminology, to 
phylogeny reconstruction. Goldman (1993) uses nonBayesian 
Monte Carlo tests of significance to  assess the adequacy of 
evolutionary models. Griffiths and Tavar6 (1994a, 1994b) con- 
struct special Markov chains to compute likelihoods for ances- 
tral inference. We apply MCMC to sample trees from the joint 
posterior distribution. Hence, measurement of uncertainty in 
1 
2 Biometrics, March 1999 
our optimal tree accompanies tree construction. By contrast, 
other practical methods must first find an optimal tree, gen- 
erate bootstrap samples from the data, and then reestimate 
the tree from each bootstrap sample to address uncertainty 
in their reconstruction. 
This article is organized as follows. Section 2 opens with an 
introduction to the requisite terminology for tree represen- 
tation. Section 3 presents a general stochastic model for the 
evolution of discrete molecular data. Section 4 articulates the 
Bayesian perspective and defines Metropolis-Hastings algo- 
rithms. Section 5 introduces a two-stage proposal distribution 
that randomly selects a canonical ordering of leaf labels, then 
acts on the superdiagonal of the corresponding cophenetic 
matrix. Section 6 describes restriction site data and posits a 
stochastic model for its evolution. MCMC is applied and key 
phylogenetic quantities are analyzed. Section 7 extends our 
method to nucleotide sequence data. Section 8 describes runs 
made with computer-simulated DNA sequence data from our 
model and reconstruction. Finally, we summarize the advan- 
tages of our approach and discuss further extensions to more 
complex models. 
2. Tree Terminology and Representation 
A phylogeny can be viewed abstractly as a rooted binary 
weighted tree. Mathematically, a tree is a connected graph 
(V ,E) ,  with vertex set V and edge set E ,  characterized by 
the absence of cycles. Vertices are classified as terminal nodes 
(also called leaves or tips) if they are connected through a sin- 
gle edge, and internal nodes otherwise, with C and Z denoting 
the respective subsets. In rooted binary trees, each internal 
node has exactly three edges, with the exception of the root 
node p, which has only two edges. The placement of the root 
relative to the leaves determines the direction of time and 
hence ancestry. For each v E V\{p}, there is a unique parent 
node a(v), closer t o  p and connected to v by an edge in E .  
Sample Phylogeny on Seven Taxa 
Leaf 4 7 2 3  6 5 
Labels 
and 
Nodes 
1 
2 
3 
4 
5 
Root Node 6 
Corwscent Levels and Coalescent Times 
Figure 1. Labeled leaf nodes across the top identify pres- 
ent-day taxa. Internal nodes drawn below represent common 
ancestors, with connecting edges indicating lines of descent. 
{ 1,4,7} and {2,3,6} are examples of monophyletic groups 
(or clades), subsets of organisms whose most recent common 
ancestors have no other descendants among the considered 
organisms. 
For expository reasons, we prefer to describe the branching 
pattern of a tree in terms of nodes coalescing or merging back- 
ward in time. Figure 1 illustrates the coalescence structure of 
a seven-taxa example. 
The labeled shape of the tree, determined by which pairs of 
nodes coalesce, is called the tree topology and is equivalent to 
the graph (V, E ) .  The topology can he compactly summarized 
by using parentheses to indicate coalescences. For example, 
the topology in Figure 1 is (((l(4 7))(2(3 6)))5). 
A weighted tree @ is a tree in which each edge has an as- 
sociated positive weight. The time separating a child from 
its parent is its edge weight, called its branch length. Branch 
lengths are the vertical distances between connected nodes in 
Figure 1. The ordering in which merges occur defines coales- 
cent levels, and the corresponding temporal intervals between 
consecutive merges constitute coalescent times. Different or- 
derings of coalescent levels within a particular topology gener- 
ate distinct labeled histories, alternative characterizations of 
shape. We restrict attention to trees having contemporaneous 
tips, called dendograms. Such a tree ?T' can be specified either 
by its topology and branch lengths or by its labeled history 
and coalescent times. The numbers of topologies and labeled 
histories grow rapidly with n, equal to (an-3) x (2n-5)  . . . x 1 
and n! x (n - 1)!/2n-1, respectively (e.g., Felsenstein, 1978). 
For any weighted binary tree with labeled leaf nodes, the 
tree topology and branch lengths are determined by the with- 
in-tree distances between all pairs of leaf nodes (Lapointe and 
Legendre, 1992). Each permutation of the leaf labels generates 
a different n x n symmetric matrix of these distances. In a 
rooted tree in which all leaf nodes are equally distant from 
the root, such matrices are composed of at most n distinct 
entries and are called cophenetic. 
When a tree is displayed as in Figure 1, an arbitrary choice 
is made giving a left-right orientation to the pair of branches 
emanating from each internal node. This action imparts an 
order on the leaf nodes. The collection of 2n-1 orderings de- 
termined in this fashion is called the set of canonical orderings 
for a given tree. A cophenetic matrix with a canonical ordering 
has the desirable property that its superdiagonal (the diage 
nal of the submatrix formed by deleting the first column and 
nth row) contains each distinct nonzero cophenetic distance. 
We call such a cophenetic matrix canonical because its super- 
diagonal completely specifies the tree. One such matrix for the 
sample phylogeny of Figure 1 is realized in Table 1. A conve- 
nient shorthand for the information sufficient to represent the 
tree is {a, a}, where a is a canonical ordering and a denotes 
the times to coalescence between adjacent label pairs in 0. 
Because times to coalescence are one-half the corresponding 
cophenetic distances, a is simply half the superdiagonal in- 
duced by a (for a detailed discussion of cophenetic matrices 
see Lapointe and Legendre, 1991). 
3. A Stochastic Model  for Leaf Data 
Evolution has two components that can be modeled as s t e  
chastic processes: the branching created by speciation and 
extinction to  form a phylogeny, and the propagation of char- 
acters along the branches of that phylogeny. We do not model 
the branching process stochastically, choosing instead to treat 
the phylogeny as a parameter in a model for the propagation 
Bayesian Phylogenetic Inference 3 
Table 1 
A canonical cophenetic matrix f o r  the tree in Figure 
1, with canonical ordering (5 ,7 ,4 ,1 ,2 ,6 ,3 ) .  For 
specificity, coalescent t imes T in Figure 1 are set at 
(0.8,0.3,0.7,0.5,0.9,1.5), yielding a superdiagonal 
(9.4,1.6,4.6,6.4,3.6,2.2). Redundant lower triangular 
entries are suppressed. The  shorthand notation (u, a )  
becomes {(5,7,4,1,2,6,3),(4.7,0.8,2.3,3.2,1.8,1.1)}.  
Canonical ordering 
of leaf labels 5 7 4 1 2 6 3  
5 0 9.4 9.4 9.4 9.4 9.4 9.4 
7 0 1.6 4.6 6.4 6.4 6.4 
4 0 4.6 6.4 6.4 6.4 
1 0 6.4 6.4 6.4 
2 0 3.6 3.6 
6 0 2.2 
3 0 
of data along each lineage. We adopt standard Markov models 
for the second component (Goldman, 1990). 
Typical character data on n taxa can be arranged as an 
n x N matrix, where N is the common number of sites, or 
positions, providing information from each taxa. We consider 
problems where elements of this matrix are discrete charac- 
ters from a finite set D of size d. These data are viewed as a 
present-day snapshot of a realization of a stochastic process 
that has evolved along the branches of an unknown phylogeny *. Modeling is reduced to a single site by assuming that evo- 
lution among sites is independent. 
A stochastic model describes the joint distribution of y = 
{y,, w t V = ZUC} of the historical record at Z and the cur- 
rent status at C for a given site. The ancestral root state yp is 
assigned an initial distribution no on D. Conditionally on yp, 
two continuous-time, D-valued Markov processes emanate in- 
dependently from the root p along the corresponding branches 
of *. As a given process reaches an internal node v, its value 
is recorded as y,. Evolution continues by repeating this mech- 
anism, with conditionally independent Markov processes em- 
anating from every internal node w € Z. Observable y, for 
w E L: are simply the end products of this evolution. Such a 
model for y is specified by the phylogeny @, the initial dis- 
tribution no, and transition probabilities p (y, I yu jv ) ,  tv ,  p). 
Here a(w) is the parent node of w, t ,  is the intervening branch 
length, and p is a parameter vector describing rates of change 
among states in the Markov process for a given branch. We 
consider two particular models in the examples in Sections 
6 and 7. The probability of the particular realization y at a 
given site is 
T O ( Y P )  J-J P(YV I Y U ( , ) > t V I P ) .  (1) 
U E V \ P  
Both dependency between sites and site-specific P’s can be 
incorporated into the model (e.g., Yang, 1996). Specification 
of an initial distribution no should reflect the underlying biol- 
ogy or can be estimated from the observed frequencies in the 
data. 
To calculate the likelihood function from leaf data at mul- 
tiple sites, we must marginalize (1) over all values of the un- 
observed historical record {yu, w E Z} for all sites. Straight 
summation is computationally prohibitive, requiring on the 
order of Ndn calculations. The pruning method for likelihood 
evaluation requires on the order of N d n  computations be- 
cause it takes advantage of the Markov property of the sub- 
stitution model (e.g., Felsenstein, 1983). Pruning produces a 
collection of fragmentary likelihoods, starting from the leaves 
and working recursively to the root, for each site. For each 
leaf w, L,(i) = l[yv = i] for state i E V (1[.] is the indicator 
function). At an internal node v, the conditional probability 
of descendant leaf data given yv = i is 
where u(u) = ~ ( w )  = w. The likelihood function becomes a 
product across sites 
N 
where the superscript denotes root fragmentary likelihoods at 
the Kth site. 
4. The Bayesian Perspective and Metropolis-Hastings 
Algor i thms 
Bayesian analysis requires a prior distribution on the parame- 
ter space of the model. The prior should reflect the scientist’s 
beliefs on how likely particular parameter values are before 
the data have been observed. The posterior distribution n(Q) 
represents the uncertainty about the phylogeny in light of 
new evidence in the sequence data and is proportional to the 
likelihood times the prior distribution. In each example we 
consider, a uniform prior is placed on the finite set of labeled 
histories, and a flat prior density is assumed on a compact 
set of possible coalescent times as well as any propagation 
parameters from the stochastic model. 
For large problems, Monte Carlo techniques might be the 
only effective way to  integrate n(*) so as to obtain poste- 
rior inferences. One such method is the Metropolis-Hastings 
algorithm, in which a transition mechanism proposes a new 
tree @* with density Q(*, iP*) ,  conditional on being at q. 
We subject this draw to a randomized test, accepting it with 
probability 
(3) 
otherwise remaining at Q!. 
The Markov chain *I, Qz,. . . so formed from an initial 
state converges in distribution to n(*) when Q is irre- 
ducible (e.g., Tierney, 1994). The important theoretical point 
is that for almost every realization of the chain, 
i = k o + l  
(4) 
4 Biometries, March 1999 
. .  . .  . .  . .  . .  . .  . .  --  . .   . .  . .  . .  . .  . .   . .  . .  ,  . ,  . .  . .  . .  
. .  . .  . .   . .  . .   
. .  . .  .. .  
. .  
 
. .  .--. 
where f is a function whose expectation is desired. For ex- 
ample, when f is the indicator function of a particular topol- 
ogy, equation (4) means that the empirical relative frequency 
of that topology in the Markov chain converges to  its corre- 
sponding (marginal) posterior probability. Credible sets, the 
Bayesian counterparts of confidence regions, are collections of 
topologies having high relative frequency in the chain. The 
topology with the highest relative frequency is our reported 
reconstruction. 
Some initial sample points are discarded as burn-in (ko > 0 
in (4)) so as to reduce the bias in the Monte Carlo estimates 
(Besag and Green, 1993). We determine burn-in by inspecting 
time-series plots of the log posterior. A difficult problem with 
the implementation of MCMC is to know whether the K used 
to approximate (4) is large enough. If K is too small, then the 
Monte Carlo variance can overwhelm the signal (Geyer, 1992). 
Roughly speaking, a chain is said to mix well if it acts like 
an independent sample. Cowles and Carlin (1996) present a 
survey of convergence diagnostics commonly used to check 
for evidence of poor mixing. Though we emphasize the r e  
producibility of our results from random starts Ql, we also 
analyze univariate statistics from single runs. Such diagnostic 
tools are helpful in ferreting out inefficient samplers but pro- 
vide little insight into finding efficient ones. By considering 
distances in tree space, we have developed an algorithm that 
extends Bayesian analysis to relatively large problems. 
5. A Proposal Distribution for Trees 
We consider a two-stage proposal distribution. The first stage 
randomly selects a canonical representation {g, a} for the cur- 
rent tree Q, whereas the second stage perturbs the compo- 
nents of a. In particular, the first stage Q1 samples one of 
the 2n-' canonical orderings of the current tree by indepen- 
dently flipping a fair coin at each internal node, thus select- 
ing a particular superdiagonal {d, , ,+l  : z = 1 , .  . . .  n - 1) of 
a canonical cophenetic matrix having times to coalescence 
{a ,  = d,,,+1/2}. The second stage Q 2  simultaneously and in- 
dependently modifies the elements of a. Specifically, a t  = I U, 1 ,  
where U, is uniformly distributed on the interval (a ,  -6, a, +6) 
for a tuning constant 6 > 0. The tuning constant determines 
how far one can jump from the current tree and hence can be 
used to  modulate the overall acceptance rate of the chain. 
The reflection of uniform probability mass onto the positive 
line is an efficient way to obtain symmetric proposals near the 
boundary. Symmetry of each component update can be seen 
by inspecting the transition density 
-. 
*, where I[.] is the indicator function and s,y > 0. Regarding the composition Q = ni Q2,i o Q1, the density at a possible 
proposed tree given the current tree equals 
. .   
. .  . .  . .   . .  
. .  
m* . .  
-- 
..... .... 
i i 
The symmetry of Q simplifies (3), making this a Metropolis 
algorithm. 
We illustrate the action of the second stage Q 2  = ni Q2, i  
in a second example, a six-leaved tree represented by (0, a} = 
({(4,6,3,2,  l j 5 ) ,  (2.3,4.6,2.0,4.0,3.4)}. To recover the tree 
from the canonical cophenetic matrix, place the leaf nodes 
along a horizontal axis in their canonical order. From each 
interleaf midpoint, append an internal node below the axis 
a distance equal to the corresponding time to coalescence. 
Working from top to bottom, draw branches from each inter- 
nal node to the nearest parentless nodes to the left and right 
(Figure 2). Newton, Mau, and Larget (1999) discuss this same 
proposal mechanism from a different perspective. 
A candidate phylogeny proposed by Q can differ from the 
current tree both in its labeled history and in its tree topology. 
For example, in Figure 2, when the perpendicular at (3 ,2}  is 
maximally increased while that at (4, 6} is simultaneously 
decreased, a new labeled history is proposed. Significantly, 
when a similar adjustment is made to the perpendiculars at 
{1,5} and {2,1}, a different topology results, with (1) coa- 
lescing with {2,3} instead of ( 5 ) .  Had the canonical ordering 
(4,6,3,2,5,1) been chosen instead, the same realization by Qz 
would have coalesced (5) with {2,3}. 
We now establish irreducibility of Q = Q 2  oQ1. For a given 
permutation of labels, repeated applications of Q 2  clearly al- 
low transit from any superdiagonal {2ai) to any other super- 
diagonal. Hence, it is sufficient to show that Q allows moves 
among any of the n! permutations of labels. A single appli- 
cation of Q1 can move any label to the first position of the 
permutation. Repeated applications of Q2 ensure that 2a1 is 
the largest superdiagonal element, corresponding to a tree in 
which that first label is connected to the root by one long 
branch. Another application of Q1 allows us to place any re- 
maining label into the second position while fixing the first 
by choosing the current branch orientation at the root node. 
Successive applications of Qz yield a superdiagonal in which 
a1 > a2 > ai,  i > 2, so that the second label coalesces di- 
rectly into the penultimate internal node. By continuing the 
process we are able to move to any permutation. Hence, Q is 
irreducible. 
6. An Example with Binary Data 
Sytsma and Gottlieb (1986) studied the evolutionary relation- 
ships among nine species of the genus Clarkia, plants indige- 
4 6 3 2 1 5 
- 
Figure 2. Candidate trees, attainable from the current tree, 
are characterized by intervals of size 26, centered at the cur- 
rent internal nodes, that constrain the repositioning of the 
internal nodes. 
Bayesian Phylogenetic Inference 5 
nous to California. These botanists extracted chloroplast DNA 
(cpDNA) from the leaves of a young plant of each species and 
exposed that cpDNA to 29 restriction enzymes. A restric- 
tion enzyme acts on DNA by physically cutting the molecule 
wherever it recognizes a particular base pattern. At each po- 
sition on the genome where a cut occurs, a restriction site 
is said to be present. Sytsma and Gottlieb determined 609 
positions where restriction sites occurred, 490 of which were 
noninformative (sites at every species). Informative data were 
translated into a 9 x 119 matrix of zeroes and ones, represent- 
ing the absence or presence of a restriction site at mapped 
positions in the chloroplast genome for each species. 
We entertain a simple stochastic model for the evolution 
of restriction sites; a two-state continuous-time Markov chain 
with infinitesimal rates X and p,  representing the intensity of 
the instantaneous transition from 0 to 1 and 1 to 0, respec- 
tively. The generator matrix is 
- A  x 
A = (  CL -J 
The matrix P(t)  of transition probabilities through time t 
satisfies the Chapman-Kolmogorov equation E"(t) = P(t )  .A, 
with solution P( t )  = exp(At) having ( i , j ) t h  entry 
where T = p/X and 6' = p + X is the mutation rate. 
We derive an initial distribution for restriction sites at the 
root from biological principles. A uniform distribution of nu- 
cleotide bases at the root and a single restriction enzyme with 
recognition sequence of length 6 suggest an initial distribution 
of rG(1) = (1/4)6 for the presence of a restriction site at each 
genomic site. Because recognition sequences differ from each 
other in at least two positions, the probability of a restriction 
site at each data site is about q(1)  = 29.rri(l) = 0.00708. 
Because a particular location in the genome is detected by 
the presence of a restriction site, only a minuscule fraction of 
the 170 kb (kilobases) enters the data. Following Felsenstein 
(1992), the likelihood (2) is conditioned on seeing at least one 
restriction site at each position 
where PO(*, p) is the probability that {yv = 0, v E L}  at one 
site. 
A complete Bayesian specification requires a prior on the 
propagation parameters p = (T, 6'). We place a uniform prior 
over [l, 46] on T ,  as constrained (somewhat liberally) by the 
biology, assuming a six-base cutter. The mutation rate 6' is 
confounded with time, so the branch lengths are proportional 
to amount of evolution. Hence, we fix 0 throughout our anal- 
ysis. In the MCMC algorithm, we cycle between an update of 
the phylogeny 9 and an update of T .  The proposal distribu- 
tion for this second update is a uniform window centered at 
the current value. 
We implemented the MCMC algorithm of Section 5 in For- 
tran 77 for this model and data set. From random starting 
trees, chains of length 250,000 were subsampled at a rate of 1 
in 100 to reduce dependence in stored output, yielding 2500 
phylogenies per run. Each run took approximately 20 min- 
utes on a Sparc 10 work station. Burn-in was less than 200 
iterations, affecting only the first two stored samples. Con- 
vergence of the chain was inferred from the high degree of 
reproducibility of the posterior. In dozens of repeated runs 
from random starts, the realized relative frequencies deviate 
by at most &3%, a measure of Monte Carlo error for samples 
of this size. Additional programming considerations for this 
data set are addressed in Mau and Newton (1997). 
Figure 3 and Table 2 summarize our analysis of the Clarkia 
data. Topologies IV-VII have unrooted trees distinct from 
those that form the 99% credible region. Several subtopolo- 
gies within the clade: {5,6,7,8,9} are weakly supported by 
the data because of the placement of leaf (7). Bootstrap anal- 
ysis using parsimony attaches a weak 61% confidence coeffi- 
cient t o  that branch in the optimal tree (Sytsma and Gottlieb, 
1986, p. 1257). By contrast, the posterior probability of an al- 
ternate attachment is a near negligible 0.4%. The weakness 
in the rooting is reinforced when we simulate from a posterior 
that includes the outgroup species used by Sytsma and Gott- 
lieb as a tenth taxa. That outgroup is attached beneath the 
{5,6,7,8,9} clade with high posterior probability but not at 
the root. 
Our assurances of convergence and adequate mixing of the 
chain are predicated on the verifiable reproducibility of the 
posterior. Visual tracking of a chain as it moves between the 
three predominant topologies provides further confirmation. 
That we are able to present fairly tight credible regions for 
the Clarkia data depends on both the nature and the amount 
of data but most dramatically on the number of taxa. In the 
next section, we increase the complexity of all three factors 
and provide additional diagnostics. 
7. A Nucleotide Sequence Example 
We have analyzed aligned protein coding mitochondria1 DNA 
sequences obtained from 32 species of cichlid fishes (Kocher et 
al., 1995) using the HKY85 model of nucleotide substitution 
A B C 7  D A B C  7 D  
Figure 3. Shapes of the four most common topologies for the nine species of 
Clarkia, where A = {1,2}, B = {3,4}, C = {5,6}, and D = {8,9} denote mono- 
phyletic pairs. The first three topologies differ only in the placement of the root. 
6 Biometrics, March  1999 
Table 2 
Enumeration of the Clarkia topologies visited b y  the Markov chain, 
ranked b y  frequency of occurrence. Letters represent the clades defined 
i n  Figure 3. Topologies I through III constitute a 99% credible region. 
Labeled histories Frequencies Parenthetic representation 
Label of the topology Types Counts Relative Cumulative 
34 1621 0.649 0.649 
28 447 0.179 0.828 
28 419 0.168 0.996 
4 5 0.002 0.998 
3 3 0.001 0.999 
2 2 0.0008 0.9996 
1 1 0.0004 1.0000 
I (A(B(C(7D)))) 
I1 ( (A(C(7D) ))B) 
( (AB) (C (7D) ) 1 
IV (A(B((C7)D))) 
V ((AB)((C7)D)) 
VI ((A((C7)D))B) 
VII ((AB) ((CD)7)) 
I11 
Table 3 
Tribal classification of 31 species of African cichlid fish. Taxa 1-5 form a flock from Lake 
Malawi. The remainder from Lake Tanganyika constitute a Tanganyikan flock. The Malawi, 
Ectodini, and Lamprologini tribes are represented b y  the letters A ,  C, and D, respectively. B 
consists of {6,7,8,9}, a combination of most of Tropheini and one species of Limnochromini. 
E = {22,23,24,26,27} and F ={28,29,30,31} are convenient conglomerations (pseudoclades) 
of remaining tribes. Taxa (25) i s  not grouped. Taxa (32) i s  an outgroup from Central America. 
Label Species name Tribe Clade 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 
29 
30 
31 
32 
Pseudotropheus zebra 
Buccochromis lepturus 
Champsochromis spilorhynchus 
Lethrinops auritus 
Rhamphochromis sp. 
Lobochilotes labiatus 
Petrochromis orthognathus 
Gnathochromis pfefferi 
Tropheus moorii 
Callochromis macrops 
Cardiopharynx schoutedeni 
Opthalmotilapia ventralis 
Xenotilapia flavipinnus 
Xenotilapia sima 
Chalinochromis popeleni 
Julidochromis marlieri 
Telmatochromis temporalis 
Neolamprologus brichardi 
Neolamprologus tetracant hus 
Lamprologus callipterus 
Lepidiolamprologus elongatus 
Perissodus microlepis 1 
Perissodus microlepis 2 
Cyphotilapia frontosa 
Tanganicodus irsacae 
Limnochromis auritus 
Paracyprichromis brieni 
Oreochromis niloticus 
Tylochromis polylepis 
Boulengerochromis microlepis 
Bathybates sp. 
Cichlasoma citrinellum 
Malawi 
Malawi 
Malawi 
Malawi 
Malawi 
Tropheini 
Tropheini 
Limnochromini 
Tropheini 
Ectodini 
Ectodini 
Ectodini 
Ectodini 
Ectodini 
Lamprologini 
Lamprologini 
Lamprologini 
Lamprologini 
Lamprologini 
Lamprologini 
Lamprologini 
Perissodini 
Perissodini 
Tropheini 
Eretmodini 
Limnochromini 
Cyprichromini 
Tilapiini 
Tylochromini 
Tilapiini 
Bathybatini 
Central America 
A 
A 
A 
A 
A 
B 
B 
B 
B 
C 
C 
C 
C 
C 
D 
D 
D 
D 
D 
D 
D 
E 
E 
E 
Unattached 
E 
E 
F 
F 
F 
F 
Outgroup 
Bayesian Phylogenetic Inference 7 
1 2  3 4 5  1 2  4 3 5  1 3  4 2 5  
((01 ((0203)04))05) ((01 ((02WW)05) ((01 (02(0304))05) 
Figure 4. Supported subtopological variation within the 
Malawi flock A = {1,2,3,4,5}. Variability is confined to co- 
alescences involving taxa {2,3,4}. Marginal posterior probiG 
bilities are 0.776, 0.183, and 0.041, respectively. 
(Hasegawa, Kishino, and Yano, 1985). Table 3 shows some in- 
formation about these species and their standard taxonomy. 
The HKY85 model is an example of the branching Markov 
substitution models discussed in Section 3. Four base compo- 
sition parameters, X A ,  X C ,  X G ,  and TT represent the long-run 
relative frequency of each nucleotide base in a single popu- 
lation, and these are used as the probability distribution of 
base values at the root of the phylogeny. The overall rate of 
substitutions is 0. A parameter K characterizes the difference 
in substitution rates between transitions (changes between A 
and G or between C and T )  and transversions (any other 
change) (see Hasegawa et al., 1985, with a = KO and p = 0, 
for details). Each DNA sequence contains 1044 sites that can 
be partitioned into three blocks of sites according to codon 
position, and our analysis allowed different parameter values 
across blocks. Across all species, 567 of these sites are con- 
stant. Rather than entertain a full Bayesian analysis of this 
problem, we fixed parameters at estimated values and approx- 
imated the posterior distribution of the unknown phylogeny 
only (Appendix I discusses how we got parameter estimates). 
There are more than lo4' topologies in this problem, as 
compared to 2 x lo6 in the Clarkia example, thus presenting a 
significant challenge to  model-based analysis. After extensive 
program testing, we can report with some confidence a Monte 
Carlo approximation to the posterior distribution. Our sum- 
mary of most probable topologies was calculated by combin- 
ing results from 10 independent realizations of the Metropolis 
chain. Each realization started at a phylogeny randomly sam- 
pled from the uniform prior distribution and proceeded for 
1,100,000 steps. The first IEg = lo5 steps were discarded as 
burn-in, and the remaining chain was subsampled every 200 
steps to produce a stored sequence of 5000 phylogenies. The 
tuning parameter b was selected adaptively during the initial 
stage of the run but attained a fixed post-burn-in value of 
0.00098 in all 10 runs, equal to about 3% of the total height of 
a typical sampled tree. The acceptance rate of proposed trees 
was about 40% with this window. A C-language implemen- 
tation using efficient likelihood evaluation and storage tech- 
niques took about 20 hours per realization on a Pentium 200 
PC. Convergence diagnostics are described in Appendix 11. 
Summarizing the empirical distribution of sampled phylog- 
enies presented a challenge. In the combined runs, we found 
that 34 topologies accounted for half the posterior probabil- 
ity. A 90% credible region contained nearly 600 different tree 
topologies. Evidently, much of this variation was caused by 
Table 4 
Most probable tree topologies f rom the combined runs for the cichlid fish data set. The  posterior probabilities 
are averaged over the 10 separate runs. The standard deviation, minimum, and maximum of the computed 
posterior probabilities of the 10 separate runs are in the last three columns. Letters indicate monophyletic groups, 
and subscripts denote subtopologies within these clades. Subtopologies for the A clade are depicted in Figure 4. 
Posterior Variation among runs Parenthetic representation 
Rank of the topology Probability Cumulative SD min max 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
33 
150 
0.0714 
0.0567 
0.0342 
0.0293 
0.0271 
0.0238 
0.0215 
0.0200 
0.0188 
0.0171 
0.0139 
0.0124 
0.0102 
/0.0050 
~0.0010 
/o.ooo 1 
0.0714 
0.1281 
0.1623 
0.1916 
0.2187 
0.2425 
0.2640 
0.2840 
0.3028 
0.3199 
0.3337 
0.3461 
0.3563 
0.4924 
0.7367 
0.9258 
0.0062 
0.0080 
0.0088 
0.0062 
0.0064 
0.0024 
0.0057 
0.0041 
0.0028 
0.0022 
0.0021 
0.0041 
0.0033 
0.0630 
0.0464 
0.0216 
0.0210 
0.0166 
0.0186 
0.0104 
0.0138 
0.0156 
0.0144 
0.0110 
0.0038 
0.0044 
~ 
0.0844 
0.0708 
0.0458 
0.0422 
0.0366 
0.0264 
0.0278 
0.0274 
0.0232 
0.0210 
0.0176 
0.0170 
0.0152 
B1 = (((0607)09)08) D1 = (((15( 1920))((1617)18))21) Fl = ((2829)(3031)) 
B2 = (((0607)08)09) F2 = (((2829)30)31) 
C1 = ((10(1112))(1314)) El = (((2223)27)(2426)) F3 = (((2829)31)30) 
C2 = (10((1112)(1314))) 
0 2  = ( (15( ( ( 1617) 18) (1920)))21) 
E2 = (( (2223) (2426))27) 
8 Biometries, March 1999 
Table 5 
Marginal posterior probabilities for the top three subtopologies within each clade 
of cichlids. Subtopologies within clades are numbered in order of their posterior 
probability. Their combined posterior probabilities are summed. The final 
column is the probability that the constituent species are not monophyletic. 
Clade XI x2 x3 Combined probability Probability not a clade 
A 0.776 0.183 0.041 1.000 
B 0.709 0.239 0.034 0.982 
C 0.856 0.141 0.003 1.000 
D 0.661 0.338 0.001 1.000 
E 0.608 0.191 0.023 0.822 
F 0.446 0.393 0.125 0.964 
0 
0 
0 
0 
0.161 
0.036 
uncertainty in subtopological branching structure in the pres- 
ence of fairly well supported monophyletic groups or clades. 
We have identified six such clades of between four and seven 
taxa, four of which appeared in every saved tree. Figure 4 
shows three probable subtopologies for a clade of five species. 
Other subtopologies are defined at the bottom of Table 4 and 
simplify the presentation of topology uncertainty in that ta- 
ble. 
Compelling evidence for the effectiveness of our MCMC 
algorithm is the reproducibility of probability estimates from 
independent realizations, especially because the starting posi- 
tions arise from a uniform distribution. The last three columns 
in Table 4 quantify the variation from run to run in the poste- 
rior probability of individual topologies. For example, Monte 
Carlo standard error is less than 0.3% for the top 13 topolo- 
gies. 
Marginal probabilities are natural in Bayesian analysis and 
suggest further effective summaries of the posterior distribu- 
tion. Table 5 shows the posterior distribution of subtopologies 
within clades. Clearly, the designation of clade is appropriate 
for A, B, C, D, whereas F and especially E are not necessar- 
ily monophyletic. Note that B includes a member from the 
Limnochromini tribe, so it is somewhat surprising that this 
artificial clade is so unambiguously supported. 
A second posterior summary is the distribution over clade 
trees, i.e., the uncertainty in how clades are connected to form 
the tree. Table 6 shows the most probable tree topologies, 
ignoring variability within clades. Notice that clades A, B,  
C, and D ,  the four clades with unanimous support in our 
samples, also are connected to one another unambiguously. 
Finally, we compare our estimate with two phylogenies re- 
constructed using traditional methodologies. Kocher et al. 
(1995) use a distance matrix method (neighbor joining) on 
the third codon position to  identify clades A, B, C, D, and F.  
The authors then apply maximum parsimony to four of those 
clades to obtain optimal subtopologies, rooting each with a 
taxon from an adjoining clade as an outgroup. We obtained a 
maximum likelihood estimate with the program Dnamlk from 
Phylip (version 3.572c), which, like our method, assumes a 
molecular clock that maintains a constant rate of mutation 
along each branch. 
Because of our codon-position-specific model and different 
methodology, it is not surprising that our answer does not 
agree in whole with either reconstruction. There is a fair de- 
gree of similarity in the different solutions arrayed in Table 7. 
Each estimate has clades A, B,  C, D ,  and F in common, re- 
inforcing the current taxonomic scheme based on geographic 
proximity. The greatest disparity between estimates involves 
the attachment of taxa from clade E .  Except for the con- 
trol pair {22,23}, these species are dispersed throughout Lake 
Tanganyika. Interestingly, the three methods concur in plac- 
ing the B clade closer to the Malawi flock A ,  rather than 
Table 6 
Variation in the interclade coalescence of cichlids. Although A and B always merge together first, 
we continue to differentiate them to emphasize their disparate geographic origins. Uncertainty in the 
location of taxa in clade E and taxon 25 cause almost all the variability at this level of summary. 
Clade trees Posterior probability Cumulative probability 
0.645 
0.102 
0.040 
0.033 
0.027 
0.024 
0.017 
0.017 
0.015 
0.645 
0.747 
0.789 
0.821 
0.848 
0.872 
0.889 
0.906 
0.921 
Bayesian Phylogenetic Inference 9 
Table 7 
Comparison of the Markov chain Monte Carlo estimate of the phylogeny for  the cichlids with 
estimates using other methods. I n  the neighbor-joining solution, the use of [ , I  indicates how species 
in clade E have been redistributed across clades. A n  additional subtopology is B5 = ((06(0708))09). 
Technique Topology 
Neighbor-joining plus parsimony 
Maximum likelihood 
Markov chain Monte Carlo 
to members from its own flock and in preferring a B clade 
that admits a taxon from another tribe. 
8. Simulation S tudy  
Further support for the efficacy of our proposed algorithm 
came from a simulation study. We generated 10 synthetic data 
sets analogous to the cichlid data set. Each one had 32 aligned 
sequences of length 1044, separated into blocks of sites corre- 
sponding to the three codon positions, and each one was ob- 
tained using the simulation software Seq-Gen (version 1.04) 
from Rambaut and Grassly (1996). To mimic the complexity 
of the cichlid problem, we fixed the true phylogeny in this sim- 
ulation equal to one sampled from the posterior in Section 7. 
In particular, the corresponding tree topology was the most 
probable one (Table 4). We also used the same substitution 
parameters as those obtained in the cichlid problem. 
For each synthetic data set, we ran our MCMC algorithm 
twice, using the same burn-in, subsampling rate, and total 
chain length as before. Having two runs enables us to  com- 
pare variation both within and between data sets and hence to 
gauge Monte Carlo error. The posterior distribution is fairly 
diffuse for all synthetic data sets, as it is in the cichlid prob- 
lem. The posterior probability of the top 10 tree topologies 
ranges from 0.22 to 0.79 across the twenty runs with a mean 
of 0.49, as compared to 0.32 in Table 4. The number of tree 
topologies in a 90% credible set ranges from 20 up to 409. 
This is smaller than the 600 or so topologies reported in the 
cichlid data analysis using all 10 runs but comparable to that 
from any single realization. 
The variation between runs is small compared to  the vari- 
ation among synthetic data sets. Considering the probability 
assigned to the top 10 tree topologies, the absolute difference 
between runs was 0.01 on average. For any tree topology, the 
difference between runs in estimated posterior probability was 
consistently smaller than 0.021. 
The true tree topology was captured very well by the es- 
timated posterior distributions: the modal tree topology was 
equal to the true one in 1 case, differed by a single branch 
placement in 8 cases, and differed by 2 branch placements for 
one synthetic data set. In 7 of the 10 cases, the true topology 
appeared in the top 10. This is about what we expect when 
the average posterior mass assigned to  the top 10 topologies is 
0.49. Overall, the posterior probability of the true tree topol- 
ogy ranged from 0.0076 to 0.3103. Evidence is emerging that 
as we increase the number of sites of simulated data, more 
posterior mass is concentrated on the true tree topology. 
9. Discussion and Extensions 
The analysis of the Clarkia data set and restriction site model 
is straightforward, allowing us to introduce concepts and no- 
tation required in the more complex cichlid fish example. We 
therefore confine our remarks to  the second, more challenging 
example. 
Table 7 compares the estimates from the three methods but 
not the methods themselves. Both maximum parsimony and 
maximum likelihood have solutions that maximize objective 
functions determined by the data. By contrast, our method 
provides a distributional assessment in which pockets of high 
posterior probability are located as the chain traverses tree 
space. Our estimate of the phylogeny is a simple by-product of 
that assessment. We simulate a chain of trees where the long- 
run relative frequency of hitting any particular tree topology 
is proportional t o  its marginal posterior probability. For mod- 
erate number of taxa and a discriminating set of data, almost 
all tree topologies have essentially zero probability mass and 
as such are unseen in even extremely long chains. Neverthe- 
less, reproducible samples from the posterior are generated 
efficiently. Other methods require bootstrapping to appraise 
the quality of their estimate. At best, a few hundred such 
phylogenies provide confidence coefficients on how well each 
node of the original estimate is supported by the data. Our 
method automatically provides posterior probabilities, as il- 
lustrated in Table 4 for the cichlids, from which confidence 
coefficients for a particular tree can be calculated if one so 
chooses. 
For large numbers of taxa, other methods rely on incom- 
plete heuristic searches and time-consuming rearrangements 
that do not guarantee to produce an absolute maximum. We 
claim a clear advantage in this regard because averaging over 
local maxima (tree islands in the phylogenetic context) goes 
to the very heart of MCMC technology. The likelihood surface 
for phylogeny can contain numerous local modes, depending 
on the number of taxa, the data, and the model. The proposal 
distribution we have developed appears t o  navigate reason- 
ably well between modes in the two examples presented. 
Our claim that we are accurately sampling from the pos- 
terior density of the cichlid fish example rests primarily on 
the close agreement in the estimates of posterior probabilities 
in different runs from widely dispersed random starting trees. 
We appreciate that researchers might not have the luxury of 
conducting multiple runs when run times approach a day in 
duration. To that end, time-series diagnostics and intraclade 
switching statistics from a single realization support our claim 
that the chain is mixing well given our level of subsampling. 
Notwithstanding, we echo the caveat of Cowles and Carlin 
10 Biometrics, March 1999 
(1996, p. 902) that no single convergence diagnostic is infalli- 
ble and that making comparisons between a few parallel runs 
from disparate starting trees is necessary. 
Our experience with the fish data indicates that stickiness 
can occur when one employs models that exhibit a significant 
lack of fit. For example, application of the standard HKY85 
model equally to all sites generated chains with strongly auto- 
correlated log posteriors that did not mix within the E pseu- 
doclade. Modification of our method might be necessary to 
increase the rate of mixing within clades to successfully solve 
a wider range of data sets and models. 
The technique described herein supposes a molecular clock. 
This constraint is a particular concern for the cichlid fish data, 
where significantly higher mutation rates have been observed 
among members of the Ectodini tribe (Kocher et al., 1995, 
p. 425). An alternate viewpoint considers additive trees in 
which leaves are not constrained to be contemporaneous and 
branch lengths are measured in units of evolution instead of 
time. We have implemented such a nonclock model by decom- 
posing additive trees into dendograms and star components 
(see Lapointe and Legendre, 1992). The proposal distribution 
described in this paper is applied to the dendogram. A vari- 
ant of Q 2 ,  indexed by leaf labels, is applied simultaneously to  
the star component. The subsequent hybrid driver has been 
applied successfully to the cichlid data, and we plan to report 
the results elsewhere. 
Our reported calculations have assumed rate constancy 
within blocks of sites, although models allowing more general 
rate variation are available that might further improve the fit 
(Yang, 1996). Independence between sites is a more difficult 
assumption to relax. Schijniger and von Haeseler (1994) look 
at protein coding regions where the first two codons are as- 
sumed correlated. General dependent models are described in 
Tavark and Feng (1995). Fortunately, our method is indepen- 
dent of the particular form of the likelihood (or the prior). 
Provided that the likelihood is computable and the number 
of additional parameters in the model remains manageable, 
one should be able to substitute into the acceptance ratio and 
run the chain in a reasonable amount of time. 
Since the original submission of this article, we have be- 
come aware of efforts of others to run Markov chains on the 
space of phylogenetic trees. Kuhner, Yamato, and Felsenstein 
(1997) use MCMC to sample genealogies to  estimate the prod- 
uct of the effective population size and the mutation rate per 
site. Yang and Rannala (1997) and Li, Pearl, and Doss (1996) 
have proposed MCMC algorithms for Bayesian phylogenetic 
inference that differ greatly from the method we have devel- 
oped. The global nature of the tree update, coupled with the 
existence of a tuning parameter that moderates the overall 
acceptance rate, distinguishes our approach. 
ACKNOWLEDGEMENTS 
The authors would like to thank Carter Denniston and David 
Baum for helpful discussions that provided the requisite bi- 
ological background. Further thanks go to  Tom Kurtz, Pe- 
ter Donnelly, Simon Tavark, Joe Felsenstein, Charlie Geyer, 
FranGois Lapointe, Don Simon, and Brian Yandell for stimu- 
lating conversations during the evolution of this article. The 
suggestions of an anonymous reviewer regarding convergence 
diagnostics and computer-simulated data led to  improvements 
in the final version. 
RESUMB 
Nous dkrivons une chaine de Markov pour kchantillonner 8. 
partir de la distribution a posteriori pour un arbre phylogkn6- 
tique conditionnellement A l’information de sequence prove- 
nant de l’ensemble correspondant des organismes, B un modkle 
stochastique pour ces donnkes, et & une distribution a priori 
sur l’espace des arbres. Une transformation de l’arbre en une 
forme canonique de matrice cophknktique suggitre une dis- 
tribution simple et efficace pour sklectionner des arbres can- 
didats proche de l’arbre courant dans la chaine. Nous illus- 
trons l’agorithme avec des donnkes de site de restriction sur 
neuf espkces de plantes, puis nous l’ktendons aux skquences 
d’ADN provenant de 32 espitces de poisson. L’algorithme fonc- 
tionne bien dans les deux exemples a partir d’arbres de depart 
alkatoires, en gknkrant des estimations reproductibles et des 
ensembles plausibles pour le chemin d’kvolution. 
REFERENCES 
Besag, J. and Green, P. J. (1993). Spatial statistics and Bayes- 
ian computation (with discussion). Journal of the Royal 
Statistical Society, Series B 55, 25-37. 
Camin, J. H. and Sokal, R. R. (1965). A method for deducing 
branching sequences in phylogeny. Evolution 19, 311- 
326. 
Cowles, M. K. and Carlin, B. P. (1996). Markov chain Monte 
Carlo convergence diagnostics: A comparative review. 
Journal of the American Statistical Society 91, 883-904. 
Evans, S. and Speed, T. (1993). Invariants of some proba- 
bility models used in phylogenetic inference. Annals of 
Statistics 21, 355-377. 
Felsenstein, J. (1978). The number of evolutionary trees. Sys- 
tematic Zoology 27, 27-33. 
Felsenstein, J. (1981). Evolutionary trees from DNA sequenc- 
es: A maximum likelihood approach. Journal of Molecu- 
lar Evolution 17, 368-376. 
Felsenstein, J. (1983). Statistical inference of phylogenies. 
Journal of the Royal Statistical Society, Series A,  146, 
Felsenstein, J. (1985a). Confidence limits on phylogenies: An 
approach using the bootstrap. Evolution 39, 783-791. 
Felsenstein, J. (1985b). Phylogenies and the comparative 
method. The American Naturalist 125, 1-15. 
Felsenstein, J. (1988). Phylogenies from molecular sequences: 
Inference and reliability. Annual Review of Genetics 22, 
Felsenstein, J. (1992). Phylogenies from restriction sites: A 
maximum likelihood approach. Evolution 46, 159-173. 
Fitch, W. M. and Margoliash, E. (1967). Construction of phy- 
logenetic trees. Science 155, 279-284. 
Geyer, C. J. (1992). Practical Markov chain Monte Carlo 
(with discussion). Statistical Science 7, 437-511. 
Goldman, N. (1990). Maximum likelihood inference of phylo- 
genetic trees, with special reference to  a Poisson process 
model of DNA substitution and to  parsimony analyses. 
Systematic Zoology 39, 345-361. 
Goldman, N. (1993). Statistical tests of models of DNA sub- 
stitution. Journal of Molecular Evolution 36, 182-198. 
246-2 72. 
1-65. 
Bayes ian  Phylogenetic Inference 11 
Griffiths, R. C. and TavarC, S. (1994a). Simulating probabil- 
ity distributions in the coalescent. Theoretical Population 
Biology 46, 131-159. 
Griffiths, R. C. and TavarB, S. ] (199413). Ancestral inference 
in population genetics. Statistical Science 9, 307-319. 
Hasegawa, M. and Kishino, H. (1989). Confidence limits on 
the maximum likelihood estimate of the hominoid tree 
from mitochondrial-DNA sequences. Evolution 43, 672- 
677. 
Hasegawa, M., Kishino, H., and Yano, T. (1985). Dating the 
human-ape splitting by a molecular clock of mitochon- 
drial DNA. Journal of Molecular Evolution 22, 160-174. 
Huelsenbeck, J. P. and Rannala, B. (1997). Phylogenetic 
methods come of age: Testing hypothesis in an evolu- 
tionary context. Science 276, 227-231. 
Kocher, T. D., Conroy, J. A., McKaye, K. R., Stauffer, J. R., 
and Lockwood, S. F. (1995). Evolution of NADH dehy- 
drogenase subunit 2 in East African cichlid fish. Molec- 
ular Phylogenetics and Evolution 4, 420-432. 
Kuhner, M. K., Yamato, J., and Felsenstein, J. (1997). Ap- 
plications of Metropolis-Hastings genealogy sampling. In 
Progress in Population Genetics and Human Evolution, 
Volume 87, P. Donnelly and S. TavarC (eds), 183-192. 
New York: Springer-Verlag. 
Lapointe, F.- J. and Legendre, P. (1991). The generation of 
random ultrametric matrices representing dendograms. 
Journal of Classification 8, 177-200. 
Lapointe, F.- J. and Legendre, P. (1992). A statistical frame- 
work to test the consensus among additive trees (clado- 
grams). Systematic Biology 41, 158-171. 
Li, S., Pearl, D. K., and DOSS, H. (1996). Phylogenetic tree 
construction using Markov chain Monte Carlo. Technical 
Report 583, Department of Statistics, Ohio State Univer- 
sity, Columbus. 
Mau, B. and Newton, M. A. (1997). Phylogenetic inference for 
binary data on dendograms using Markov chain Monte 
Carlo. Journal of Computational and Graphical Statistics 
Navidi, W. C., Churchill, G. A,, and von Haeseler, A. (1993). 
Phylogenetic inference: Linear invariants and maximum 
likelihood. Biometrics 49, 543-555. 
Newton, M. A. (1996). Bootstrapping phylogenies: Large de- 
viations and dispersion effects. Biometrika 83, 315-328. 
Newton, M. A,, Mau, B., and Larget, B. (1999). Markov chain 
Monte Carlo for the Bayesian analysis of evolutionary 
trees from aligned molecular sequences. In Proceedings 
of the AMS-IMS-SIAM Joint Summer Research Con- 
ference on Statistics and Molecular Biology, F. Seillier- 
Moiseiwitsch, P. Donnelly, and M. Waterman (eds), Seat- 
tle, Washington, 1997, in press. 
Rambaut, A. and Grassly, N. C. (1996). Seq-Gen: An appli- 
cation for the Monte Carlo simulation of DNA sequence 
evolution along phylogenetic trees. C A  BIOS 13, 235- 
238. 
Schoniger, M. and von Haeseler, A. (1994). A stochastic model 
for the evolution of autocorrelated DNA sequences. 
Molecular Phylogenetics and Evolution 3, 240-247. 
Sinsheimer, J. S., Lake, J. A., and Little, R. J. A. (1996). 
Bayesian hypothesis testing of four-taxon topologies us- 
6, 122-131. 
Smouse, P. E. and Li, W.-H. (1989). Likelihood analysis of mi- 
tochondrial restriction-cleavage patterns for the human- 
chimpanzee-gorilla trichotomy. Evolutzon 43, 1162-1176. 
Sokal, R. R. and Sneath, P. H. A. (1963). Numerical Tazon- 
omy. San Francisco: Freeman. 
Swofford, D. L., Olsen, G. J., Waddell, P. J., and Hillis, D. 
M. (1996). Phylogenetic inference. In Molecular System- 
atics, 2nd edition, D. M. Hillis, C. Moritz, and B. K. 
Mable (eds), 407-511. Sunderdland, Massachusetts: Sin- 
auer Associates. 
Sytsma, K. J. and Gottlieb, L. D. (1986). Chloroplast DNA 
evolution and phylogenetic relationships in Clarkia sect 
peripetasma (onagraceae). Evolution 40, 1248-1261. 
TavarC, S. and Feng, Y. (1995). Reconstructing phylogenetic 
trees when sites are dependent. DIMACS Technical Re- 
port 95-48, 55-57, Rutgers University, Piscataway, New 
Jersey. 
Tierney, L. (1994). Markov chains for exploring posterior dis- 
tributions (with discussion). Annals of Statistics 22, 
Yang, 2. (1996). Among-site rate variation and its impact on 
phylogenetic analysis. T R E E  11, 367-371. 
Yang, Z. and Rannala, B. (1997). Bayesian phylogenetic infer- 
ence using DNA sequences: A Markov chain Monte Carlo 
method. Molecular Biology and Evolutzon 14, 717-724. 
1701-1762. 
Received July 1996. Revised November 1997. 
Accepted January 1998. 
APPENDIX I 
Estimation of Separate Parameters for  Three 
HKY85 Models, One for Each Codon Position 
Exploratory data analysis of the cichlid DNA sequences by 
codon position shows striking differences in the percentage 
of variable sites (31.5%, 14.9%, and 90.5%, respectively) and 
in base composition. We first estimated the values of T sep- 
arately for each codon position using observed base counts. 
To estimate different values of 19, we ran three separate simu- 
lations using data from each position alone, updating K. each 
cycle, and used the subsequent relative total tree heights to 
find values of 01 = 1.4, 02 = 1.0, and 03 = 8.3. Finally, with 
these three values of 0, we ran a chain with all the data al- 
lowing K. to change separately for each position, estimating 
nl = 7.5, ~2 = 2.5, and ~3 = 10.75. All subsequent runs were 
conducted with these parameter values fixed. 
APPENDIX I1 
Convergence Diagnostics for  Cichlid Data Set 
The choice of chain length, subsampling rate, and burn-in 
parameters was affected by the limitations of computer speed 
and memory, but the analysis of output from test runs was 
also helpful. Figure 5 shows a time-series plot of the log like- 
lihood of saved phylogenies from 1 of the 10 final runs. It is 
typical to see a dramatic increase in log likelihood during the 
burn-in period, with stabilization at what appears to be a 
stationary series after about lo4 basic steps. The autocorre- 
lation function in Figure 6 indicates that trees separated by 
about 20 storage steps present approximately independent log _. 
ing molecular sequence data. Biometrics 52, 193-210. likelihoods. 
12 Biometrics, March 1999 
Figure 5.  Time-series plot of the log posterior for 5500 
subsampled trees of cichlids. The log posterior plateaus at a 
mean value of -7868 after 75 sample points, indicating that 
a burn-in of 500 is fairly conservative for this particular run. 
Lower panel shows the second half of our run. 
An especially useful measure for assessing mixing is the 
frequency of topological changes within individual clades. Ta- 
ble 8 tabulates these switching counts from one run on the 
cichlid data. Ideally, the number of switches would be close 
to the expected number, assuming independent sampling. In- 
deed, Table 8 shows that the number of switches between 
the subtopologies within clade A for one typical run agrees 
A1 
A2 
A3 
remarkably well with the expected counts, assuming indepen- 
dence shown here: 
A1 3019 722 144 
' 4 2  722 173 34 
A3 144 34 7 
The other clades do not mix as rapidly, with the number of 
observed switches only a small fraction of that expected as- 
suming independence. The rate of mixing within these clades 
is sufficient, however, to give us reproducible results over sep- 
arate runs. 
1 1  
0 20 40 60 80 100 
lag 
Figure 6. Autocorrelation function of the log posterior dis- 
played in Figure 5 .  ACF drops below noise level at about 20 
lags. 
Table 8 
Swapping between subtopologies f o r  a single run  o n  the cichlid data. Each TOW shows the distribution 
of the subtopologies that immediately follow a given subtopology an the saved sequences of trees. FOT 
example, subtopology A2 followed A1 719 tames in the 5000 saved tree topologies. Topologies that appear 
only infrequently have been collapsed. A tree in which a clade does not appear is  tabulated under -. 
Ai ' 42  A3 
3024 719 142 
715 180 34 1175 765 
146 30 9 
39 5 12 
18 1836 734 364 1407 
Ex 148 28 237 192 205 
- 222 112 32 464 161 - 
